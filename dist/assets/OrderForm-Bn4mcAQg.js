import{r as _,V as I,B as ke,a as Ce,w as it,l as G,d as se,x as _e,y as dt,z as ct,A as ut,j as e,b as Ae,C as mt,D as pt,m as gt,t as ht,h as ft,n as bt,f as xt,L as yt,E as _t}from"./index-BdkURwdi.js";import{u as vt}from"./useGetCategories-CBwNO7cM.js";import{u as jt}from"./useGetPrice-Dun8pV2F.js";import{u as Nt}from"./useGetBranches-ClMjvIez.js";import{u as wt}from"./useGetOrder-Dfm-BwKu.js";import{u as St}from"./useGetUsersByRole-CulwpbD4.js";import{u as kt,c as Ct}from"./userSchema-Jsvslfq7.js";import{u as At}from"./useGetuser-CQcny1FG.js";const Pt="http://3.110.208.70:3000/admin/coupon/apply",Ot=()=>{const[d,u]=_.useState(!1);return{applyCoupon:async(y,p,n)=>{const j=localStorage.getItem("authToken");u(!0);try{const c=await fetch(Pt,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`},body:JSON.stringify({user_id:y,order_Total:p,coupon_code:n})}),l=await c.json();return c.ok?l.data:(I.error(l.message,{position:"top-center"}),!1)}catch{I.error("Unable to apply coupon code!")}finally{u(!1)}},loading:d}},It=()=>{const[d,u]=_.useState([]),[v,y]=_.useState(!1),p=async n=>{const j=localStorage.getItem("authToken");y(!0);try{const c=await fetch(`${ke}/admin/valid-coupons?${n}`,{method:"GET",headers:{Authorization:j?`Bearer ${j}`:""}}),l=await c.json();if(!c.ok){I.error(l.message,{position:"top-center"}),y(!1);return}u(l==null?void 0:l.data)}catch{I.error("Network error: Failed to fetch coupons.")}finally{y(!1)}};return _.useEffect(()=>{p()},[]),{validCoupons:d,fetchValidCoupons:p,loading:v}},Tt="http://3.110.208.70:3000",Dt=`${Tt}/admin/orders`,Et=()=>{const[d,u]=_.useState(!1);return{addOrder:async y=>{const p=localStorage.getItem("authToken");u(!0);try{const n=await fetch(Dt,{method:"POST",headers:{Authorization:`Bearer ${p}`,"Content-Type":"application/json"},body:JSON.stringify(y)});if(!n.ok){const c=await n.json();return I.error(c.message,{position:"top-center"}),!1}const j=await n.json();return I.success(j.message,{position:"top-center"}),!0}catch(n){return I.error((n==null?void 0:n.message)||"Network error: Failed to fetch.",{position:"top-center"}),!1}finally{u(!1)}},loading:d}},Ft=()=>{const[d,u]=_.useState(!1);return{updateOrder:async(y,p)=>{const n=localStorage.getItem("authToken"),j=`http://3.110.208.70:3000/admin/orders/${y}`;u(!0);try{const c=await fetch(j,{method:"PUT",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify(p)});if(c.ok){const k=await c.json();return I.success(k.message,{position:"top-center"}),!0}const l=await c.json();return I.error(l.message,{position:"top-center"}),!1}catch(c){return I.error((c==null?void 0:c.message)||"Network error: Failed to fetch.",{position:"top-center"}),!1}finally{u(!1)}},loading:d}},qt=()=>{const[d,u]=_.useState([]),[v,y]=_.useState(!1);return{address:d,loading:v,fetchAddress:async n=>{var l;const j=localStorage.getItem("authToken"),c=`http://3.110.208.70:3000/address/${n}/user`;try{const k=await fetch(c,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`}});if(!k.ok){const f=await k.json();I.error(f.message,{position:"top-center"});return}const N=await k.json(),E=((l=N==null?void 0:N.data)==null?void 0:l.result)||[];u(E)}catch(k){I.error((k==null?void 0:k.message)||"Network error: Failed to fetch.",{position:"top-center"})}finally{y(!1)}}}},Lt=()=>{const[d,u]=_.useState(!1),[v,y]=_.useState();return{transactionId:v,generatePaymentLink:async n=>{var c,l;const j=localStorage.getItem("authToken");u(!0);try{const k=await fetch(`${ke}/razorpay/generate-payment-link`,{method:"POST",headers:{Authorization:j?`Bearer ${j}`:"","Content-Type":"application/json"},body:JSON.stringify(n)}),N=await k.json();if(!k.ok){I.error(N.message,{position:"top-center"}),u(!1);return}I.success((N==null?void 0:N.message)||"Payments Link sent successfully"),y((l=(c=N==null?void 0:N.data)==null?void 0:c.razorpay)==null?void 0:l.razorpay_payment_link_id)}catch{I.error("Fail to generate payment link try again later")}finally{u(!1)}},loading:d}},$t=Ce().shape({category_id:G().nullable().required("Please select a category").test("required","Please select a category",d=>!!d),product_id:G().nullable().required("Please select a product").test("required","Please select a product",d=>!!d),service_id:G().nullable().required("Please select a service").test("required","Please select a service",d=>!!d),price:G().nullable().when(["category_id","product_id","service_id"],([d,u,v],y)=>d&&u&&v?y.required("Price is not available for the combination, please add a price"):y.nullable())}),Ut=Ce().shape({username:se().required("Please enter username"),address_id:G().required("Please select address").test("required","Please select address",d=>!!d),express_delivery_charges:G().typeError("Express delivery charges must be a number").min(0,"Express delivery charges must be a positive number"),shipping_charges:G().typeError("Shipping charge must be a number").min(0,"Shipping charge must be a positive number"),payment_type:G().required("Please choose payment type").test("required","Please choose order status",d=>!!d),payment_status:G().required("Please choose payment status").test("required","Please choose payment status",d=>!!d),paid_amount:G().typeError("Paid amount must be a number").min(0,"Paid amount must be a positive number").test("max-paid","paid amount cannot be greater than the total amount",function(d){var u;return d!==void 0&&d<=((u=this.options.context)==null?void 0:u.total)}),branch_id:G().required("Please select branch").test("required","Please select branch",d=>!!d),items:it().of($t)}),Ue=()=>{const[d,u]=_.useState(!1);return{addAddress:async(y,p=!0)=>{var j;const n=localStorage.getItem("authToken");u(!0);try{const c=await fetch(`${ke}/address/admin`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify(y)}),l=await c.json();return c.ok?(p&&I.success(l.message,{position:"top-center"}),(j=l==null?void 0:l.data)==null?void 0:j.result):(p&&I.error(l.message,{position:"top-center"}),!1)}catch(c){return I.error((c==null?void 0:c.message)||"Error adding banner",{position:"top-center"}),!1}finally{u(!1)}},loading:d}},Me=Ce().shape({pincode:se().required("Pin Code is required").matches(/^[0-9]{6}$/,"Pincode must be 6 digit"),address_type:G().required("Address type is required"),building_number:se().required("Building number is required"),area:se().required("Area is required"),city:se().required("City is required"),state:se().required("State is required"),country:se().required("Country is required"),landmark:se().required("Landmark is required")});var W={},ve={},Se,Ee;function Mt(){if(Ee)return Se;Ee=1;var d="Expected a function",u=NaN,v="[object Symbol]",y=/^\s+|\s+$/g,p=/^[-+]0x[0-9a-f]+$/i,n=/^0b[01]+$/i,j=/^0o[0-7]+$/i,c=parseInt,l=typeof _e=="object"&&_e&&_e.Object===Object&&_e,k=typeof self=="object"&&self&&self.Object===Object&&self,N=l||k||Function("return this")(),E=Object.prototype,f=E.toString,A=Math.max,z=Math.min,w=function(){return N.Date.now()};function b(r,m,S){var T,$,H,C,R,V,Z=0,me=!1,Q=!1,ie=!0;if(typeof r!="function")throw new TypeError(d);m=g(m)||0,P(S)&&(me=!!S.leading,Q="maxWait"in S,H=Q?A(g(S.maxWait)||0,m):H,ie="trailing"in S?!!S.trailing:ie);function ae(D){var B=T,ee=$;return T=$=void 0,Z=D,C=r.apply(ee,B),C}function je(D){return Z=D,R=setTimeout(U,m),me?ae(D):C}function pe(D){var B=D-V,ee=D-Z,de=m-B;return Q?z(de,H-ee):de}function X(D){var B=D-V,ee=D-Z;return V===void 0||B>=m||B<0||Q&&ee>=H}function U(){var D=w();if(X(D))return re(D);R=setTimeout(U,pe(D))}function re(D){return R=void 0,ie&&T?ae(D):(T=$=void 0,C)}function ge(){R!==void 0&&clearTimeout(R),Z=0,T=V=$=R=void 0}function Ne(){return R===void 0?C:re(w())}function ne(){var D=w(),B=X(D);if(T=arguments,$=this,V=D,B){if(R===void 0)return je(V);if(Q)return R=setTimeout(U,m),ae(V)}return R===void 0&&(R=setTimeout(U,m)),C}return ne.cancel=ge,ne.flush=Ne,ne}function P(r){var m=typeof r;return!!r&&(m=="object"||m=="function")}function t(r){return!!r&&typeof r=="object"}function a(r){return typeof r=="symbol"||t(r)&&f.call(r)==v}function g(r){if(typeof r=="number")return r;if(a(r))return u;if(P(r)){var m=typeof r.valueOf=="function"?r.valueOf():r;r=P(m)?m+"":m}if(typeof r!="string")return r===0?r:+r;r=r.replace(y,"");var S=n.test(r);return S||j.test(r)?c(r.slice(2),S?2:8):p.test(r)?u:+r}return Se=b,Se}var ce={},Fe;function Rt(){return Fe||(Fe=1,Object.defineProperty(ce,"__esModule",{value:!0}),ce.compose=function(){for(var u=arguments.length,v=Array(u),y=0;y<u;y++)v[y]=arguments[y];return function(){for(var p=arguments.length,n=Array(p),j=0;j<p;j++)n[j]=arguments[j];v.forEach(function(c){return c&&c.apply(void 0,n)})}},ce.pick=function(u){for(var v=arguments.length,y=Array(v>1?v-1:0),p=1;p<v;p++)y[p-1]=arguments[p];return y.reduce(function(n,j){return u&&u.hasOwnProperty(j)&&(n[j]=u[j]),n},{})}),ce}var qe;function Bt(){if(qe)return ve;qe=1,Object.defineProperty(ve,"__esModule",{value:!0});var d=Object.assign||function(w){for(var b=1;b<arguments.length;b++){var P=arguments[b];for(var t in P)Object.prototype.hasOwnProperty.call(P,t)&&(w[t]=P[t])}return w},u=function(){function w(b,P){for(var t=0;t<P.length;t++){var a=P[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(b,a.key,a)}}return function(b,P,t){return P&&w(b.prototype,P),t&&w(b,t),b}}(),v=dt(),y=k(v),p=ct(),n=k(p),j=Mt(),c=k(j),l=Rt();function k(w){return w&&w.__esModule?w:{default:w}}function N(w,b){if(!(w instanceof b))throw new TypeError("Cannot call a class as a function")}function E(w,b){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:w}function f(w,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);w.prototype=Object.create(b&&b.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(w,b):w.__proto__=b)}var A=function(b){return{mainText:b.main_text,secondaryText:b.secondary_text}},z=function(w){f(b,w);function b(P){N(this,b);var t=E(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,P));return t.init=function(){if(!window.google)throw new Error("[react-places-autocomplete]: Google Maps JavaScript API library must be loaded. See: https://github.com/kenny-hibino/react-places-autocomplete#load-google-library");if(!window.google.maps.places)throw new Error("[react-places-autocomplete]: Google Maps Places library must be loaded. Please add `libraries=places` to the src URL. See: https://github.com/kenny-hibino/react-places-autocomplete#load-google-library");t.autocompleteService=new window.google.maps.places.AutocompleteService,t.autocompleteOK=window.google.maps.places.PlacesServiceStatus.OK,t.setState(function(a){return a.ready?null:{ready:!0}})},t.autocompleteCallback=function(a,g){if(t.setState({loading:!1}),g!==t.autocompleteOK){t.props.onError(g,t.clearSuggestions);return}var r=t.props.highlightFirstSuggestion;t.setState({suggestions:a.map(function(m,S){return{id:m.id,description:m.description,placeId:m.place_id,active:!!(r&&S===0),index:S,formattedSuggestion:A(m.structured_formatting),matchedSubstrings:m.matched_substrings,terms:m.terms,types:m.types}})})},t.fetchPredictions=function(){var a=t.props.value;a.length&&(t.setState({loading:!0}),t.autocompleteService.getPlacePredictions(d({},t.props.searchOptions,{input:a}),t.autocompleteCallback))},t.clearSuggestions=function(){t.setState({suggestions:[]})},t.clearActive=function(){t.setState({suggestions:t.state.suggestions.map(function(a){return d({},a,{active:!1})})})},t.handleSelect=function(a,g,r){t.clearSuggestions(),t.props.onSelect?t.props.onSelect(a,g,r):t.props.onChange(a)},t.getActiveSuggestion=function(){return t.state.suggestions.find(function(a){return a.active})},t.selectActiveAtIndex=function(a){var g=t.state.suggestions.find(function(r){return r.index===a}).description;t.setActiveAtIndex(a),t.props.onChange(g)},t.selectUserInputValue=function(){t.clearActive(),t.props.onChange(t.state.userInputValue)},t.handleEnterKey=function(){var a=t.getActiveSuggestion();a===void 0?t.handleSelect(t.props.value,null,null):t.handleSelect(a.description,a.placeId,a)},t.handleDownKey=function(){if(t.state.suggestions.length!==0){var a=t.getActiveSuggestion();a===void 0?t.selectActiveAtIndex(0):a.index===t.state.suggestions.length-1?t.selectUserInputValue():t.selectActiveAtIndex(a.index+1)}},t.handleUpKey=function(){if(t.state.suggestions.length!==0){var a=t.getActiveSuggestion();a===void 0?t.selectActiveAtIndex(t.state.suggestions.length-1):a.index===0?t.selectUserInputValue():t.selectActiveAtIndex(a.index-1)}},t.handleInputKeyDown=function(a){switch(a.key){case"Enter":a.preventDefault(),t.handleEnterKey();break;case"ArrowDown":a.preventDefault(),t.handleDownKey();break;case"ArrowUp":a.preventDefault(),t.handleUpKey();break;case"Escape":t.clearSuggestions();break}},t.setActiveAtIndex=function(a){t.setState({suggestions:t.state.suggestions.map(function(g,r){return r===a?d({},g,{active:!0}):d({},g,{active:!1})})})},t.handleInputChange=function(a){var g=a.target.value;if(t.props.onChange(g),t.setState({userInputValue:g}),!g){t.clearSuggestions();return}t.props.shouldFetchSuggestions&&t.debouncedFetchPredictions()},t.handleInputOnBlur=function(){t.mousedownOnSuggestion||t.clearSuggestions()},t.getActiveSuggestionId=function(){var a=t.getActiveSuggestion();return a?"PlacesAutocomplete__suggestion-"+a.placeId:void 0},t.getIsExpanded=function(){return t.state.suggestions.length>0},t.getInputProps=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(a.hasOwnProperty("value"))throw new Error("[react-places-autocomplete]: getInputProps does not accept `value`. Use `value` prop instead");if(a.hasOwnProperty("onChange"))throw new Error("[react-places-autocomplete]: getInputProps does not accept `onChange`. Use `onChange` prop instead");var g={type:"text",autoComplete:"off",role:"combobox","aria-autocomplete":"list","aria-expanded":t.getIsExpanded(),"aria-activedescendant":t.getActiveSuggestionId(),disabled:!t.state.ready};return d({},g,a,{onKeyDown:(0,l.compose)(t.handleInputKeyDown,a.onKeyDown),onBlur:(0,l.compose)(t.handleInputOnBlur,a.onBlur),value:t.props.value,onChange:function(m){t.handleInputChange(m)}})},t.getSuggestionItemProps=function(a){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.handleSuggestionMouseEnter.bind(t,a.index),m=t.handleSuggestionClick.bind(t,a);return d({},g,{key:a.id,id:t.getActiveSuggestionId(),role:"option",onMouseEnter:(0,l.compose)(r,g.onMouseEnter),onMouseLeave:(0,l.compose)(t.handleSuggestionMouseLeave,g.onMouseLeave),onMouseDown:(0,l.compose)(t.handleSuggestionMouseDown,g.onMouseDown),onMouseUp:(0,l.compose)(t.handleSuggestionMouseUp,g.onMouseUp),onTouchStart:(0,l.compose)(t.handleSuggestionTouchStart,g.onTouchStart),onTouchEnd:(0,l.compose)(t.handleSuggestionMouseUp,g.onTouchEnd),onClick:(0,l.compose)(m,g.onClick)})},t.handleSuggestionMouseEnter=function(a){t.setActiveAtIndex(a)},t.handleSuggestionMouseLeave=function(){t.mousedownOnSuggestion=!1,t.clearActive()},t.handleSuggestionMouseDown=function(a){a.preventDefault(),t.mousedownOnSuggestion=!0},t.handleSuggestionTouchStart=function(){t.mousedownOnSuggestion=!0},t.handleSuggestionMouseUp=function(){t.mousedownOnSuggestion=!1},t.handleSuggestionClick=function(a,g){g&&g.preventDefault&&g.preventDefault();var r=a.description,m=a.placeId;t.handleSelect(r,m,a),setTimeout(function(){t.mousedownOnSuggestion=!1})},t.state={loading:!1,suggestions:[],userInputValue:P.value,ready:!P.googleCallbackName},t.debouncedFetchPredictions=(0,c.default)(t.fetchPredictions,P.debounce),t}return u(b,[{key:"componentDidMount",value:function(){var t=this.props.googleCallbackName;if(t){var a=window.google&&window.google.maps&&window.google.maps.places;a?this.init():window[t]=this.init}else this.init()}},{key:"componentWillUnmount",value:function(){var t=this.props.googleCallbackName;t&&window[t]&&delete window[t]}},{key:"render",value:function(){return this.props.children({getInputProps:this.getInputProps,getSuggestionItemProps:this.getSuggestionItemProps,loading:this.state.loading,suggestions:this.state.suggestions})}}]),b}(y.default.Component);return z.propTypes={onChange:n.default.func.isRequired,value:n.default.string.isRequired,children:n.default.func.isRequired,onError:n.default.func,onSelect:n.default.func,searchOptions:n.default.shape({bounds:n.default.object,componentRestrictions:n.default.object,location:n.default.object,offset:n.default.oneOfType([n.default.number,n.default.string]),radius:n.default.oneOfType([n.default.number,n.default.string]),types:n.default.array}),debounce:n.default.number,highlightFirstSuggestion:n.default.bool,shouldFetchSuggestions:n.default.bool,googleCallbackName:n.default.string},z.defaultProps={onError:function(b,P){return console.error(`[react-places-autocomplete]: error happened when fetching data from Google Maps API.
Please check the docs here (https://developers.google.com/maps/documentation/javascript/places#place_details_responses)
Status: `,b)},searchOptions:{},debounce:200,highlightFirstSuggestion:!1,shouldFetchSuggestions:!0},ve.default=z,ve}var le={},Le;function Gt(){return Le||(Le=1,Object.defineProperty(le,"__esModule",{value:!0}),le.geocodeByAddress=function(u){var v=new window.google.maps.Geocoder,y=window.google.maps.GeocoderStatus.OK;return new Promise(function(p,n){v.geocode({address:u},function(j,c){c!==y&&n(c),p(j)})})},le.getLatLng=function(u){return new Promise(function(v,y){try{var p={lat:u.geometry.location.lat(),lng:u.geometry.location.lng()};v(p)}catch(n){y(n)}})},le.geocodeByPlaceId=function(u){var v=new window.google.maps.Geocoder,y=window.google.maps.GeocoderStatus.OK;return new Promise(function(p,n){v.geocode({placeId:u},function(j,c){c!==y&&n(c),p(j)})})}),le}var $e;function zt(){if($e)return W;$e=1,Object.defineProperty(W,"__esModule",{value:!0}),W.getLatLng=W.geocodeByPlaceId=W.geocodeByAddress=void 0;var d=Bt(),u=y(d),v=Gt();function y(p){return p&&p.__esModule?p:{default:p}}return W.geocodeByAddress=v.geocodeByAddress,W.geocodeByPlaceId=v.geocodeByPlaceId,W.getLatLng=v.getLatLng,W.default=u.default,W}var ue=zt();const Re=ut(ue),Kt=({isOpen:d,onClose:u,userId:v,setIsSubmit:y,onAddressAdded:p,fullname:n})=>{const{addAddress:j,loading:c}=Ue(),[l,k]=_.useState({}),[N,E]=_.useState(!1),[f,A]=_.useState({building_number:"",area:"",lat:null,long:null,landmark:"",pincode:"",city:"",state:"",country:"",user_id:null,address_type:null,full_name:""}),[z,w]=_.useState(!1);_.useEffect(()=>{d?v&&A(a=>({...a,user_id:v,full_name:n})):(A({building_number:"",area:"",landmark:"",pincode:"",city:"",lat:null,long:null,state:"",country:"",user_id:null,address_type:null,full_name:""}),k({}))},[d,v]);const b=a=>{A({...f,area:a}),w(!0)},P=async a=>{A({...f,area:a});try{const g=await ue.geocodeByAddress(a),r=await ue.getLatLng(g[0]);r&&A(m=>({...m,lat:r==null?void 0:r.lat,long:r==null?void 0:r.lng}))}catch{I.error("Failed to fetch address detail",{className:"toast-error"})}},t=async a=>{a.preventDefault();try{if(await Me.validate(f,{abortEarly:!1}),v){const g=await j(f);g&&(p(g),u(),y(!0))}}catch(g){if(g instanceof Ae){const r={};g.inner.forEach(m=>{r[m.path||""]=m.message}),k(r)}else I.error("Failed to submit the form. Please try again.")}};if(d)return e.jsxs("div",{className:"fixed inset-0 grid overflow-auto items-center justify-center z-50 p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:u}),e.jsxs("div",{className:"bg-white p-5 rounded-lg shadow-lg max-w-lg smobile:min-w-[85%] z-10 relative",children:[e.jsx("button",{className:"btn btn-sm btn-icon btn-light btn-outline absolute top-0 right-0 mr-5 mt-5 lg:mr-5 shadow-default",onClick:u,children:e.jsx("i",{className:"ki-filled ki-cross"})}),e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Add New Address"}),e.jsxs("form",{onSubmit:t,children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"country",className:"block text-gray-700 font-semibold",children:"Address Type"}),e.jsxs("select",{className:"select select-lg text-sm",onChange:a=>A({...f,address_type:Number(a.target.value)}),children:[e.jsx("option",{value:"",selected:!0,disabled:!0,className:"badge-danger badge-outline",children:"Select Address Type"}),e.jsx("option",{value:"1",children:"Home"}),e.jsx("option",{value:"2",children:"Office"}),e.jsx("option",{value:"3",children:"Other"})]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:l.address_type||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"building_number",className:"block text-gray-700 font-semibold",children:"Building Number"}),e.jsx("input",{type:"text",id:"building_number",name:"building_number",value:f.building_number,onChange:a=>A({...f,building_number:a.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:l.building_number||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"area",className:"block text-gray-700 font-semibold",children:"Area"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"relative",children:e.jsx(Re,{value:f.area,onChange:b,onSelect:P,children:({getInputProps:a,suggestions:g,getSuggestionItemProps:r,loading:m})=>e.jsxs(e.Fragment,{children:[e.jsx("input",{...a({className:"w-full input border border-gray-300 rounded-md p-2",id:"area",type:"text",onFocus:()=>w(!0),onBlur:()=>w(!1)})}),z&&g.length>0&&e.jsx("div",{className:"absolute bg-white border z-10 border-gray-200 rounded-lg w-full text-sm max-h-[150px] overflow-y-auto",children:e.jsxs("ul",{className:"custom-ul",children:[m&&e.jsx("li",{className:"block px-4 py-[0.8rem] hover:bg-gray-100 w-full",children:"Loading..."}),!m&&g.map((S,T)=>{const{...$}=r(S);return e.jsx("li",{...$,className:"block px-2 py-[0.8rem] hover:bg-gray-100 w-full cursor-pointer font-style",children:S==null?void 0:S.description},T)})]})})]})})}),l.area&&e.jsx("p",{className:"w-full text-red-500 text-sm",children:l.area||" "})||N&&e.jsx("p",{className:"aam-error-label",children:"please select valid area from dropdown"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"landmark",className:"block text-gray-700 font-semibold",children:"Landmark"}),e.jsx("input",{type:"text",id:"landmark",name:"landmark",value:f.landmark,onChange:a=>A({...f,landmark:a.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:l.landmark||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pincode",className:"block text-gray-700 font-semibold",children:"Pin code"}),e.jsx("input",{type:"text",id:"pincode",name:"pincode",value:f.pincode,onChange:a=>A({...f,pincode:a.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:l.pincode||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city",className:"block text-gray-700 font-semibold",children:"City"}),e.jsx("input",{type:"text",id:"city",name:"city",value:f.city,onChange:a=>A({...f,city:a.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:l.city||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"state",className:"block text-gray-700 font-semibold",children:"State"}),e.jsx("input",{type:"text",id:"state",name:"state",value:f.state,onChange:a=>A({...f,state:a.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:l.state||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"country",className:"block text-gray-700 font-semibold",children:"Country"}),e.jsx("input",{type:"text",id:"country",name:"country",value:f.country,onChange:a=>A({...f,country:a.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:l.country||" "})]})]}),e.jsxs("div",{className:"flex justify-end mt-6",children:[e.jsx("button",{type:"button",onClick:u,className:"btn btn-light mr-2",disabled:c,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c,className:`btn btn-primary ${c?"opacity-50 cursor-not-allowed":""}`,children:c?"Submitting...":"Submit"})]})]})]})]})},Vt=({isOpen:d,onClose:u,setIsSubmit:v,onCustomerCreated:y})=>{const{addUser:p,loading:n}=kt(),{addAddress:j,loading:c}=Ue(),[l,k]=_.useState({first_name:"",last_name:"",email:"",mobile_number:"",gender:null,role_id:5}),[N,E]=_.useState({building_number:"",area:"",landmark:"",pincode:"",city:"",state:"",country:"",user_id:null,full_name:"",address_type:null}),[f,A]=_.useState({}),[z,w]=_.useState(!1),[b,P]=_.useState(!1);_.useEffect(()=>{d||(k({first_name:"",last_name:"",email:"",mobile_number:"",gender:null,role_id:5}),E({building_number:"",area:"",landmark:"",pincode:"",city:"",state:"",country:"",user_id:null,full_name:"",address_type:null}),A({}))},[d]);const t=r=>{E({...N,area:r}),P(!0)},a=async r=>{E({...N,area:r});try{const m=await ue.geocodeByAddress(r),S=await ue.getLatLng(m[0]);S&&E(T=>({...T,lat:S==null?void 0:S.lat,long:S==null?void 0:S.lng}))}catch{I.error("Failed to fetch address detail",{className:"toast-error"})}},g=async r=>{r.preventDefault();try{await Ct().validate(l,{abortEarly:!1}),await Me.validate(N,{abortEarly:!1});const m=await p(l);if(m!=null&&m.user_id){const S={...N,user_id:m.user_id,full_name:`${m.first_name} ${m.last_name}`},T=await j(S,!1);T&&(y(m,T),u(),v(!0))}}catch(m){if(m instanceof Ae){const S={};m.inner.forEach(T=>{S[T.path||""]=T.message}),A(S)}else I.error("Failed to submit the form. Please try again.")}};return d?e.jsxs("div",{className:"fixed inset-0 grid overflow-auto items-center justify-center z-50 p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:u}),e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-5xl w-full smobile:min-w-[85%] z-10 relative",children:[e.jsx("button",{className:"btn btn-sm btn-icon btn-light btn-outline absolute top-0 right-0 mr-5 mt-5 lg:mr-5 shadow-default",onClick:u,children:e.jsx("i",{className:"ki-filled ki-cross"})}),e.jsxs("form",{children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Customer Info"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-1",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"first_name",className:"block text-gray-700 font-semibold",children:"First name"}),e.jsx("input",{type:"text",id:"first_name",name:"first_name",value:l.first_name||"",onChange:r=>k({...l,first_name:r.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"text-red-500 text-sm",children:f.first_name||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"last_name",className:"block text-gray-700 font-semibold",children:"Last name"}),e.jsx("input",{type:"text",id:"last_name",name:"last_name",value:l.last_name,onChange:r=>k({...l,last_name:r.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"text-red-500 text-sm",children:f.last_name||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-gray-700 font-semibold",children:"Email"}),e.jsx("input",{type:"text",id:"email",name:"email",value:l.email,onChange:r=>k({...l,email:r.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"text-red-500 text-sm",children:f.email||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mobile_number",className:"block text-gray-700 font-semibold",children:"Mobile Number"}),e.jsx("input",{type:"text",id:"mobile_number",name:"mobile_number",value:l.mobile_number,onChange:r=>k({...l,mobile_number:r.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"text-red-500 text-sm",children:f.mobile_number||" "})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"mb-2 block text-gray-700 font-semibold",children:"Gender"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"gender",value:1,checked:l.gender===1,onChange:r=>k({...l,gender:parseInt(r.target.value)}),className:"radio radio-primary"}),e.jsx("span",{className:"text-sm",children:"Male"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"gender",value:2,checked:l.gender===2,onChange:r=>k({...l,gender:parseInt(r.target.value)}),className:"radio radio-primary"}),e.jsx("span",{className:"text-sm",children:"Female"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"gender",value:3,checked:l.gender===3,onChange:r=>k({...l,gender:parseInt(r.target.value)}),className:"radio radio-primary"}),e.jsx("span",{className:"text-sm",children:"Other"})]})]}),e.jsx("p",{className:"text-red-500 text-sm",children:f.gender||" "})]})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Address"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-1",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"country",className:"block text-gray-700 font-semibold",children:"Address Type"}),e.jsxs("select",{className:"select select-lg text-sm w-full p-2 border border-gray-300 rounded-md",onChange:r=>E({...N,address_type:Number(r.target.value)}),children:[e.jsx("option",{value:"",selected:!0,disabled:!0,className:"badge-danger badge-outline",children:"Select Address Type"}),e.jsx("option",{value:"1",children:"Home"}),e.jsx("option",{value:"2",children:"Office"}),e.jsx("option",{value:"3",children:"Other"})]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:f.address_type||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"building_number",className:"block text-gray-700 font-semibold",children:"Building Number"}),e.jsx("input",{type:"text",id:"building_number",name:"building_number",value:N.building_number,onChange:r=>E({...N,building_number:r.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:f.building_number||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"area",className:"block text-gray-700 font-semibold",children:"Area"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"relative",children:e.jsx(Re,{value:N.area,onChange:t,onSelect:a,children:({getInputProps:r,suggestions:m,getSuggestionItemProps:S,loading:T})=>e.jsxs(e.Fragment,{children:[e.jsx("input",{...r({className:"w-full input border border-gray-300 rounded-md p-2",id:"area",type:"text",onFocus:()=>P(!0),onBlur:()=>P(!1)})}),b&&m.length>0&&e.jsx("div",{className:"absolute bg-white border z-10 border-gray-200 rounded-lg w-full text-sm max-h-[150px] overflow-y-auto",children:e.jsxs("ul",{className:"custom-ul",children:[T&&e.jsx("li",{className:"block px-4 py-[0.8rem] hover:bg-gray-100 w-full",children:"Loading..."}),!T&&m.map(($,H)=>{const{...C}=S($);return e.jsx("li",{...C,className:"block px-2 py-[0.8rem] hover:bg-gray-100 w-full cursor-pointer font-style",children:$==null?void 0:$.description},H)})]})})]})})}),f.area&&e.jsx("p",{className:"w-full text-red-500 text-sm",children:f.area||" "})||z&&e.jsx("p",{className:"aam-error-label",children:"please select valid area from dropdown"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"landmark",className:"block text-gray-700 font-semibold",children:"Landmark"}),e.jsx("input",{type:"text",id:"landmark",name:"landmark",value:N.landmark,onChange:r=>E({...N,landmark:r.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:f.landmark||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pincode",className:"block text-gray-700 font-semibold",children:"Pin code"}),e.jsx("input",{type:"text",id:"pincode",name:"pincode",value:N.pincode,onChange:r=>E({...N,pincode:r.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:f.pincode||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city",className:"block text-gray-700 font-semibold",children:"City"}),e.jsx("input",{type:"text",id:"city",name:"city",value:N.city,onChange:r=>E({...N,city:r.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:f.city||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"state",className:"block text-gray-700 font-semibold",children:"State"}),e.jsx("input",{type:"text",id:"state",name:"state",value:N.state,onChange:r=>E({...N,state:r.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:f.state||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"country",className:"block text-gray-700 font-semibold",children:"Country"}),e.jsx("input",{type:"text",id:"country",name:"country",value:N.country,onChange:r=>E({...N,country:r.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:f.country||" "})]})]})]})]}),e.jsxs("div",{className:"flex justify-end mt-6",children:[e.jsx("button",{type:"button",onClick:u,className:"btn btn-light mr-2",disabled:n||c,children:"Cancel"}),e.jsx("button",{type:"button",onClick:g,disabled:n||c,className:`btn btn-primary ${n||c?"opacity-50 cursor-not-allowed":""}`,children:n||c?"Submitting...":"Submit"})]})]})]})]}):null},ts=()=>{const{prices:d}=jt(),{categories:u}=vt(),{fetchProductsOnId:v}=mt(),{fetchServicesOnId:y}=pt(),[p,n]=_.useState(""),[j,c]=_.useState(!0),{id:l}=gt(),{updateOrder:k,loading:N}=Ft(),{addOrder:E,loading:f}=Et(),A=Number(l),z=1e3,w=1,[b,P]=_.useState(!1),[t,a]=_.useState(!1),[g,r]=_.useState(!1),{users:m,fetchUsersByRole:S}=St(),{validCoupons:T,fetchValidCoupons:$}=It(),{branches:H}=Nt(w,z),{order:C,fetchOrder:R}=wt(),{address:V,fetchAddress:Z}=qt(),{applyCoupon:me}=Ot(),{userData:Q,fetchUser:ie}=At(),{transactionId:ae,generatePaymentLink:je,loading:pe}=Lt(),X=Q==null?void 0:Q.user,U=ht(),re=_.useRef(null),[ge,Ne]=_.useState({}),[ne,D]=_.useState({}),B=_.useRef(null),[ee,de]=_.useState(!1),he=ft(),[o,F]=_.useState({coupon_code:"",coupon_discount:null,express_delivery_charges:null,normal_delivery_charges:null,payment_type:null,payment_status:null,sub_total:0,paid_amount:null,transaction_id:"",address_id:null,username:"",user_id:null,items:[{category_id:null,product_id:null,service_id:null,product_name:"",service_name:"",description:null,price:null,quantity:1,item_Total:null,showDescription:!1}],total:0,branch_id:null,order_status:null}),[Be,Ge]=_.useState({coupon_code:"",coupon_discount:null,express_delivery_charges:null,normal_delivery_charges:null,payment_type:null,payment_status:null,sub_total:0,paid_amount:null,transaction_id:"",address_id:null,username:"",user_id:null,items:[{category_id:null,product_id:null,service_id:null,product_name:"",service_name:"",description:null,price:null,quantity:1,item_Total:null,showDescription:!1}],total:0,branch_id:null,order_status:null}),[L,ze]=_.useState({});_.useEffect(()=>{const s=i=>{B.current&&!B.current.contains(i.target)&&re.current&&!re.current.contains(i.target)&&(c(!1),de(!1))};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[]),_.useEffect(()=>{(async()=>{await R(A)})()},[A]),_.useEffect(()=>{(async()=>{o.user_id&&(await Z(o.user_id),await $(o.user_id),await ie(o.user_id)),g&&(await Z(o.user_id),r(!1))})()},[o.user_id,g]),_.useEffect(()=>{ae&&F({...o,transaction_id:ae})},[ae]),_.useEffect(()=>{A||F(s=>({...s,payment_status:o.payment_type===1?1:null}))},[o.payment_type]),_.useEffect(()=>{(async()=>{ee&&(!p||p.trim()==="")?(c(!0),await S(5)):p&&j&&await S(5,p)})()},[ee,p,j]),_.useEffect(()=>{if(C){const s=`${C.user.first_name} ${C.user.last_name}`;n(s),c(!1);const i={coupon_code:C.coupon_code||"",coupon_discount:C.coupon_discount||null,express_delivery_charges:C.express_delivery_charges||null,normal_delivery_charges:C.normal_delivery_charges||null,payment_type:C.payment_type||null,payment_status:C.payment_status||null,sub_total:C.sub_total||0,paid_amount:C.paid_amount||null,transaction_id:C.transaction_id||"",address_id:C.address_id,username:s,user_id:C.user_id||null,items:C.items.map(h=>{var M,oe,be,q;const O=h.category.category_id,x=((M=h.product)==null?void 0:M.product_id)||null,K=((oe=h.service)==null?void 0:oe.service_id)||null,fe=((be=h.product)==null?void 0:be.name)||"",J=((q=h.service)==null?void 0:q.name)||"";return{category_id:O,product_id:x,service_id:K,product_name:fe,service_name:J,description:h.description||null,price:h.price,quantity:h.quantity,item_Total:h.price*h.quantity,showDescription:!!h.description}}),total:(C.sub_total||0)+(C.express_delivery_charges||0)+(C.normal_delivery_charges||0),branch_id:C.branch_id,order_status:C.order_status};F(i),Ge(i)}},[C]);const Ke=async s=>{var i,h;s.preventDefault();try{const O=o.items.map(M=>({category_id:Number(M.category_id),product_id:Number(M.product_id),service_id:Number(M.service_id),description:M.description,price:Number(M.price),quantity:Number(M.quantity)})),x={...o,address_id:Number(o.address_id),coupon_discount:Number(o.coupon_discount),normal_delivery_charges:Number(o.normal_delivery_charges),paid_amount:Number(o.paid_amount),express_delivery_charges:Number(o.express_delivery_charges),payment_type:Number(o.payment_type),payment_status:Number(o.payment_status),order_status:A?o.order_status:4,items:O},K=o.sub_total+o.express_delivery_charges+o.normal_delivery_charges;if(await Ut.validate(x,{abortEarly:!1,context:{total:K}}),!Object.keys(o).some(M=>o[M]!==Be[M])){he(`${(i=U==null?void 0:U.state)==null?void 0:i.prevUrl}`);return}let J;C?J=await k(A,x):J=await E(x),J&&he(`${(h=U==null?void 0:U.state)==null?void 0:h.prevUrl}`)}catch(O){if(O instanceof Ae){const x={};O.inner.forEach(K=>{x[K.path||""]=K.message}),ze(x)}else I.error("Failed to submit the form. Please try again.")}},Ve=s=>{n(s.target.value),c(!0)},Je=s=>{const i=`${s.first_name} ${s.last_name}`;n(i),c(!1),F({...o,username:i,user_id:s.user_id})},We=()=>{var s;he(`${(s=U==null?void 0:U.state)==null?void 0:s.prevUrl}`)},He=()=>{F(s=>({...s,items:[...s.items,{category_id:null,product_id:null,product_name:"",service_id:null,service_name:"",description:null,price:null,quantity:1,item_Total:null,showDescription:!1}]}))},Qe=s=>{F(i=>{const h=i.items.filter((fe,J)=>J!==s),O={...i,items:h,coupon_code:"",coupon_discount:0},x=we(O),K=x+Number(o.express_delivery_charges||0)+Number(o.normal_delivery_charges||0);return{...O,sub_total:x,total:K}})},te=async(s,i,h)=>{["category_id","product_id","service_id","price","quantity"].includes(i)&&F(O=>({...O,coupon_code:"",coupon_discount:0})),F(O=>{const x=O.items.map((oe,be)=>{if(be===s){const q={...oe,[i]:h};i==="showDescription"&&(q.showDescription=h);const Oe=Number(q.category_id),Ie=Number(q.product_id),Te=Number(q.service_id),De=Number(q.quantity)||1;if(i==="category_id"){const Y=Number(h);ge[Y]||v(Y).then(xe=>{Ne(ye=>({...ye,[Y]:xe}))}),q.product_id=null,q.service_id=null}if(i==="product_id"){const Y=Number(oe.category_id),xe=Number(h),ye=`${Y}_${xe}`;ne[ye]||y(Y,xe).then(ot=>{D(lt=>({...lt,[ye]:ot}))}),q.service_id=null}if(["category_id","product_id","service_id"].includes(i))if(Oe&&Ie&&Te){const Y=Xe(Oe,Ie,Te);q.price=Y,q.item_Total=Y*De}else q.price=null,q.item_Total=null;else i==="price"?q.item_Total=h*De:i==="quantity"&&(q.item_Total=q.price*Number(h));return q}return oe}),K={...O,items:x},J=we(K)-O.coupon_discount,M=J+Number(O.express_delivery_charges||0)+Number(O.normal_delivery_charges||0);return{...K,sub_total:J,total:M}})},Xe=(s,i,h)=>{const O=`${s}_${i}_${h}`;return d[O]||0},Ye=async s=>{const i=we(o),h=await me(o.user_id,i,s),O=Number(h.finalTotal||0)+Number(o.express_delivery_charges||0)+Number(o.normal_delivery_charges||0);h&&F(x=>({...x,coupon_code:s,coupon_discount:h.discountAmount,sub_total:h.finalTotal,total:O}))},we=s=>s.items.reduce((i,h)=>i+(h.item_Total||0),0),Pe=(s,i)=>{F(h=>{const O={...h,[s]:i},x=Number(O.sub_total||0)+Number(O.express_delivery_charges||0)+Number(O.normal_delivery_charges||0);return{...O,total:x}})},Ze=s=>{const i=s.target.value;F(h=>({...h,address_id:Number(i)}))},et=s=>{s.preventDefault(),o.user_id?P(!0):I.error("Please select the user to add address")},tt=s=>{s.preventDefault(),a(!0)},st=()=>{he(`/order/${A}`)},at=async()=>{const s=[];if(o.paid_amount||s.push("Paid amount"),o.username||s.push("Customer name"),s.length>0){I.error(`Please add Missing Fields: ${s.join(", ")}`);return}const i={amount:o.paid_amount,currency:"INR",user_id:o.user_id,customer:{name:o.username,contact:X==null?void 0:X.mobile_number,email:X==null?void 0:X.email}};await je(i)},rt=(s,i)=>{if(s){const h=`${s.first_name} ${s.last_name}`;n(h),c(!1),F({...o,username:h,user_id:s.user_id})}i&&F(h=>({...h,address_id:i.address_id}))},nt=s=>{s&&F(i=>({...i,address_id:s.address_id}))};return e.jsx("div",{className:"container-fixed",children:e.jsxs("div",{className:"card max-w-5xl mx-auto p-6 bg-white shadow-md",children:[e.jsxs("div",{className:"flex",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:C?"Edit Order":"Add Order"}),!isNaN(A)&&e.jsxs("button",{className:"btn bg-gray-200 ml-4 text-gray-700 text-sm font-bold rounded-md",onClick:st,children:[e.jsx(bt,{size:20}),"View Order"]})]}),e.jsxs("form",{onSubmit:Ke,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-y-1 gap-x-6 mt-4",children:[e.jsxs("div",{className:"relative col-span-1",children:[e.jsxs("span",{className:"flex justify-between items-center",children:[e.jsx("label",{htmlFor:"username",className:"block text-gray-700 text-sm font-bold mb-2",children:"Customer name"}),e.jsx("button",{className:"btn btn-sm btn-primary -mt-6 sm:btn-lg",onClick:tt,children:"Add Customer"})]}),e.jsx("input",{type:"text",id:"username",ref:re,autoComplete:"off",value:p||"",onChange:Ve,className:"input border border-gray-300 rounded-md p-2 w-full mb-2",placeholder:"Search customer...",onFocus:()=>{de(!0),c(!0)}}),m&&j&&e.jsx("ul",{ref:B,className:"absolute -mt-2 bg-white border z-10 border-gray-300 rounded-md p-2 w-full text-sm max-h-[400px] overflow-y-auto",children:m.length>0?m.map(s=>e.jsxs("li",{className:"p-2 hover:bg-gray-100 cursor-pointer",onClick:()=>Je(s),children:[s.first_name," ",s.last_name," (",s.mobile_number,")"]},s.user_id)):e.jsx("li",{className:"p-2 text-gray-500",children:"No users found"})}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:L.username||" "})]}),e.jsxs("div",{className:"relative col-span-1",children:[e.jsxs("span",{className:"flex justify-between items-center",children:[e.jsx("label",{htmlFor:"address",className:"block text-gray-700 text-sm font-bold mb-2",children:"Customer address"}),e.jsx("button",{className:"btn btn-sm btn-primary -mt-6",onClick:et,children:"Add address"})]}),e.jsxs("select",{id:"address",value:o.address_id,onChange:Ze,className:"select border border-gray-300 rounded-md w-full text-sm",children:[e.jsx("option",{value:"",selected:!0,disabled:!0,children:"Select Address"}),V.length>0?V.map(s=>e.jsxs("option",{value:s.address_id,children:[s.building_number,", ",s.area,", ",s.landmark,","," ",s.city,", ",s.state,",",s.country,", ",s.pincode]},s.address_id)):e.jsx("option",{disabled:!0,children:"No Address Available"})]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:L.address_id||" "})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{htmlFor:"branch",className:"block text-gray-700 text-sm font-bold mb-2",children:"Branch"}),e.jsxs("select",{id:"branch",className:"select border border-gray-300 rounded-md p-2 w-full text-sm",value:o.branch_id||"",onChange:s=>F({...o,branch_id:s.target.value?Number(s.target.value):null}),children:[e.jsx("option",{value:"",disabled:!0,children:"Select Branch"}),H.length>0?H.map(s=>e.jsx("option",{value:s.branch_id,children:s.branch_name},s.branch_id)):e.jsx("option",{children:"No Data Available"})]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:L.branch_id||" "})]})]}),e.jsx("div",{className:"flex flex-wrap",children:e.jsx("h1",{className:"text-xl font-semibold leading-none text-gray-900 mt-6 mb-5 ml-1",children:"Item"})}),o.items.map((s,i)=>{var h,O;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"border border-gray-200 rounded-xl mt-4 p-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(150px,4fr))] gap-x-5 gap-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-gray-700 text-sm font-bold mb-2",children:"Category"}),e.jsxs("select",{id:"category",value:s.category_id??"",onChange:x=>te(i,"category_id",x.target.value),className:"select border border-gray-300 rounded-md p-2 w-full text-sm",children:[e.jsx("option",{value:"",disabled:!0,children:"Select Category"}),u.map(x=>e.jsx("option",{value:x.category_id,children:x.name},x.category_id))]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:L[`items[${i}].category_id`]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"product",className:"block text-gray-700 text-sm font-bold mb-2",children:"Product"}),e.jsxs("select",{id:"product",value:s.product_id??"",onChange:x=>te(i,"product_id",x.target.value),className:"select border border-gray-300 rounded-md p-2 w-full text-sm",children:[e.jsx("option",{value:"",disabled:!0,children:"Select Product"}),((h=ge[s.category_id])==null?void 0:h.map(x=>e.jsx("option",{value:x.product_product_id,children:x.product_name},x.product_product_id)))||s.product_id&&e.jsx("option",{value:s.product_id,children:s.product_name},s.product_id)]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:L[`items[${i}].product_id`]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"service",className:"block text-gray-700 text-sm font-bold mb-2",children:"Service"}),e.jsxs("select",{id:"service",value:s.service_id??"",onChange:x=>te(i,"service_id",x.target.value),className:"select border border-gray-300 rounded-md p-2 w-full text-sm",children:[e.jsx("option",{value:"",disabled:!0,children:"Select Service"}),(O=ne[`${s.category_id}_${s.product_id}`])==null?void 0:O.map(x=>e.jsx("option",{value:x.service_service_id,children:x.service_name},x.service_service_id))]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:L[`items[${i}].service_id`]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Price"}),e.jsx("input",{type:"text",value:s.price||"",onChange:x=>te(i,"price",x.target.value),className:`input border rounded-md p-2 w-full ${isNaN(A)?"border-gray-300 bg-gray-100 text-sm text-gray-600 cursor-not-allowed focus:outline-none":"border-gray-300"}`,readOnly:isNaN(A)}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:L[`items[${i}].price`]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"quantity",children:"Quantity"}),e.jsx("input",{type:"text",id:"quantity",value:s.quantity??1,onChange:x=>te(i,"quantity",x.target.value),className:"input border border-gray-300 rounded-md p-2 w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Item total"}),e.jsx("input",{type:"text",value:s.item_Total??"",onChange:x=>te(i,"item_Total",x.target.value),min:"0",step:"0.01",readOnly:!0,className:"input w-full border border-gray-300 bg-gray-100 text-sm text-gray-600 rounded-md p-2 cursor-not-allowed focus:outline-none"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"description_checkbox",className:"block text-gray-700 text-sm font-bold mb-2",children:"Description"}),e.jsx("input",{className:"checkbox checkbox-lg ml-5",id:"description_checkbox","data-datatable-check":"true",type:"checkbox",checked:s.showDescription,onChange:x=>te(i,"showDescription",x.target.checked)}),e.jsx("p",{className:" text-red-500 text-sm",children:" "})]})]})},i),e.jsxs("div",{className:"flex justify-between sm:items-center smmobile:flex-col gap-y-2 smmobile:w-full",children:[e.jsx("div",{children:s.showDescription&&e.jsx("div",{children:e.jsxs("div",{className:"flex mt-2 smmobile:w-[100%] smmobile:justify-self-start flex-col md:w-[350px] lg:w-[420px] sm:w-[300px] h-[80px] mb-2",children:[e.jsx("label",{htmlFor:"description",className:"block text-gray-700 text-sm font-bold mb-2",children:"Description"}),e.jsx("textarea",{id:"description",value:s.description||"",onChange:x=>te(i,"description",x.target.value),className:"h-full input border border-gray-300 rounded-md p-2 w-full"})]})})}),e.jsx("div",{className:"flex block-element flex-end smmobile:justify-self-end justify-end relative",children:e.jsx("div",{children:e.jsx("button",{type:"button",className:`p-2 rounded-full ${o.items.length>1?"bg-red-100 hover:bg-red-200":"bg-gray-200 cursor-not-allowed"}`,onClick:()=>Qe(i),disabled:o.items.length===1,children:e.jsx(xt,{className:`${o.items.length>1?"text-red-500":"text-gray-400"}`})})})})]})]})})}),e.jsx("button",{type:"button",onClick:He,className:"btn btn-secondary mb-6 mt-4",children:"Add Item"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"coupon_code",children:"Coupon Code"}),e.jsxs("select",{id:"coupon_code",className:"select border border-gray-300 rounded-md p-2 w-full text-sm",value:o.coupon_code??"",onChange:s=>{const i=T.find(h=>h.code===s.target.value);Ye(i==null?void 0:i.code)},children:[e.jsx("option",{value:"",disabled:!0,children:"Select Coupon Code"}),T&&T.length>0?T.map(s=>e.jsx("option",{value:s.code,children:s.code},s.coupon_id)):e.jsx("option",{children:"No Coupons available"})]}),e.jsx("p",{className:"text-red-500 text-sm",children:L.coupon_code||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Coupon Discount"}),e.jsx("input",{type:"text",value:o.coupon_discount||"",readOnly:!0,className:"input border border-gray-300 bg-gray-100 text-sm text-gray-600 rounded-md p-2 cursor-not-allowed focus:outline-none"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:L.coupon_discount||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"express_delivery_charges",className:"block text-gray-700 text-sm font-bold mb-2",children:"Express Delivery Charge"}),e.jsx("input",{type:"text",id:"express_delivery_charges",autoComplete:"off",min:"0",value:o.express_delivery_charges||"",onChange:s=>Pe("express_delivery_charges",s.target.value),className:`${o.normal_delivery_charges>0?"input border border-gray-300 rounded-md p-2 bg-gray-100 cursor-not-allowed focus:outline-none":"input border border-gray-300 rounded-md p-2"}`,readOnly:o.normal_delivery_charges>0}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:L.express_delivery_charges||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"normal_delivery_charges",className:"block text-gray-700 text-sm font-bold mb-2",children:"Normal Delivery Charge"}),e.jsx("input",{type:"text",id:"normal_delivery_charges",min:"0",autoComplete:"off",value:o.normal_delivery_charges||"",onChange:s=>Pe("normal_delivery_charges",s.target.value),className:`${o.express_delivery_charges>0?"input border border-gray-300 rounded-md p-2 bg-gray-100 cursor-not-allowed focus:outline-none":"input border border-gray-300 rounded-md p-2"}`,readOnly:o.express_delivery_charges>0}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:L.normal_delivery_charges||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Sub Total"}),e.jsx("input",{type:"text",value:o.sub_total||"",readOnly:!0,className:"input border border-gray-300 bg-gray-100 text-sm text-gray-600 rounded-md p-2 cursor-not-allowed focus:outline-none"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:L.sub_total||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Total"}),e.jsx("input",{type:"text",value:o.total||"",readOnly:!0,className:"input border border-gray-300 bg-gray-100 text-sm text-gray-600 rounded-md p-2 cursor-not-allowed focus:outline-none"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"paid_amount",className:"block text-gray-700 text-sm font-bold mb-2",children:"Paid amount"}),e.jsx("input",{type:"text",id:"paid_amount",autoComplete:"off",value:o.paid_amount||"",onChange:s=>{F({...o,paid_amount:Number(s.target.value)})},className:"input border border-gray-300 rounded-md p-2",min:"0",step:"0.01"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:L.paid_amount||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"payment_method",className:"block text-gray-700 text-sm font-bold mb-2",children:"Payment Method"}),e.jsxs("select",{className:"select border border-gray-300 rounded-md p-2 w-full text-sm",id:"payment_method",value:o.payment_type??"",onChange:s=>F({...o,payment_type:Number(s.target.value)}),children:[e.jsx("option",{value:"",disabled:!0,children:"Select Payment Type"}),e.jsx("option",{value:1,children:"Cash on Delivery"}),e.jsx("option",{value:2,children:"Online Payment"})]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:L.payment_type||" "}),!A&&o.payment_type===2&&e.jsx("div",{children:e.jsxs("button",{type:"button",className:"relative min-w-[160px] min-h-[40px] flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 border border-blue-500 rounded-lg hover:bg-blue-100 transition disabled:opacity-50",onClick:at,disabled:pe,children:[e.jsx("div",{className:"w-4 h-4 flex items-center justify-center",children:pe?e.jsx(yt,{}):e.jsx(_t,{className:"w-4 h-4 text-blue-600"})}),e.jsx("span",{children:"Send Payment Link"})]})})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"payment_status",className:"block text-gray-700 text-sm font-bold mb-2",children:"Payment Status"}),e.jsxs("select",{className:"select border border-gray-300 rounded-md p-2 w-full text-sm",id:"payment_status",value:o.payment_status??"",onChange:s=>F({...o,payment_status:Number(s.target.value)}),children:[e.jsx("option",{value:"",disabled:!0,children:"Select Payment Status"}),e.jsx("option",{value:1,children:"Pending"}),e.jsx("option",{value:2,children:"Received"}),e.jsx("option",{value:3,children:"Partial Received"})]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:L.payment_status||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"transaction_id",className:"block text-gray-700 text-sm font-bold mb-2",children:"Transaction ID"}),e.jsx("input",{type:"text",id:"transaction_id",autoComplete:"off",value:o.transaction_id??"",onChange:s=>F({...o,transaction_id:s.target.value}),className:"input border border-gray-300 text-sm text-gray-600 rounded-md p-2 focus:outline-none"})]})]}),e.jsxs("div",{className:"mt-6 flex gap-4",children:[e.jsx("button",{type:"submit",className:`btn btn-primary ${f||N?"opacity-50 cursor-not-allowed":""}`,disabled:f||N,children:f||N?f?"Adding...":"Updating...":A?"Update Order":"Add Order"}),e.jsx("button",{type:"button",onClick:We,className:"btn btn-secondary",disabled:f||N,children:"Cancel"})]})]}),e.jsx(Kt,{onAddressAdded:nt,isOpen:b,setIsSubmit:r,onClose:()=>P(!1),userId:o.user_id,fullname:o.username}),e.jsx(Vt,{onCustomerCreated:rt,isOpen:t,setIsSubmit:r,onClose:()=>a(!1)})]})})};export{ts as default};
