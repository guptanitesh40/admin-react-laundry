import{r as m,B as U,V as E,a as $,d as x,O as P,e as R,j as e,L as O,b as q,h as I,m as T,Q as H,k as D,F as z}from"./index-BGh3CDNo.js";import{au as G,av as V}from"./AdapterDayjs-DPiPH6vo.js";import{D as Y}from"./DatePicker-yzw03NU2.js";const B=()=>{const[s,g]=m.useState(),[p,S]=m.useState();return{settingsData:p,fetchSetting:async()=>{const d=localStorage.getItem("authToken");g(!0);try{const f=await fetch(`${U}/admin/settings`,{method:"GET",headers:{Authorization:d?`Bearer ${d}`:""}}),_=await f.json();if(!f.ok){E.error(_.message,{position:"top-center"}),g(!1);return}S(_)}catch(f){E.error(f||"Network Error: Fail to fetch data")}finally{g(!1)}},loading:s}},J=$().shape({estimate_pickup_normal_hour:x().notRequired().test("is-numeric","Estimate pickup normal hour must be a positive number",s=>s?/^\d+$/.test(s):!0),estimate_pickup_express_hour:x().notRequired().test("is-numeric","Estimate pickup express hour must be a positive number",s=>s?/^\d+$/.test(s):!0),gst_percentage:x().notRequired().test("is-numeric","GST percentage must be a positive number",s=>s?/^\d+$/.test(s):!0),estimate_delivery_normal_day:x().notRequired().test("is-numeric","Estimate delivery normal day must be a positive number",s=>s?/^\d+$/.test(s):!0),estimate_delivery_express_day:x().notRequired().test("is-numeric","Estimate delivery express day must be a positive number",s=>s?/^\d+$/.test(s):!0),normal_delivery_charges:x().notRequired().test("is-numeric","Normal delivery charge must be a positive number",s=>s?/^\d+$/.test(s):!0),express_delivery_charge:x().notRequired().test("is-numeric","Express delivery charge must be a positive number",s=>s?/^\d+$/.test(s):!0),express_delivery_24hrs:x().notRequired().test("is-numeric","Express delivery charge must be a positive number",s=>s?/^\d+$/.test(s):!0),express_delivery_48hrs:x().notRequired().test("is-numeric","Express delivery charge must be a positive number",s=>s?/^\d+$/.test(s):!0),express_delivery_72hrs:x().notRequired().test("is-numeric","Express delivery charge must be a positive number",s=>s?/^\d+$/.test(s):!0)}),M=({})=>{const{settingsData:s,fetchSetting:g,loading:p}=B(),{addSetting:S,loading:b}=P(),[d,f]=m.useState({}),[_,k]=m.useState(!1),{hasPermission:t}=R(),i=s==null?void 0:s.data,[n,j]=m.useState({estimate_delivery_express_day:"",estimate_delivery_normal_day:"",estimate_pickup_express_hour:"",estimate_pickup_normal_hour:"",gst_percentage:"",normal_delivery_charges:"",express_delivery_charge:"",express_delivery_24hrs:"",express_delivery_48hrs:"",express_delivery_72hrs:""});m.useEffect(()=>{g(),k(!1)},[_]),m.useEffect(()=>{i&&j({estimate_delivery_express_day:i.estimate_delivery_express_day||"",estimate_delivery_normal_day:i.estimate_delivery_normal_day||"",estimate_pickup_express_hour:i.estimate_pickup_express_hour||"",estimate_pickup_normal_hour:i.estimate_pickup_normal_hour||"",gst_percentage:i.gst_percentage||"",normal_delivery_charges:i.normal_delivery_charges||"",express_delivery_charge:i.express_delivery_charge||"",express_delivery_24hrs:i.express_delivery_24hrs||"",express_delivery_48hrs:i.express_delivery_48hrs||"",express_delivery_72hrs:i.express_delivery_72hrs||""})},[i]);const u=async a=>{a.preventDefault();try{if(await J.validate(n,{abortEarly:!1}),!Object.keys(n).some(y=>n[y]!==i[y]))return;const N=Object.keys(n).map(y=>({setting_key:y,setting_value:n[y]}));await S(N)&&(f({}),k(!0))}catch(h){if(h instanceof q){const N={};h.inner.forEach(C=>{N[C.path||""]=C.message}),f(N)}else E.error("Failed to submit the form. Please try again.")}},r=(a,h)=>{j({...n,[a]:h})};return p?e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"card pb-2.5 min-w-full !border-gray-200",children:[e.jsx("div",{className:"card-header",children:e.jsx("span",{className:"inline-block h-[31px] min-w-32 bg-gray-200 rounded-md animate-pulse"})}),e.jsx("div",{children:e.jsxs("div",{className:"card-body grid gap-1",children:[Array.from({length:7}).map((a,h)=>e.jsx("div",{className:"w-full py-3",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("span",{className:"grow inline-block w-56 h-9 bg-gray-200 animate-pulse rounded-md"}),e.jsx("span",{className:"grow inline-block w-56 h-9 bg-gray-200 animate-pulse rounded-md"})]})},h)),e.jsx("div",{className:"flex relative justify-end pt-2.5",children:e.jsx("span",{className:"inline-block w-32 h-12 bg-gray-200 animate-pulse rounded-md"})})]})})]})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"card pb-2.5 min-w-full",children:[e.jsx("div",{className:"card-header",id:"basic_settings",children:e.jsx("h3",{className:"card-title",children:"General Settings"})}),e.jsx("form",{onSubmit:u,children:e.jsxs("div",{className:"card-body grid gap-1",children:[e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"estimate_pickup_normal_hour",children:"Estimate Pickup Normal Hour (In Hour)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${t(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"estimate_pickup_normal_hour",autoComplete:"off",value:n.estimate_pickup_normal_hour||"",onChange:a=>r("estimate_pickup_normal_hour",a.target.value),readOnly:!t(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:d.estimate_pickup_normal_hour||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"estimate_pickup_express_hour",children:"Estimate Pickup Express Hour (In Hour)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${t(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"estimate_pickup_express_hour",autoComplete:"off",value:n.estimate_pickup_express_hour||"",onChange:a=>r("estimate_pickup_express_hour",a.target.value),readOnly:!t(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:d.estimate_pickup_express_hour||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"gst_percentage",children:"GST Percentage (%)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${t(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"gst_percentage",autoComplete:"off",value:n.gst_percentage,onChange:a=>r("gst_percentage",a.target.value),readOnly:!t(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:d.gst_percentage||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"estimate_delivery_normal_day",children:"Estimate Delivery Normal Day (Day)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${t(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"estimate_delivery_normal_day",autoComplete:"off",value:n.estimate_delivery_normal_day,onChange:a=>r("estimate_delivery_normal_day",a.target.value),readOnly:!t(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:d.estimate_delivery_normal_day||" "})]})]})}),e.jsx("div",{className:"w-full",style:{display:"none"},children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"estimate_delivery_express_day",children:"Estimate Delivery Express Day (Day)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${t(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"estimate_delivery_express_day",autoComplete:"off",value:n.estimate_delivery_express_day,onChange:a=>r("estimate_delivery_express_day",a.target.value),readOnly:!t(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:d.estimate_delivery_express_day||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"normal_delivery_charges",children:"Normal Delivery Charge (Rs)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${t(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"normal_delivery_charges",autoComplete:"off",value:n.normal_delivery_charges,onChange:a=>r("normal_delivery_charges",a.target.value),readOnly:!t(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:d.normal_delivery_charges||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"express_delivery_24hrs",children:"Express Delivery 24 Hours (%)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${t(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"express_delivery_24hrs",autoComplete:"off",value:n.express_delivery_24hrs,onChange:a=>r("express_delivery_24hrs",a.target.value),readOnly:!t(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:d.express_delivery_24hrs||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"express_delivery_48hrs",children:"Express Delivery 48 Hours (%)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${t(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"express_delivery_48hrs",autoComplete:"off",value:n.express_delivery_48hrs,onChange:a=>r("express_delivery_48hrs",a.target.value),readOnly:!t(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:d.express_delivery_48hrs||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"express_delivery_72hrs",children:"Express Delivery 72 Hours (%)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${t(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"express_delivery_72hrs",autoComplete:"off",value:n.express_delivery_72hrs,onChange:a=>r("express_delivery_72hrs",a.target.value),readOnly:!t(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:d.express_delivery_72hrs||" "})]})]})}),t(2,"update")&&e.jsx("div",{className:"flex relative justify-end pt-2.5",children:e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:b,children:b?e.jsxs(e.Fragment,{children:["Saving... ",e.jsx(O,{})]}):e.jsx(e.Fragment,{children:"Save Changes "})})})]})})]})})})},Q=$().shape({title:x().required("Title is required"),price:T().required("Please enter price").typeError("Price must be a number").min(0,"Price must be a positive number"),promotion_code:x().notRequired().matches(/^[a-zA-Z0-9]*$/,"Coupon code can only contain letters and numbers").test("length","Coupon code must be between 3 and 30 characters long",s=>!s||s.length>=3&&s.length<=30).nullable(),image:I().test("fileType","Allowed Format : jpg, jpeg, png, ",s=>s&&s instanceof File?["image/jpeg","image/png","image/jpg"].includes(s.type):!0).test("dimensions","image dimention 632×445 pixels allowed",s=>!s||!(s instanceof File)?!0:new Promise(g=>{const p=new Image;p.src=URL.createObjectURL(s),p.onload=()=>{URL.revokeObjectURL(p.src),g(p.width===632&&p.height===445)},p.onerror=()=>{g(!1)}})).nullable()}),W=()=>{const{settingsData:s,fetchSetting:g,loading:p}=B(),{addSetting:S,loading:b}=P(),{updatePromotionBanner:d,loading:f}=H(),[_,k]=m.useState(null),[t,i]=m.useState({}),[n,j]=m.useState(!1),{hasPermission:u}=R(),[r,a]=m.useState({image:null,title:"",price:"",promotion_code:"",offer_validity:D()}),[h,N]=m.useState({image:null,title:"",price:"",promotion_code:"",offer_validity:D()});m.useEffect(()=>{g(),j(!1)},[n]),m.useEffect(()=>{var o,l;if(s){const c=JSON.parse((o=s==null?void 0:s.data)==null?void 0:o.home_promotion_banner_website),v=(l=s==null?void 0:s.data)==null?void 0:l.home_banner_image,w={...r,title:c.title||"",price:c.price||"",promotion_code:c.promotion_code||"",offer_validity:D(c.offer_validity),image:v};a(w),N(w)}},[s]);const C=o=>{a(l=>({...l,offer_validity:o}))},y=o=>{var c;const l=(c=o.target.files)==null?void 0:c[0];if(l){const v=URL.createObjectURL(l);k(v),a(w=>({...w,image:l}))}},L=async o=>{o.preventDefault();try{await Q.validate(r,{abortEarly:!1});let l;const c=new FormData;if(_!==null&&(c.append("home_banner_image",r.image),c.append("setting_key","home_banner_image"),l=await d(c),l&&(i({}),j(!0)),k(null)),!Object.keys(r).some(F=>F==="image"?!1:r[F]!==h[F]))return;const w={title:r.title,price:r.price,promotion_code:r.promotion_code,offer_validity:r.offer_validity},A=[{setting_key:"home_promotion_banner_website",setting_value:JSON.stringify(w)}];l=await S(A),l&&(i({}),j(!0))}catch(l){if(l instanceof q){const c={};l.inner.forEach(v=>{c[v.path||""]=v.message}),i(c)}else E.error("Failed to submit the form. Please try again.")}};return p?e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"card pb-2.5 min-w-full !border-gray-200",children:[e.jsx("div",{className:"card-header",children:e.jsx("span",{className:"inline-block h-[31px] min-w-32 bg-gray-200 rounded-md animate-pulse"})}),e.jsx("div",{children:e.jsxs("div",{className:"card-body grid gap-4",children:[e.jsx("div",{className:"flex items-center flex-wrap gap-2.5",children:e.jsx("div",{className:"flex justify-end bnmobile:justify-center flex-wrap grow gap-2.5",children:e.jsx("div",{className:"w-full max-w-[300px] h-[200px] rounded-md bg-gray-200 animate-pulse mdmobile:h-[150px]"})})}),Array.from({length:4}).map((o,l)=>e.jsx("div",{className:"w-full py-2",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("span",{className:"grow inline-block w-56 h-9 bg-gray-200 animate-pulse rounded-md"}),e.jsx("span",{className:"grow inline-block w-56 h-9 bg-gray-200 animate-pulse rounded-md"})]})},l)),e.jsx("div",{className:"flex relative justify-end pt-2.5",children:e.jsx("span",{className:"inline-block w-32 h-12 bg-gray-200 animate-pulse rounded-md"})})]})})]})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"card min-w-full pb-2.5",children:[e.jsx("div",{className:"card-header",id:"basic_settings",children:e.jsx("h3",{className:"card-title",children:"Promotion Banner"})}),e.jsx("form",{onSubmit:L,children:e.jsxs("div",{className:"card-body grid gap-4",children:[e.jsx("div",{className:"flex items-center flex-wrap gap-2.5",children:e.jsx("div",{className:"flex justify-end bnmobile:justify-center flex-wrap grow gap-2.5",children:e.jsxs("div",{className:"image-input relative","data-image-input":"true",children:[e.jsx("label",{htmlFor:"image-upload",className:`btn btn-icon btn-icon-2xl btn-light absolute z-1 size-8 -top-0.5 -right-0.5 rounded-full ${u(2,"update")?"":"hidden"}`,children:u(2,"update")&&e.jsx(z,{className:"text-blue-600"})}),e.jsx("input",{id:"image-upload",type:"file",accept:"image/*",style:{display:"none"},onChange:y}),e.jsxs("div",{className:"flex flex-col items-center max-w-[300px] bnmobile:w-[95%]",children:[e.jsx("div",{className:"image-input-placeholder rounded-md border-2",children:e.jsx("img",{className:"h-[200px] w-[300px] rounded-sm",src:_||typeof r.image=="string"&&r.image||"",alt:"Promotion Banner"})}),e.jsx("p",{className:"text-red-500 text-sm min-h-[20px] block w-full text-center",children:t.image||" "})]})]})})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"title",children:"Title"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${u(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"title",autoComplete:"off",value:r.title,onChange:o=>a({...r,title:o.target.value}),readOnly:!u(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:t.title||" "})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"price",children:"Price (Rs)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${u(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"price",autoComplete:"off",value:r.price,onChange:o=>a({...r,price:o.target.value}),readOnly:!u(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:t.price||" "})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"promotion_code",children:"Promotion code"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${u(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"promotion_code",autoComplete:"off",value:r.promotion_code,onChange:o=>a({...r,promotion_code:o.target.value}),readOnly:!u(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:t.promotion_code||" "})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5 mt-3",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",children:"Offer Validity"}),e.jsx(G,{dateAdapter:V,children:e.jsx(Y,{value:r.offer_validity,onChange:C,disabled:!u(2,"update"),format:"DD-MM-YYYY",slotProps:{textField:{fullWidth:!0,InputProps:{style:{height:"35px",width:"155px",fontSize:"14px"}}}},disablePast:!0})})]})}),u(2,"update")&&e.jsx("div",{className:"flex relative justify-end pt-2.5",children:e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:b||f,children:b||f?e.jsxs(e.Fragment,{children:["Saving...",e.jsx(O,{})]}):e.jsx(e.Fragment,{children:"Save Changes"})})})]})})]})})})},ee=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container-fixed",children:e.jsx("div",{className:"flex flex-wrap items-center lg:items-end justify-between gap-5 pb-7.5",children:e.jsx("div",{className:"flex flex-col justify-center gap-2",children:e.jsx("h1",{className:"text-xl font-semibold leading-none text-gray-900",children:"Settings"})})})}),e.jsx("div",{className:"container-fixed",children:e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-5 lg:gap-7.5",children:[e.jsx(M,{}),e.jsx(W,{})]})})]});export{ee as default};
