import{r as p,B as R,_ as x,j as l}from"./index-JqtrFc43.js";import{u as F}from"./useGetBranches-BKCH5_XB.js";import{O as T,b as C}from"./enums-CdakGUf3.js";import{u as N}from"./useGetUsersByRole-DuzrX8gH.js";import{M as b}from"./MultiSelect-D02MRDs9.js";const G=(s=1,o=10,g="",d,y,O,u,m,h,V,S,f,j,B)=>{const[e,t]=p.useState([]),[a,i]=p.useState(0),[r,E]=p.useState(!1),w=async()=>{var _,$;const k=localStorage.getItem("authToken"),c=new URLSearchParams;s&&c.append("page_number",s.toString()),o&&c.append("per_page",o.toString()),g&&c.append("search",g),d&&c.append("sort_by",d),y&&c.append("order",y),m&&m.forEach(n=>c.append("order_statuses",n.toString())),h&&h.forEach(n=>c.append("customer_ids",n.toString())),V&&V.forEach(n=>c.append("branches_ids",n.toString())),S&&S.forEach(n=>c.append("pickup_boy_ids",n.toString())),f&&f.forEach(n=>c.append("delivery_boy_ids",n.toString())),O&&c.append("list",O),u&&c.append("orderList",u),E(!0);try{const n=await fetch(`${R}/admin/orders?${c}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${k}`}}),v=await n.json();if(!n.ok){x.error(v.message,{position:"top-center"});return}t(((_=v==null?void 0:v.data)==null?void 0:_.orders)||[]),i((($=v==null?void 0:v.data)==null?void 0:$.count)||0)}catch(n){x.error(n||"Network error: Failed to fetch.",{position:"top-center"})}finally{E(!1)}};return p.useEffect(()=>{w()},[s,o,g,d,y,m,h,V,S,f,j,B]),{orders:e,totalOrders:a,loading:r,fetchOrders:w}},I=()=>{const[s,o]=p.useState(!1);return{deleteOrder:async d=>{const y=localStorage.getItem("authToken"),O=`http://3.110.208.70:3000/admin/order/${d}`;o(!0);try{const u=await fetch(O,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`}}),m=await u.json();return u.ok?{success:!0,message:m.message}:(x.error(m.message,{position:"top-center"}),{success:!1,message:m.message})}catch(u){return x.error("An unexpected error occurred.",{position:"top-center"}),{success:!1,message:u.message}}finally{o(!1)}},loading:s}},z=({filters:s,updateFilters:o})=>{const[g,d]=p.useState([]),[y,O]=p.useState([]),[u,m]=p.useState([]),[h,V]=p.useState(""),{branches:S}=F(),{fetchUsersByRole:f}=N(),j=Object.entries(T).filter(([e,t])=>typeof t=="number").map(([e,t])=>({label:e,value:t})),B=Object.entries(C).filter(([e,t])=>typeof t=="number").map(([e,t])=>({label:e,value:t}));return p.useEffect(()=>{h&&(async()=>{const t=await f(5,h),a=t==null?void 0:t.map(i=>({label:`${i.first_name} ${i.last_name} (${i.mobile_number})`,value:i.user_id}));d(a)})()},[h]),p.useEffect(()=>{const e=async()=>{const a=await f(4),i=a==null?void 0:a.map(r=>({label:`${r.first_name} ${r.last_name} (${r.mobile_number})`,value:r.user_id}));O(i)},t=async()=>{const a=await f(4),i=a==null?void 0:a.map(r=>({label:`${r.first_name} ${r.last_name} (${r.mobile_number})`,value:r.user_id}));m(i)};e(),t()},[]),l.jsx(l.Fragment,{children:l.jsx("div",{className:"p-4",children:l.jsxs("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(250px,1fr))] gap-4",children:[l.jsx(b,{options:g,displayValue:"label",placeholder:"Search Customer",selectedValues:s.customerFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,customerFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,customerFilter:t})},setSearch:V,className:"w-full"}),l.jsx(b,{options:j,displayValue:"label",placeholder:"Select Order Status",selectedValues:s.orderStatusFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,orderStatusFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,orderStatusFilter:t})},isCustomLabel:!0,className:"w-full"}),l.jsx(b,{options:S==null?void 0:S.map(e=>({label:e.branch_name,value:e.branch_id})),displayValue:"branch_name",placeholder:"Select Branch",selectedValues:s==null?void 0:s.branchFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,branchFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,branchFilter:t})},className:"w-full"}),l.jsx(b,{options:u,displayValue:"label",placeholder:"Search DeliveryBoy",selectedValues:s.deliveryBoyFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,deliveryBoyFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,deliveryBoyFilter:t})},className:"w-full"}),l.jsx(b,{options:y,displayValue:"label",placeholder:"Search PickupBoy",selectedValues:s.pickupBoyFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,pickupBoyFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,pickupBoyFilter:t})},className:"w-full"}),l.jsx(b,{options:B,displayValue:"label",placeholder:"Select Payment Status",selectedValues:s.paymentStatusFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,paymentStatusFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,paymentStatusFilter:t})},isSearchInput:!1,className:"w-full"}),l.jsxs("select",{className:"select select-lg w-[200px] text-sm",value:s.paymentTypeFilter,onChange:e=>{o({...s,paymentTypeFilter:Number(e.target.value)})},children:[l.jsx("option",{value:"",selected:!0,children:"Payment type"}),l.jsx("option",{value:1,children:"Cash on Delivery"}),l.jsx("option",{value:2,children:"Online Payment"})]})]})})})};export{z as O,I as a,G as u};
