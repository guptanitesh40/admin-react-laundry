import{r as u,B as M,V as P,G as ee,j as e,X as te,N as se,t as ae,F as ne,f as le,b as re,q as ie,i as de,H as ce,e as oe,L as me,R as q,a0 as ue,h as xe}from"./index-C4ewyZzy.js";import{u as G}from"./useGetuser-DLwybj2T.js";import{g as W}from"./roleClasses-CttKITvI.js";import{g as Q}from"./paymentStatusClasses-BddHAg9R.js";import{g as he}from"./orderStatusClasses-HfHBGnti.js";import{u as pe}from"./useRestoreUser-DIK13Jfp.js";import{S}from"./sweetalert2.esm.all-B0Dix5B2.js";import{u as fe,P as ge,a as je,d as X}from"./index-D2NuXxup.js";const be=()=>{const[x,i]=u.useState(!1);return{clearDueAmount:async(g,N)=>{const d=localStorage.getItem("authToken");i(!0);try{const a=await fetch(`${M}/orders/payments/clear-due`,{method:"POST",headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"},body:JSON.stringify({user_id:g,orders:N})}),j=await a.json();return a.ok?(P.success(j.message,{position:"top-center"}),!0):(P.error(j.message,{position:"top-center"}),!1)}catch{return P.error("Error clearing due amount",{position:"top-center"}),!1}finally{i(!1)}},loading:x}};function Z(x){return ee({attr:{viewBox:"0 0 32 32"},child:[{tag:"path",attr:{d:"M 8 5 L 8 7 L 12 7 C 13.703125 7 15.941406 8.039063 16.71875 10 L 8 10 L 8 12 L 16.96875 12 C 16.660156 14.609375 13.972656 16 12 16 L 8 16 L 8 18.46875 L 18.25 27 L 21.375 27 L 10.5625 18 L 12 18 C 15.234375 18 18.675781 15.609375 18.96875 12 L 24 12 L 24 10 L 18.8125 10 C 18.507813 8.816406 17.859375 7.804688 17 7 L 24 7 L 24 5 Z"},child:[]}]})(x)}const ye=({modalOpen:x,onClose:i,userId:y,setRefetch:g,count:N})=>{const{userData:d,fetchUser:a,loading:j}=G(),{clearDueAmount:O,loading:m}=be(),[k,p]=u.useState([]),[A,s]=u.useState([]),[o,v]=u.useState(),b=1,F=d==null?void 0:d.total_pending_amount,_=d==null?void 0:d.user;u.useEffect(()=>{x&&a(y,b,N)},[x,y]),u.useEffect(()=>{if(_!=null&&_.orders){const r=_.orders.filter(t=>![2].includes(t.payment_status)&&![12,13].includes(t.order_status));r.map(t=>({...t,kasar_amount:t.kasar_amount||null,payment_status:t.payment_status||null,current_total:0})),p(r)}},[_]);const T=(r,t,n)=>{const c=k.map(l=>{if(l.order_id===r){const f={...l,[t]:n};if(t==="kasar_amount"){const C=l.total||0,R=l.paid_amount||0,I=n||0,E=C-R-I;f.current_paid=E>0?E:0}return f.current_total=(f.current_paid||0)+(f.kasar_amount||0),f.current_total===0?f.payment_status=1:f.current_total===l.total||f.current_total===l.total-l.paid_amount?(v(!0),f.payment_status=2):(v(!1),f.payment_status=3),f}return l});p(c);const w=c.find(l=>l.order_id===r);w&&s(l=>{const f=l.findIndex(C=>C.order_id===r);if(f>-1){const C=[...l];return C[f]=w,C}return[...l,w]})},U=async()=>{if(A.length===0){i();return}const r={filteredOrders:A.map(({order_id:n,payment_status:c,kasar_amount:w,current_paid:l})=>({order_id:n,paid_amount:l||0,payment_status:c,kasar_amount:w}))};await O(y,r.filteredOrders)&&(i(),s([])),g(!0)};return x?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:i}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-[1000px] z-10 relative max-h-[80vh] overflow-auto",children:[e.jsx("button",{className:"absolute top-0 right-0 mt-5 mr-5 btn btn-sm btn-icon btn-light btn-outline lg:mr-5 shadow-default","data-modal-dismiss":"true",onClick:i,children:e.jsx("i",{className:"ki-filled ki-cross"})}),e.jsxs("div",{className:"flex items-center justify-between mb-6 lgscreen:flex-col lgscreen:gap-2 lgscreen:items-start",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Orders"}),e.jsxs("div",{className:"flex items-start gap-2 lgscreen:w-full lgscreen:justify-between lgscreen:!items-center",children:[e.jsxs("span",{className:"text-sm font-medium text-red-700",children:["Total Pending Amount: ₹",F]}),e.jsx("button",{className:"flex mt-10 btn btn-primary btn-lg flex-end lgscreen:mt-0",onClick:U,disabled:m,children:m?"Saving...":"Save"})]})]}),e.jsx("div",{className:"grid gap-5 lg:gap-5.5",children:e.jsx("div",{className:"min-w-full card card-grid",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"scrollable-x-auto",children:e.jsxs("table",{className:"table table-auto table-border",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"min-w-[30px]",children:"Id"}),e.jsx("th",{className:"min-w-[120px]",children:"Total"}),e.jsx("th",{className:"min-w-[120px]",children:"Paid Amount"}),e.jsx("th",{className:"min-w-[120px]",children:"Kasar Amount"}),e.jsx("th",{className:"min-w-[120px]",children:"Current Paid"}),e.jsx("th",{className:"min-w-[190px]",children:"Current Total"}),e.jsx("th",{className:"min-w-[120px]",children:"Payment Status"})]})}),j?e.jsx("tbody",{children:Array.from({length:4}).map((r,t)=>e.jsx("tr",{children:Array.from({length:7}).map((n,c)=>e.jsx("td",{className:"!px-3 !py-3",children:e.jsx("span",{className:"inline-block w-full text-xl bg-gray-200 rounded-md animate-pulse",children:" "})},c))},t))}):e.jsx("tbody",{children:k.map(r=>{const t=(r.paid_amount||0)+(r.kasar_amount||0)+(r.current_paid||0),n=Q(r.payment_status,!0);return e.jsxs("tr",{className:"custom-row",children:[e.jsxs("td",{children:["#",r.order_id]}),e.jsxs("td",{children:["₹",r.total||0]}),e.jsxs("td",{children:["₹",r.paid_amount||0]}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input input-bordered",value:r.kasar_amount||0,onChange:c=>T(r.order_id,"kasar_amount",Number(c.target.value))})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input input-bordered",value:r.current_paid||0,onChange:c=>T(r.order_id,"current_paid",Number(c.target.value))})}),e.jsxs("td",{className:t>(r.total||0)?"text-red-500":"",children:[e.jsxs("span",{children:["₹",r.current_total||0]}),t>(r.total||0)?e.jsx("span",{className:"flex mt-1 font-serif",children:"greater then pending amount"}):""]}),e.jsx("td",{children:e.jsxs("div",{children:[e.jsxs("select",{className:`select select-lg w-[170px] text-sm ${n}`,"data-datatable-size":"true","data-tooltip":"#custom_tooltip",value:r.payment_status,onChange:c=>T(r.order_id,"payment_status",Number(c.target.value)),children:[e.jsx("option",{value:"1",className:`${n}`,disabled:o||!o,children:"Pending"}),e.jsx("option",{value:"2",disabled:!o||r.paid_amount===0,children:"Received"}),e.jsx("option",{value:"3",disabled:o,children:"Partial Received"})]}),e.jsx("div",{className:"hidden p-3 text-xs font-normal text-gray-700 border border-gray-200 rounded-xl shadow-default bg-light",id:"custom_tooltip",children:"Change Payment Status"})]})})]},r.order_id)})})]})})})})})]})]}):null},Ne=({user:x,userId:i,count:y})=>{const[g,N]=u.useState(1),[d,a]=u.useState(100),{fetchUser:j,loading:O}=G(),[m,k]=u.useState([]);u.useEffect(()=>{k(x==null?void 0:x.orders)},[x]),u.useEffect(()=>{(async()=>{const o=await j(i,g,d);o&&k(v=>{const b=new Set(v.map(_=>_.order_id)),F=o==null?void 0:o.filter(_=>!b.has(_.order_id));return[...v,...F]})})()},[g]);const p=s=>{window.open(`/order/${s}`,"_blank")},A=()=>{N(g+1)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid gap-5 lg:gap-7.5 mt-5",children:e.jsxs("div",{className:"card card-grid min-w-full",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"text-xl font-semibold mb-1",children:"Orders"}),e.jsxs("span",{className:"text-gray-700 text-lg font-semibold px-3 py-1 rounded-lg",children:["Total Orders: ",y]})]}),e.jsx("div",{className:"scrollable-x-auto",children:e.jsxs("table",{className:"table table-auto table-border",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Id"}),e.jsx("th",{className:"min-w-[220px]",children:"Status"}),e.jsx("th",{className:"min-w-[60px]",children:"Item Count"}),e.jsx("th",{children:"Total"}),e.jsx("th",{className:"min-w-[80px]",children:"Paid Amount"}),e.jsx("th",{className:"",children:"Kasar Amount"}),e.jsx("th",{className:"min-w-[140px]",children:"Payment Type"}),e.jsx("th",{className:"min-w-[135px]",children:"Payment Status"}),e.jsx("th",{className:"min-w-[130px]",children:"Actions"})]})}),(m==null?void 0:m.length)>0?e.jsx("tbody",{children:m==null?void 0:m.map(s=>{const o=Q(s.payment_status),v=he(s.admin_order_status.admin_label),b=s.items.length;return e.jsxs("tr",{children:[e.jsxs("td",{children:["#",s.order_id]}),e.jsx("td",{children:e.jsx("span",{className:`${v} badge-outline badge-xl rounded-[30px]`,children:s.admin_order_status.admin_label})}),e.jsx("td",{children:b}),e.jsxs("td",{children:["₹",s.total]}),e.jsxs("td",{children:["₹",s.paid_amount===""?0:s.paid_amount]}),e.jsxs("td",{children:["₹",s.kasar_amount===""?0:s.kasar_amount]}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-outline",children:te[s.payment_type]})}),e.jsx("td",{children:e.jsx("span",{className:`${o} badge-outline`,children:se[s.payment_status]})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>p(s.order_id),children:"View Order"})})]},s.order_id)})}):e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"text-center",children:"No Orders available"})})})]})})]})}),(m==null?void 0:m.length)<y&&e.jsx("div",{className:"mt-2 flex justify-center items-center",children:e.jsx("button",{className:"btn btn-primary custom-rounded",onClick:A,disabled:O,children:O?e.jsxs(e.Fragment,{children:["Loading ",e.jsx(ae,{})]}):e.jsx(e.Fragment,{children:"Load More"})})})]})},_e=({addresses:x,onAdd:i,onEdit:y,onDelete:g})=>e.jsxs("div",{className:"card mt-5",children:[e.jsxs("div",{className:"card-header flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Addresses"}),e.jsx("button",{className:"btn btn-primary",onClick:i,children:"+ Add Address"})]}),e.jsx("div",{className:"scrollable-x-auto",children:e.jsxs("table",{className:"table table-auto table-border min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"min-w-[75px]",children:"id"}),e.jsx("th",{className:"min-w-[150px]",children:"Name"}),e.jsx("th",{className:"min-w-[150px]",children:"Phone"}),e.jsx("th",{className:"min-w-[200px]",children:"Address"}),e.jsx("th",{className:"min-w-[100px]",children:"City"}),e.jsx("th",{className:"min-w-[100px]",children:"Pincode"}),e.jsx("th",{className:"min-w-[80px]",children:"State"}),e.jsx("th",{className:"min-w-[125px] text-center",children:"Actions"})]})}),x.length>0?e.jsx("tbody",{children:x.map(N=>{const{address_id:d,full_name:a,phone_number:j,full_address:O,building_number:m,area:k,landmark:p,city:A,pincode:s,state:o}=N,v=[m,k,p].filter(Boolean).join(", ");return e.jsxs("tr",{children:[e.jsx("td",{children:d}),e.jsx("td",{children:a}),e.jsx("td",{children:j}),e.jsx("td",{children:v}),e.jsx("td",{children:A}),e.jsx("td",{children:s}),e.jsx("td",{children:o}),e.jsxs("td",{className:"text-center",children:[e.jsx("button",{className:"mr-3 p-3 rounded-full bg-yellow-100 hover:bg-yellow-200",onClick:()=>y(d),children:e.jsx(ne,{className:"text-yellow-600 h-4 w-4"})}),e.jsx("button",{className:"p-3 bg-red-100 hover:bg-red-200  rounded-full",onClick:()=>g(d),children:e.jsx(le,{className:"text-red-500 h-4 w-4"})})]})]},d)})}):e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"text-center",children:"No addresses found."})})})]})})]}),we=()=>{const[x,i]=u.useState(!1);return{updateAddress:async(g,N)=>{const d=localStorage.getItem("authToken");if(!d){P.error("User not authenticated");return}i(!0);try{const a=await fetch(`${M}/address/admin/${g}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify(N)}),j=await a.json();if(!a.ok)throw new Error(j.message||"Failed to update address");return P.success("Address updated successfully"),j}catch(a){P.error(a.message||"Failed to update address")}finally{i(!1)}},loading:x}},ve=({isOpen:x,onClose:i,userId:y,setIsSubmit:g,onAddressAdded:N,fullname:d,address:a})=>{const j=!!a,{addAddress:O,loading:m}=fe(),{updateAddress:k}=we(),[p,A]=u.useState({}),[s,o]=u.useState({building_number:"",area:"",lat:null,long:null,landmark:"",pincode:"",city:"",state:"",country:"",user_id:null,address_type:null,full_name:""}),[v,b]=u.useState({building_number:"",area:"",lat:null,long:null,landmark:"",pincode:"",city:"",state:"",country:"",user_id:null,address_type:null,full_name:""}),[F,_]=u.useState(!1);u.useEffect(()=>{var t;if(x){if(y&&o(n=>({...n,user_id:y,full_name:d})),j&&a){const n={building_number:(a==null?void 0:a.building_number)||"",area:a.area||"",landmark:a.landmark||"",pincode:((t=a.pincode)==null?void 0:t.toString())||"",city:a.city||"",state:a.state||"",country:a.country||"",lat:a.lat||"",long:a.long||"",user_id:a.user_id,address_type:a.address_type,full_name:a.full_name||""};o(n),b(n)}}else o({building_number:"",area:"",landmark:"",pincode:"",city:"",lat:null,long:null,state:"",country:"",user_id:null,address_type:null,full_name:""}),A({})},[x,y]);const T=t=>{o({...s,area:t}),_(!0)},U=async t=>{try{const n=await X.geocodeByAddress(t),c=await X.getLatLng(n[0]),w=n[0].address_components,l=E=>{const $=w.find(D=>E.some(z=>D.types.includes(z)));return($==null?void 0:$.long_name)||""},f=l(["locality"])||l(["administrative_area_level_2"])||l(["postal_town"]),C=l(["administrative_area_level_1"]),R=l(["country"]),I=l(["postal_code"]);o(E=>({...E,area:n[0].formatted_address,lat:c.lat,long:c.lng,city:f,state:C,country:R,pincode:I}))}catch{P.error("Failed to fetch full address details",{className:"toast-error"})}},r=async t=>{if(t.preventDefault(),j&&JSON.stringify(s)===JSON.stringify(v)){i();return}const n={...s};n.pincode||delete n.pincode,n.landmark||delete n.landmark,n.lat&&n.long&&(n.lat=Number(n.lat),n.long=Number(n.long));try{if(await je.validate(s,{abortEarly:!1}),A({}),!n.lat&&!n.long){P.error("Please search your address and  select it from dropdown");return}if(y)if(j&&(a!=null&&a.address_id)){const c=await k(a.address_id,n);c.statusCode===200&&(N(c),i(),g(!0))}else{const c=await O(n);c&&(N(c),i(),g(!0))}}catch(c){if(c instanceof re){const w={};c.inner.forEach(l=>{w[l.path||""]=l.message}),A(w)}else P.error("Failed to submit the form. Please try again.")}};if(x)return e.jsxs("div",{className:"fixed inset-0 z-50 grid items-center justify-center p-4 overflow-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:i}),e.jsxs("div",{className:"bg-white p-5 rounded-lg shadow-lg min-w-[450px] !max-w-full z-10 relative",children:[e.jsx("button",{className:"absolute top-0 right-0 mt-5 mr-5 btn btn-sm btn-icon btn-light btn-outline lg:mr-5 shadow-default",onClick:i,children:e.jsx("i",{className:"ki-filled ki-cross"})}),e.jsx("h2",{className:"mb-6 text-2xl font-bold",children:j?"Edit Address":"Add New Address"}),e.jsxs("form",{onSubmit:r,children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"country",className:"block font-semibold text-gray-700",children:"Address Type"}),e.jsxs("select",{className:"text-sm select select-lg",value:(s==null?void 0:s.address_type)??"",onChange:t=>o({...s,address_type:Number(t.target.value)}),children:[e.jsx("option",{value:null,className:"badge-danger badge-outline",children:"Select Address Type"}),e.jsx("option",{value:"1",children:"Home"}),e.jsx("option",{value:"2",children:"Office"}),e.jsx("option",{value:"3",children:"Other"})]}),e.jsx("p",{className:"w-full text-sm text-red-500",children:p.address_type||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"area",className:"block font-semibold text-gray-700",children:"Search Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"relative",children:e.jsx(ge,{value:s.area,onChange:T,onSelect:U,children:({getInputProps:t,suggestions:n,getSuggestionItemProps:c,loading:w})=>e.jsxs(e.Fragment,{children:[e.jsx("input",{...t({className:"w-full input border border-gray-300 rounded-md p-2",id:"area",type:"text",onFocus:()=>_(!0),onBlur:()=>_(!1)})}),F&&n.length>0&&e.jsx("div",{className:"absolute bg-white border z-10 border-gray-200 rounded-lg w-full text-sm max-h-[150px] overflow-y-auto",children:e.jsxs("ul",{className:"custom-ul",children:[w&&e.jsx("li",{className:"block px-4 py-[0.8rem] hover:bg-gray-100 w-full",children:"Loading..."}),!w&&n.map((l,f)=>{const{...C}=c(l);return e.jsx("li",{...C,className:"block px-2 py-[0.8rem] hover:bg-gray-100 w-full cursor-pointer font-style",children:l==null?void 0:l.description},f)})]})})]})})}),p.area&&e.jsx("p",{className:"w-full text-sm text-red-500",children:p.area||" "})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"building_number",className:"block font-semibold text-gray-700",children:"House Number and Society"}),e.jsx("input",{type:"text",id:"building_number",name:"building_number",autoComplete:"off",value:s.building_number,onChange:t=>o({...s,building_number:t.target.value}),className:"w-full p-2 border border-gray-300 rounded-md input"}),e.jsx("p",{className:"w-full text-sm text-red-500",children:p.building_number||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"landmark",className:"block font-semibold text-gray-700",children:"Landmark"}),e.jsx("input",{type:"text",id:"landmark",name:"landmark",autoComplete:"off",value:s.landmark,onChange:t=>o({...s,landmark:t.target.value}),className:"w-full p-2 border border-gray-300 rounded-md input"}),e.jsx("p",{className:"w-full text-sm text-red-500",children:p.landmark||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city",className:"block font-semibold text-gray-700",children:"City"}),e.jsx("input",{type:"text",id:"city",name:"city",autoComplete:"off",value:s.city,onChange:t=>o({...s,city:t.target.value}),className:"w-full p-2 border border-gray-300 rounded-md input"}),e.jsx("p",{className:"w-full text-sm text-red-500",children:p.city||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pincode",className:"block font-semibold text-gray-700",children:"Pin code"}),e.jsx("input",{type:"text",id:"pincode",name:"pincode",autoComplete:"off",value:s.pincode,onChange:t=>o({...s,pincode:t.target.value}),className:"w-full p-2 border border-gray-300 rounded-md input"}),e.jsx("p",{className:"w-full text-sm text-red-500",children:p.pincode||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"state",className:"block font-semibold text-gray-700",children:"State"}),e.jsx("input",{type:"text",id:"state",name:"state",autoComplete:"off",value:s.state,onChange:t=>o({...s,state:t.target.value}),className:"w-full p-2 border border-gray-300 rounded-md input"}),e.jsx("p",{className:"w-full text-sm text-red-500",children:p.state||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"country",className:"block font-semibold text-gray-700",children:"Country"}),e.jsx("input",{type:"text",id:"country",name:"country",autoComplete:"off",value:s.country,onChange:t=>o({...s,country:t.target.value}),className:"w-full p-2 border border-gray-300 rounded-md input"}),e.jsx("p",{className:"w-full text-sm text-red-500",children:p.country||" "})]})]}),e.jsxs("div",{className:"flex justify-end mt-6",children:[e.jsx("button",{type:"button",onClick:i,className:"mr-2 btn btn-light",disabled:m,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m,className:`btn btn-primary ${m?"opacity-50 cursor-not-allowed":""}`,children:j?m?"updating...":"update":m?"submitting...":"submit"})]})]})]})]})},ke=()=>{const[x,i]=u.useState(!1);return{deleteAddress:async g=>{const N=localStorage.getItem("authToken");if(!N){P.error("User not authenticated");return}i(!0);try{const d=await fetch(`${M}/address/admin/${g}`,{method:"DELETE",headers:{Authorization:`Bearer ${N}`}}),a=await d.json();if(!d.ok)throw new Error(a.message||"Failed to delete address");return{success:!0,message:a.message}}catch(d){return{success:!1,message:d.message}}finally{i(!1)}},loading:x}},Te=()=>{var D,z,K,V,Y,J;const{id:x}=ie(),i=Number(x),y=de(),g=ce(),[N,d]=u.useState(),[a,j]=u.useState(!1),[O,m]=u.useState(!1),[k,p]=u.useState(!1),[A,s]=u.useState(null),[o,v]=u.useState(!1),{userData:b,fetchUser:F,count:_,loading:T}=G(),{restoreUser:U}=pe(),{deleteAddress:r}=ke(),t=b==null?void 0:b.user,{hasPermission:n}=oe();if(u.useEffect(()=>{F(i),m(!1)},[i,O]),u.useEffect(()=>{j(g.pathname.split("/")[1]==="customer")},[g.pathname]),!t)return;const c=(D=t==null?void 0:t.orders)==null?void 0:D.reduce((h,L)=>h+L.kasar_amount,0),w=(z=t==null?void 0:t.orders)==null?void 0:z.reduce((h,L)=>h+L.total,0),l=()=>{d(!0)},f=h=>{y(a?`/customer/edit/${h}`:`/user/edit/${h}`)},C=async h=>{try{if((await S.fire({title:"Are you sure?",text:a?"You want to restore this customer?":"You want to restore this user?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#28a745",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, restore it!",cancelButtonText:"No, cancel"})).isConfirmed){S.fire({title:a?"Restoring customer...":"Restoring user...",allowOutsideClick:!1,allowEscapeKey:!1,didOpen:()=>{S.showLoading()}});const{success:B,message:H}=await U(h);m(!0),B?S.fire("Restored!",H,"success"):S.fire("Failed",H,"error")}}catch(L){S.fire({title:"Error",text:L.message,icon:"error"})}},R=async h=>{if((await S.fire({title:"Are you sure?",text:"You want to delete this address!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"})).isConfirmed){S.fire({title:"Deleting...",didOpen:()=>{S.showLoading()},allowOutsideClick:!1,showConfirmButton:!1});const B=await r(h);S.close(),B.success?(S.fire({title:"Deleted!",text:B.message,icon:"success",timer:1500,showConfirmButton:!1}),m(!0)):S.fire({title:"Error!",text:B.message,icon:"error",confirmButtonColor:"#d33"})}},I=h=>{const L=t==null?void 0:t.address.find(B=>B.address_id===h);L?(s(L),p(!0)):P.error(`Address with id ${h} not found`)},E=h=>{h&&m(!0)};if(T)return e.jsx(me,{});const $=!!(t!=null&&t.deleted_at);return e.jsxs("div",{className:"container p-6 mx-auto",children:[e.jsx("div",{className:"flex flex-col p-5 rounded-md shadow-md bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("h1",{className:"text-xl font-semibold text-gray-900",children:[t==null?void 0:t.first_name," ",t==null?void 0:t.last_name]}),(b==null?void 0:b.total_pending_amount)!==0&&e.jsxs("div",{className:"flex items-center gap-2 flex-end",children:[e.jsxs("span",{className:"text-sm font-medium text-red-700",children:["Total Pending Amount: ₹",b==null?void 0:b.total_pending_amount]}),e.jsxs("button",{className:"font-extralight btn btn-lg btn-light",onClick:l,children:["Pay ",e.jsx(Z,{size:20})]})]}),$?e.jsxs("button",{className:"btn btn-sm btn-danger",onClick:()=>C(t==null?void 0:t.user_id),children:["Restore ",a?"Customer":"User"]}):t.role_id!==5&&e.jsx("span",{className:`mt-1 p-2 rounded-md text-sm ${W(t.role_id)}`,children:q[t.role_id]})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-5 lg:gap-7.5 mt-5 items-stretch",children:[e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"card pb-2.5",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:"Personal Information"}),!$&&n(8,"update")&&e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{className:"absolute items-center justify-center hidden mb-1 transform -translate-x-1/2 tooltip bottom-full left-1/2 group-hover:flex whitespace-nowrap",id:"tooltip_hover",children:["Edit ",a?"Customer":"User"]}),e.jsx("button",{className:"btn btn-light flex justify-center items-center rounded-full p-0 !h-8 !w-8","data-tooltip":"#tooltip_hover","data-tooltip-trigger":"hover",onClick:()=>f(t==null?void 0:t.user_id),children:e.jsx(ue,{className:"w-5 h-5 text-gray-600 transition-colors duration-300 group-hover:text-gray-800"})})]})]}),e.jsx("div",{className:"pt-4 pb-3 card-body",children:e.jsx("table",{className:"table-auto",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"pb-5 text-sm font-medium text-gray-500 min-w-36 pe-6",children:"Name:"}),e.jsxs("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:[t==null?void 0:t.first_name," ",t==null?void 0:t.last_name]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"pb-5 text-sm font-medium text-gray-500 min-w-36 pe-6",children:"Email:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:t==null?void 0:t.email})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"pb-5 text-sm font-medium text-gray-500 min-w-36 pe-6",children:"Mobile Number:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:t==null?void 0:t.mobile_number})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"pb-5 text-sm font-medium text-gray-500 min-w-36 pe-6",children:"Gender:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:xe[t==null?void 0:t.gender]})]}),(t==null?void 0:t.image)!==""&&e.jsxs("tr",{children:[e.jsx("td",{className:"pb-5 text-sm font-medium text-gray-500 min-w-36 pe-6",children:"Profile Photo :"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:e.jsx("span",{children:e.jsx("img",{className:"rounded-full h-14 w-14",src:t==null?void 0:t.image})})})]}),(t==null?void 0:t.role_id)!==5&&e.jsxs("tr",{children:[e.jsx("td",{className:"pb-5 text-sm font-medium text-gray-500 min-w-36 pe-6",children:"Role:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:e.jsx("span",{className:`p-2 rounded-md text-sm ${W(t==null?void 0:t.role_id)}`,children:q[t==null?void 0:t.role_id]})})]}),((K=t==null?void 0:t.companies)==null?void 0:K.length)>0&&e.jsxs("tr",{children:[e.jsx("td",{className:"pb-5 text-sm font-medium text-gray-500 min-w-36 pe-6",children:"Company:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:Array.isArray(t==null?void 0:t.companies)&&t.companies.length>0?t.companies.map(h=>h).join(","):""})]}),((V=t==null?void 0:t.branches)==null?void 0:V.length)>0&&e.jsxs("tr",{children:[e.jsx("td",{className:"pb-5 text-sm font-medium text-gray-500 min-w-36 pe-6",children:"Branch:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:Array.isArray(t.branches)&&t.branches.length>0?t.branches.map(h=>h).join(", "):""})]}),((Y=t==null?void 0:t.workshops)==null?void 0:Y.length)>0&&e.jsxs("tr",{children:[e.jsx("td",{className:"pb-5 text-sm font-medium text-gray-500 min-w-36 pe-6",children:"Workshop:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:Array.isArray(t.workshops)&&t.workshops.length>0?t.workshops.map(h=>h).join(", "):""})]})]})})})]})}),((J=t==null?void 0:t.orders)==null?void 0:J.length)>0&&e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"flex h-full col-span-2 lg:col-span-1",children:e.jsxs("div",{className:"card grow",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Orders Summary"})}),e.jsx("div",{className:"pt-4 pb-3 card-body",children:e.jsx("div",{className:"scrollable-x-auto",children:e.jsx("table",{className:"table-auto",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"pb-5 text-sm font-medium text-gray-500 min-w-36 pe-6",children:"Total Kasar Amount:"}),e.jsxs("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:["₹",c]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"pb-5 text-sm font-medium text-gray-500 min-w-36 pe-6",children:"Total Order Amount:"}),e.jsxs("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:["₹",w]})]}),b.total_pending_amount>0&&e.jsxs("tr",{children:[e.jsx("td",{className:"pb-5 text-sm font-medium text-gray-500 min-w-36 pe-6",children:"Total Pending Amount:"}),e.jsxs("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:["₹",b.total_pending_amount]}),e.jsx("td",{children:e.jsx("span",{className:"relative bottom-2 left-4",children:e.jsxs("button",{className:"flex items-center gap-2.5 font-extralight btn btn-light ",onClick:l,children:["Pay ",e.jsx(Z,{size:20})]})})})]})]})})})})]})})})]}),(t==null?void 0:t.role_id)===5&&t&&e.jsxs(e.Fragment,{children:[e.jsx(_e,{addresses:t==null?void 0:t.address,onAdd:()=>{p(!0),s(null)},onEdit:h=>I(h),onDelete:h=>{R(h)}}),e.jsx(Ne,{user:t,userId:i,count:_})]}),e.jsx(ye,{modalOpen:N,onClose:()=>d(!1),userId:i,setRefetch:m,count:_}),k&&e.jsx(ve,{isOpen:k,onAddressAdded:E,setIsSubmit:v,onClose:()=>p(!1),userId:t==null?void 0:t.user_id,fullname:`${t==null?void 0:t.first_name} ${t==null?void 0:t.last_name}`,address:A})]})};export{Te as default};
