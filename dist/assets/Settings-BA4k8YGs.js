import{r as c,B as U,V as E,a as $,d as x,a3 as P,e as R,j as e,t as O,b as q,l as I,p as H,a4 as z,k as D,F as T}from"./index-D24ck8V_.js";import{au as G,av as V}from"./AdapterDayjs-A9hLZGL_.js";import{D as Y}from"./DatePicker-sG0LyMSC.js";const B=()=>{const[s,h]=c.useState(),[p,S]=c.useState();return{settingsData:p,fetchSetting:async()=>{const m=localStorage.getItem("authToken");h(!0);try{const f=await fetch(`${U}/admin/settings`,{method:"GET",headers:{Authorization:m?`Bearer ${m}`:""}}),_=await f.json();if(!f.ok){E.error(_.message,{position:"top-center"}),h(!1);return}S(_)}catch(f){E.error(f||"Network Error: Fail to fetch data")}finally{h(!1)}},loading:s}},J=$().shape({estimate_pickup_normal_hour:x().notRequired().test("is-numeric","Estimate pickup normal hour must be a positive number",s=>s?/^\d+$/.test(s):!0),estimate_pickup_express_hour:x().notRequired().test("is-numeric","Estimate pickup express hour must be a positive number",s=>s?/^\d+$/.test(s):!0),estimate_delivery_normal_day:x().notRequired().test("is-numeric","Estimate delivery normal day must be a positive number",s=>s?/^\d+$/.test(s):!0),estimate_delivery_express_day:x().notRequired().test("is-numeric","Estimate delivery express day must be a positive number",s=>s?/^\d+$/.test(s):!0),normal_delivery_charges:x().notRequired().test("is-numeric","Normal delivery charge must be a positive number",s=>s?/^\d+$/.test(s):!0),express_delivery_charge:x().notRequired().test("is-numeric","Express delivery charge must be a positive number",s=>s?/^\d+$/.test(s):!0),express_delivery_24hrs:x().notRequired().test("is-numeric","Express delivery charge must be a positive number",s=>s?/^\d+$/.test(s):!0),express_delivery_48hrs:x().notRequired().test("is-numeric","Express delivery charge must be a positive number",s=>s?/^\d+$/.test(s):!0),express_delivery_72hrs:x().notRequired().test("is-numeric","Express delivery charge must be a positive number",s=>s?/^\d+$/.test(s):!0)}),M=({})=>{const{settingsData:s,fetchSetting:h,loading:p}=B(),{addSetting:S,loading:b}=P(),[m,f]=c.useState({}),[_,k]=c.useState(!1),{hasPermission:t}=R(),i=s==null?void 0:s.data,[n,j]=c.useState({estimate_delivery_express_day:"",estimate_delivery_normal_day:"",estimate_pickup_express_hour:"",estimate_pickup_normal_hour:"",normal_delivery_charges:"",express_delivery_charge:"",express_delivery_24hrs:"",express_delivery_48hrs:"",express_delivery_72hrs:""});c.useEffect(()=>{h(),k(!1)},[_]),c.useEffect(()=>{i&&j({estimate_delivery_express_day:i.estimate_delivery_express_day||"",estimate_delivery_normal_day:i.estimate_delivery_normal_day||"",estimate_pickup_express_hour:i.estimate_pickup_express_hour||"",estimate_pickup_normal_hour:i.estimate_pickup_normal_hour||"",normal_delivery_charges:i.normal_delivery_charges||"",express_delivery_charge:i.express_delivery_charge||"",express_delivery_24hrs:i.express_delivery_24hrs||"",express_delivery_48hrs:i.express_delivery_48hrs||"",express_delivery_72hrs:i.express_delivery_72hrs||""})},[i]);const u=async r=>{r.preventDefault();try{if(await J.validate(n,{abortEarly:!1}),!Object.keys(n).some(y=>n[y]!==i[y]))return;const N=Object.keys(n).map(y=>({setting_key:y,setting_value:n[y]}));await S(N)&&(f({}),k(!0))}catch(g){if(g instanceof q){const N={};g.inner.forEach(C=>{N[C.path||""]=C.message}),f(N)}else E.error("Failed to submit the form. Please try again.")}},a=(r,g)=>{j({...n,[r]:g})};return p?e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"card pb-2.5 min-w-full !border-gray-200",children:[e.jsx("div",{className:"card-header",children:e.jsx("span",{className:"inline-block h-[31px] min-w-32 bg-gray-200 rounded-md animate-pulse"})}),e.jsx("div",{children:e.jsxs("div",{className:"card-body grid gap-1",children:[Array.from({length:7}).map((r,g)=>e.jsx("div",{className:"w-full py-3",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("span",{className:"grow inline-block w-56 h-9 bg-gray-200 animate-pulse rounded-md"}),e.jsx("span",{className:"grow inline-block w-56 h-9 bg-gray-200 animate-pulse rounded-md"})]})},g)),e.jsx("div",{className:"flex relative justify-end pt-2.5",children:e.jsx("span",{className:"inline-block w-32 h-12 bg-gray-200 animate-pulse rounded-md"})})]})})]})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"card pb-2.5 min-w-full",children:[e.jsx("div",{className:"card-header",id:"basic_settings",children:e.jsx("h3",{className:"card-title",children:"General Settings"})}),e.jsx("form",{onSubmit:u,children:e.jsxs("div",{className:"card-body grid gap-1",children:[e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"estimate_pickup_normal_hour",children:"Estimate Pickup Normal Hour (In Hour)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${t(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"estimate_pickup_normal_hour",autoComplete:"off",value:n.estimate_pickup_normal_hour||"",onChange:r=>a("estimate_pickup_normal_hour",r.target.value),readOnly:!t(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:m.estimate_pickup_normal_hour||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"estimate_pickup_express_hour",children:"Estimate Pickup Express Hour (In Hour)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${t(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"estimate_pickup_express_hour",autoComplete:"off",value:n.estimate_pickup_express_hour||"",onChange:r=>a("estimate_pickup_express_hour",r.target.value),readOnly:!t(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:m.estimate_pickup_express_hour||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"estimate_delivery_normal_day",children:"Estimate Delivery Normal Day (Day)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${t(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"estimate_delivery_normal_day",autoComplete:"off",value:n.estimate_delivery_normal_day,onChange:r=>a("estimate_delivery_normal_day",r.target.value),readOnly:!t(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:m.estimate_delivery_normal_day||" "})]})]})}),e.jsx("div",{className:"w-full",style:{display:"none"},children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"estimate_delivery_express_day",children:"Estimate Delivery Express Day (Day)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${t(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"estimate_delivery_express_day",autoComplete:"off",value:n.estimate_delivery_express_day,onChange:r=>a("estimate_delivery_express_day",r.target.value),readOnly:!t(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:m.estimate_delivery_express_day||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"normal_delivery_charges",children:"Normal Delivery Charge (Rs)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${t(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"normal_delivery_charges",autoComplete:"off",value:n.normal_delivery_charges,onChange:r=>a("normal_delivery_charges",r.target.value),readOnly:!t(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:m.normal_delivery_charges||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"express_delivery_24hrs",children:"Express Delivery 24 Hours (%)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${t(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"express_delivery_24hrs",autoComplete:"off",value:n.express_delivery_24hrs,onChange:r=>a("express_delivery_24hrs",r.target.value),readOnly:!t(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:m.express_delivery_24hrs||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"express_delivery_48hrs",children:"Express Delivery 48 Hours (%)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${t(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"express_delivery_48hrs",autoComplete:"off",value:n.express_delivery_48hrs,onChange:r=>a("express_delivery_48hrs",r.target.value),readOnly:!t(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:m.express_delivery_48hrs||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"express_delivery_72hrs",children:"Express Delivery 72 Hours (%)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${t(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"express_delivery_72hrs",autoComplete:"off",value:n.express_delivery_72hrs,onChange:r=>a("express_delivery_72hrs",r.target.value),readOnly:!t(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:m.express_delivery_72hrs||" "})]})]})}),t(2,"update")&&e.jsx("div",{className:"flex relative justify-end pt-2.5",children:e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:b,children:b?e.jsxs(e.Fragment,{children:["Saving... ",e.jsx(O,{})]}):e.jsx(e.Fragment,{children:"Save Changes "})})})]})})]})})})},W=$().shape({title:x().required("Title is required"),price:H().required("Please enter price").typeError("Price must be a number").min(0,"Price must be a positive number"),promotion_code:x().notRequired().matches(/^[a-zA-Z0-9]*$/,"Coupon code can only contain letters and numbers").test("length","Coupon code must be between 3 and 30 characters long",s=>!s||s.length>=3&&s.length<=30).nullable(),image:I().test("fileType","Allowed Format : jpg, jpeg, png, ",s=>s&&s instanceof File?["image/jpeg","image/png","image/jpg"].includes(s.type):!0).test("dimensions","image dimention 632×445 pixels allowed",s=>!s||!(s instanceof File)?!0:new Promise(h=>{const p=new Image;p.src=URL.createObjectURL(s),p.onload=()=>{URL.revokeObjectURL(p.src),h(p.width===632&&p.height===445)},p.onerror=()=>{h(!1)}})).nullable()}),Z=()=>{const{settingsData:s,fetchSetting:h,loading:p}=B(),{addSetting:S,loading:b}=P(),{updatePromotionBanner:m,loading:f}=z(),[_,k]=c.useState(null),[t,i]=c.useState({}),[n,j]=c.useState(!1),{hasPermission:u}=R(),[a,r]=c.useState({image:null,title:"",price:"",promotion_code:"",offer_validity:D()}),[g,N]=c.useState({image:null,title:"",price:"",promotion_code:"",offer_validity:D()});c.useEffect(()=>{h(),j(!1)},[n]),c.useEffect(()=>{var o,l;if(s){const d=JSON.parse((o=s==null?void 0:s.data)==null?void 0:o.home_promotion_banner_website),v=(l=s==null?void 0:s.data)==null?void 0:l.home_banner_image,w={...a,title:d.title||"",price:d.price||"",promotion_code:d.promotion_code||"",offer_validity:D(d.offer_validity),image:v};r(w),N(w)}},[s]);const C=o=>{r(l=>({...l,offer_validity:o}))},y=o=>{var d;const l=(d=o.target.files)==null?void 0:d[0];if(l){const v=URL.createObjectURL(l);k(v),r(w=>({...w,image:l}))}},A=async o=>{o.preventDefault();try{await W.validate(a,{abortEarly:!1});let l;const d=new FormData;if(_!==null&&(d.append("home_banner_image",a.image),d.append("setting_key","home_banner_image"),l=await m(d),l&&(i({}),j(!0)),k(null)),!Object.keys(a).some(F=>F==="image"?!1:a[F]!==g[F]))return;const w={title:a.title,price:a.price,promotion_code:a.promotion_code,offer_validity:a.offer_validity},L=[{setting_key:"home_promotion_banner_website",setting_value:JSON.stringify(w)}];l=await S(L),l&&(i({}),j(!0))}catch(l){if(l instanceof q){const d={};l.inner.forEach(v=>{d[v.path||""]=v.message}),i(d)}else E.error("Failed to submit the form. Please try again.")}};return p?e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"card pb-2.5 min-w-full !border-gray-200",children:[e.jsx("div",{className:"card-header",children:e.jsx("span",{className:"inline-block h-[31px] min-w-32 bg-gray-200 rounded-md animate-pulse"})}),e.jsx("div",{children:e.jsxs("div",{className:"card-body grid gap-4",children:[e.jsx("div",{className:"flex items-center flex-wrap gap-2.5",children:e.jsx("div",{className:"flex justify-end bnmobile:justify-center flex-wrap grow gap-2.5",children:e.jsx("div",{className:"w-full max-w-[300px] h-[200px] rounded-md bg-gray-200 animate-pulse mdmobile:h-[150px]"})})}),Array.from({length:4}).map((o,l)=>e.jsx("div",{className:"w-full py-2",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("span",{className:"grow inline-block w-56 h-9 bg-gray-200 animate-pulse rounded-md"}),e.jsx("span",{className:"grow inline-block w-56 h-9 bg-gray-200 animate-pulse rounded-md"})]})},l)),e.jsx("div",{className:"flex relative justify-end pt-2.5",children:e.jsx("span",{className:"inline-block w-32 h-12 bg-gray-200 animate-pulse rounded-md"})})]})})]})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"card min-w-full pb-2.5",children:[e.jsx("div",{className:"card-header",id:"basic_settings",children:e.jsx("h3",{className:"card-title",children:"Promotion Banner"})}),e.jsx("form",{onSubmit:A,children:e.jsxs("div",{className:"card-body grid gap-4",children:[e.jsx("div",{className:"flex items-center flex-wrap gap-2.5",children:e.jsx("div",{className:"flex justify-end bnmobile:justify-center flex-wrap grow gap-2.5",children:e.jsxs("div",{className:"image-input relative","data-image-input":"true",children:[e.jsx("label",{htmlFor:"image-upload",className:`btn btn-icon btn-icon-2xl btn-light absolute z-1 size-8 -top-0.5 -right-0.5 rounded-full ${u(2,"update")?"":"hidden"}`,children:u(2,"update")&&e.jsx(T,{className:"text-blue-600"})}),e.jsx("input",{id:"image-upload",type:"file",accept:"image/*",style:{display:"none"},onChange:y}),e.jsxs("div",{className:"flex flex-col items-center max-w-[300px] bnmobile:w-[95%]",children:[e.jsx("div",{className:"image-input-placeholder rounded-md border-2",children:e.jsx("img",{className:"h-[200px] w-[300px] rounded-sm",src:_||typeof a.image=="string"&&a.image||"",alt:"Promotion Banner"})}),e.jsx("p",{className:"text-red-500 text-sm min-h-[20px] block w-full text-center",children:t.image||" "})]})]})})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"title",children:"Title"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${u(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"title",autoComplete:"off",value:a.title,onChange:o=>r({...a,title:o.target.value}),readOnly:!u(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:t.title||" "})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"price",children:"Price (Rs)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${u(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"price",autoComplete:"off",value:a.price,onChange:o=>r({...a,price:o.target.value}),readOnly:!u(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:t.price||" "})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",htmlFor:"promotion_code",children:"Promotion code"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${u(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",id:"promotion_code",autoComplete:"off",value:a.promotion_code,onChange:o=>r({...a,promotion_code:o.target.value}),readOnly:!u(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:t.promotion_code||" "})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5 mt-3",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",children:"Offer Validity"}),e.jsx(G,{dateAdapter:V,children:e.jsx(Y,{value:a.offer_validity,onChange:C,disabled:!u(2,"update"),format:"DD-MM-YYYY",slotProps:{textField:{fullWidth:!0,InputProps:{style:{height:"35px",width:"155px",fontSize:"14px"}}}},disablePast:!0})})]})}),u(2,"update")&&e.jsx("div",{className:"flex relative justify-end pt-2.5",children:e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:b||f,children:b||f?e.jsxs(e.Fragment,{children:["Saving...",e.jsx(O,{})]}):e.jsx(e.Fragment,{children:"Save Changes"})})})]})})]})})})},ee=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container-fixed",children:e.jsx("div",{className:"flex flex-wrap items-center lg:items-end justify-between gap-5 pb-7.5",children:e.jsx("div",{className:"flex flex-col justify-center gap-2",children:e.jsx("h1",{className:"text-xl font-semibold leading-none text-gray-900",children:"Settings"})})})}),e.jsx("div",{className:"container-fixed",children:e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-5 lg:gap-7.5",children:[e.jsx(M,{}),e.jsx(Z,{})]})})]});export{ee as default};
