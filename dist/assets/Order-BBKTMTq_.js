import{r as g,_ as O,I as U,u as V,J as K,m as T,j as e,F as l,a as i,T as q,O as j,K as N,L as J,b as W,c as Z,d as H,e as Q,S as v,s as X,V as ee}from"./index-D8mCTybp.js";import{d as L}from"./dayjs.min-CKGvEKSv.js";const se=()=>{const[x,n]=g.useState(!1);return{deleteOrder:async c=>{const u=localStorage.getItem("authToken"),m=`http://35.154.167.170:3000/admin/order/${c}`;n(!0);try{const d=await fetch(m,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`}}),r=await d.json();return d.ok?{success:!0,message:r.message}:(O.error(r.message,{position:"top-center"}),{success:!1,message:r.message})}catch(d){return O.error("An unexpected error occurred.",{position:"top-center"}),{success:!1,message:d.message}}finally{n(!1)}},loading:x}};function re(x){return U({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2"},child:[]}]})(x)}const te=({search:x})=>{const[n,h]=g.useState(1),[c,u]=g.useState(10),[m,d]=V(),[r,C]=g.useState(null),[t,p]=g.useState(null),S=m.get("page"),_=m.get("perPage"),{orders:y,loading:F,totalOrders:w,fetchOrders:k}=K(n,c,x,r,t),D=T(),f=Math.ceil(w/c),{deleteOrder:M}=se(),Y=s=>{D(`/order/${s}`)},$=async s=>{try{const{isConfirmed:o}=await v.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel"});if(o){const{success:A,message:b}=await M(s);A?(y.filter(G=>G.order_id!==s).length===0&&n>1&&(h(n-1),d({page:(n-1).toString(),perPage:c.toString()})),await k(),v.fire(b)):v.fire(b)}}catch(o){v.fire({title:"Error",text:o.message,icon:"error"})}},B=s=>{D(`/order/edit/${s}`)};g.useEffect(()=>{S&&h(Number(S)),_&&u(Number(_))},[S,_]),g.useEffect(()=>{x?(h(1),d({search:x,page:"1",perPage:c.toString()})):d({page:"1",perPage:c.toString()})},[x]),g.useEffect(()=>{k()},[c,n,x,r,t,k]);const a=s=>{r===s?p(t==="ASC"?"DESC":"ASC"):(C(s),p("ASC"))},E=s=>{s>=1&&s<=f&&(h(s),d({page:s.toString(),perPage:c.toString()}))},I=s=>{const o=Number(s.target.value);u(o),h(1),d({page:"1",perPage:o.toString()})},R=s=>{switch(s){case j.Pending:return"badge badge-pending";case j["In Process"]:return"badge badge-in-process";case j["Ready to delivery"]:return"badge badge-ready-to-deliver";case j["Delivery complete"]:return"badge badge-delivery-complete";default:return"badge"}},z=s=>{switch(s){case N.Pending:return"badge badge-pending";case N["Partial received"]:return"badge badge-ready-to-deliver";case N.Received:return"badge badge-delivery-complete";default:return"badge"}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"inline-block",children:e.jsxs("div",{className:"flex mb-3 items-center gap-2",children:["Show",e.jsxs("select",{className:"select select-sm w-16",value:c,onChange:I,children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"})]}),"per page"]})}),e.jsx("div",{className:"grid gap-5 lg:gap-5.5",children:e.jsx("div",{className:"card card-grid min-w-full",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"scrollable-x-auto",children:e.jsxs("table",{className:"table table-auto table-border",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"min-w-[90px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("order_id"),children:["Id",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(l,{color:r==="order_id"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="order_id"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[140px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("first_name"),children:["Customer",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(l,{color:r==="first_name"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="first_name"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[140px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("email"),children:["Email",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(l,{color:r==="email"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="email"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[140px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("mobile_number"),children:["Mobile no",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(l,{color:r==="mobile_number"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="mobile_number"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[230px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("address_details"),children:["Shipping Address",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(l,{color:r==="address_details"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="address_details"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[230px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("description"),children:["Description",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(l,{color:r==="description"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="description"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[130px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer ",onClick:()=>a("coupon_code"),children:["Coupon code",e.jsxs("div",{className:"flex cursor-pointer mt-2",children:[e.jsx(l,{color:r==="coupon_code"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="coupon_code"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[130px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("coupon_discount"),children:["Coupon discount",e.jsxs("div",{className:"flex cursor-pointer mt-2",children:[e.jsx(l,{color:r==="coupon_discount"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="coupon_discount"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[130px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("order_statue"),children:["Order Status",e.jsxs("div",{className:"flex cursor-pointer mt-2",children:[e.jsx(l,{color:r==="order_status"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="order_status"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[200px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("estimated_delivery_time"),children:["Estimated delivery time",e.jsxs("div",{className:"flex cursor-pointer mt-2",children:[e.jsx(l,{color:r==="order_status"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="estimated_delivery_time"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[200px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("estimated_pickup_time"),children:["Estimated pickup time",e.jsxs("div",{className:"flex cursor-pointer mt-2",children:[e.jsx(l,{color:r==="order_status"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="estimated_pickup_time"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[140px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("shipping_charges"),children:["Shipping charge",e.jsxs("div",{className:"flex cursor-pointer mt-2",children:[e.jsx(l,{color:r==="shipping_charges"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="shipping_charges"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[180px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("express_delivery_charges"),children:["Express delivery charges",e.jsxs("div",{className:"flex cursor-pointer mt-2",children:[e.jsx(l,{color:r==="express_delivery_charges"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="express_delivery_charges"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[180px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("gst"),children:["GST",e.jsxs("div",{className:"flex cursor-pointer mt-2",children:[e.jsx(l,{color:r==="gst"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="gst"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[130px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("kasar_amount"),children:["Kasar amount",e.jsxs("div",{className:"flex cursor-pointer mt-2",children:[e.jsx(l,{color:r==="kasar_amount"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="kasar_amount"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[130px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("sub_total"),children:["Sub total",e.jsxs("div",{className:"flex cursor-pointer ",children:[e.jsx(l,{color:r==="sub_total"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="sub_total"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[105px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("total"),children:["Total",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(l,{color:r==="total"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="total"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[165px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("payment_type"),children:["Payment type",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(l,{color:r==="payment_type"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="payment_type"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[175px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("payment_status"),children:["Payment Status",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(l,{color:r==="payment_status"&&t==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:r==="payment_status"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"w-[170px]",children:"Actions"})]})}),F?e.jsx(q,{}):y.length!==null?e.jsx("tbody",{children:y.map(s=>{const o=j[s.order_status],A=R(s.order_status),b=N[s.payment_status],P=z(s.payment_status);return e.jsxs("tr",{children:[e.jsx("td",{children:s.order_id}),e.jsx("td",{children:s.user.first_name+" "+s.user.last_name}),e.jsx("td",{children:s.user.email}),e.jsx("td",{children:s.user.mobile_number}),e.jsx("td",{children:s.address_details}),e.jsx("td",{children:s.description}),e.jsx("td",{children:s.coupon_code}),e.jsx("td",{children:s.coupon_discount}),e.jsx("td",{children:e.jsx("span",{className:`${A} badge-outline rounded-[30px]`,children:o})}),e.jsx("td",{children:e.jsx("div",{className:"flex flex-col",children:L(s.estimated_delivery_time).format("DD-MM-YYYY")})}),e.jsx("td",{children:e.jsx("div",{className:"flex flex-col",children:L(s.estimated_pickup_time).format("DD-MM-YYYY")})}),e.jsx("td",{children:s.shipping_charges}),e.jsx("td",{children:s.express_delivery_charges}),e.jsx("td",{children:s.gst}),e.jsx("td",{children:s.kasar_amount}),e.jsx("td",{children:s.sub_total}),e.jsx("td",{children:s.total}),e.jsx("td",{children:J[s.payment_type]}),e.jsx("td",{children:e.jsx("span",{className:`${P} badge-outline rounded-[30px]`,children:b})}),e.jsx("td",{children:e.jsxs("div",{className:"flex",children:[e.jsx("button",{className:"mr-3 bg-yellow-100 hover:bg-yellow-200 p-[11px] rounded-full",onClick:()=>Y(s.order_id),children:e.jsx(re,{size:18,className:"text-yellow-600"})}),e.jsx("button",{className:"mr-3 bg-yellow-100 hover:bg-yellow-200 p-3 rounded-full",onClick:()=>B(s.order_id),children:e.jsx(W,{className:"text-yellow-600"})}),e.jsx("button",{className:"bg-red-100 hover:bg-red-200 p-3 rounded-full",onClick:()=>$(s.order_id),children:e.jsx(Z,{className:"text-red-500"})})]})})]},s.order_id)})}):e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center",children:"No banners available"})})})]})})})})}),w>c&&e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsxs("span",{className:"text-gray-700",children:["Showing ",y.length," of ",w," Orders"]}),e.jsxs("div",{className:"pagination","data-datatable-pagination":"true",children:[e.jsx("button",{disabled:n===1,onClick:()=>E(n-1),className:`btn ${n===1?"disabled":""}`,children:e.jsx(H,{})}),Array.from({length:f}).map((s,o)=>e.jsx("button",{className:`btn ${n===o+1?"active":""}`,onClick:()=>E(o+1),children:o+1},o)),e.jsx("button",{disabled:n===f,onClick:()=>E(n+1),className:`btn ${n===f?"disabled":""}`,children:e.jsx(Q,{})})]})]})]})},ie=()=>{const[x,n]=g.useState(""),[h,c]=g.useState(""),[u,m]=g.useState(""),d=T(),r=()=>{d("/order/add")},C=async t=>{t.preventDefault();try{await X.validate({search:h},{abortEarly:!1}),n(h),m("")}catch(p){p instanceof ee&&m(p.errors[0])}};return e.jsxs("div",{className:"container-fixed relative",children:[e.jsxs("div",{className:"flex flex-wrap items-center lg:items-end justify-between gap-5 pb-7.5",children:[e.jsx("h1",{className:"text-xl font-semibold leading-none text-gray-900",children:"Orders"}),e.jsxs("button",{className:"btn btn-primary",onClick:r,children:[e.jsx("i",{className:"ki-filled ki-plus-squared"}),"Add Order"]})]}),e.jsxs("div",{className:"absolute top-11 right-[2.5rem] mt-2",children:[e.jsxs("form",{onSubmit:C,className:"w-64 relative flex",children:[e.jsx("input",{type:"search",value:h,onChange:t=>{c(t.target.value),t.target.value===""&&n("")},className:"peer block min-h-[auto] w-full rounded border bg-transparent px-3 py-[0.32rem] leading-[1.6] text-gray-700 outline-none focus:border-primary focus:bg-white border-primary",placeholder:"Search"}),e.jsx("button",{type:"submit",className:"relative z-[2] -ml-0.5 flex items-center rounded-e bg-gray-500 px-5 text-xs font-medium uppercase leading-normal text-white",children:e.jsx("svg",{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"h-5 w-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})})})]}),e.jsx("p",{className:"absolute top-8 right-[0.2rem] mt-2 text-red-500 text-sm w-80",children:u||" "})]}),e.jsx(te,{search:x})]})};export{ie as default};
