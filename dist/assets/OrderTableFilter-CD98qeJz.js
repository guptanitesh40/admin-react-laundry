import{r as n,B as q,V as U,t as H,v as J,j as i,D as K,h as M}from"./index-2ZTwDx-K.js";import{P as Q}from"./enums-B-CFt858.js";import{M as k}from"./MultiSelect-t4pELMlf.js";const te=(s=1,o=10,S="",y,h,d,p,u,f,v,B,g,x,b,j="",E="")=>{const[_,$]=n.useState(),[Y,C]=n.useState(0),[R,F]=n.useState(!1),D=async()=>{var O;const w=localStorage.getItem("authToken"),c=new URLSearchParams;s&&c.append("page_number",s.toString()),o&&c.append("per_page",o.toString()),S&&c.append("search",S),y&&c.append("sort_by",y),h&&c.append("order",h),d&&d.forEach(l=>c.append("order_statuses",l.toString())),p&&p.forEach(l=>c.append("customer_ids",l.toString())),u&&u.forEach(l=>c.append("branches_ids",l.toString())),f&&f.forEach(l=>c.append("pickup_boy_ids",l.toString())),v&&v.forEach(l=>c.append("delivery_boy_ids",l.toString())),j&&c.append("list",j),E&&c.append("orderList",E),g&&g.forEach(l=>c.append("payment_statuses",l.toString())),B&&c.append("payment_types",B.toString()),x&&b&&(c.append("start_date",x),c.append("end_date",b)),F(!0);try{const l=await fetch(`${q}/admin/orders?${c}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${w}`}}),m=await l.json();if(!l.ok){U.error(m.message,{position:"top-center"});return}$((m==null?void 0:m.data)||{}),C(((O=m==null?void 0:m.data)==null?void 0:O.count)||0)}catch(l){U.error(l||"Network error: Failed to fetch.",{position:"top-center"})}finally{F(!1)}};return n.useEffect(()=>{D()},[s,o,S,y,h,d,p,u,f,v,B,g,x,b]),{orderData:_,count:Y,loading:R,fetchOrders:D}},ae=()=>{const[s,o]=n.useState(!1);return{deleteOrder:async y=>{const h=localStorage.getItem("authToken"),d=`http://35.154.167.170:3000/admin/order/${y}`;o(!0);try{const p=await fetch(d,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`}}),u=await p.json();return p.ok?{success:!0,message:u.message}:(U.error(u.message,{position:"top-center"}),{success:!1,message:u.message})}catch(p){return U.error("An unexpected error occurred.",{position:"top-center"}),{success:!1,message:p.message}}finally{o(!1)}},loading:s}},{RangePicker:W}=K,se=({filters:s,updateFilters:o,showOrderStatusFilter:S=!0,orderStatusOptions:y,showSearchInput:h=!0})=>{const[d,p]=n.useState([]),[u,f]=n.useState([]),[v,B]=n.useState([]),[g,x]=n.useState([]),[b,j]=n.useState([]),[E,_]=n.useState([]),[$,Y]=n.useState([]),[C,R]=n.useState([]),[F,D]=n.useState([]),[w,c]=n.useState(""),[O,l]=n.useState(""),[m,A]=n.useState(""),{branches:N}=H(),{fetchUsersByRole:V}=J(),G=Object.entries(Q).filter(([e,t])=>typeof t=="number").map(([e,t])=>({label:e,value:t})),z=e=>{e&&e[0]&&e[1]?o({...s,start_date:M(e[0]).format("DD-MM-YYYY"),end_date:M(e[1]).format("DD-MM-YYYY")}):o({...s,start_date:"",end_date:""})};n.useEffect(()=>{(async()=>{const t=await V(5),a=await V(4),r=await V(4),T=L=>L.map(P=>({label:`${P.first_name} ${P.last_name} (${P.mobile_number})`,value:P.user_id}));p(T(t)),x(T(a)),Y(T(r))})()},[]),n.useEffect(()=>{w?(async()=>{const a=(await V(5,w)).map(r=>({label:`${r.first_name} ${r.last_name} (${r.mobile_number})`,value:r.user_id}));f(a)})():f(d)},[w,d]),n.useEffect(()=>{O?(async()=>{const a=(await V(4,O)).map(r=>({label:`${r.first_name} ${r.last_name} (${r.mobile_number})`,value:r.user_id}));j(a)})():j(g)},[b,g]),n.useEffect(()=>{m?(async()=>{const a=(await V(4,O)).map(r=>({label:`${r.first_name} ${r.last_name} (${r.mobile_number})`,value:r.user_id}));R(a)})():R($)},[C,$]);const I=(e,t)=>[...e.filter(a=>!t.some(r=>r.value===a.value)),...t];return i.jsx(i.Fragment,{children:i.jsx("div",{className:"p-4",children:i.jsxs("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(250px,1fr))] gap-4",children:[i.jsx(k,{options:I(v,u),displayValue:"label",placeholder:"Search Customer",selectedValues:v.map(e=>e.value),onSelect:e=>{B(e);const t=e.map(a=>a.value);o({...s,customerFilter:t})},onRemove:e=>{B(e);const t=e.map(a=>a.value);o({...s,customerFilter:t})},setSearch:c,className:"w-full",isSearchInput:!0}),S&&i.jsx(k,{options:y,displayValue:"label",placeholder:"Select Order Status",selectedValues:s.orderStatusFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,orderStatusFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,orderStatusFilter:t})},isCustomLabel:!0,className:"w-full",isSearchInput:h}),i.jsx(k,{options:N==null?void 0:N.map(e=>({label:e.branch_name,value:e.branch_id})),displayValue:"branch_name",placeholder:"Select Branch",selectedValues:s==null?void 0:s.branchFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,branchFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,branchFilter:t})},className:"w-full",isSearchInput:!0}),i.jsx(k,{options:I(F,C),displayValue:"label",placeholder:"Search DeliveryBoy",selectedValues:s.deliveryBoyFilter,onSelect:e=>{D(e);const t=e.map(a=>a.value);o({...s,deliveryBoyFilter:t})},onRemove:e=>{D(e);const t=e.map(a=>a.value);o({...s,deliveryBoyFilter:t})},setSearch:A,className:"w-full",isSearchInput:!0}),i.jsx(k,{options:I(E,b),displayValue:"label",placeholder:"Search PickupBoy",selectedValues:s.pickupBoyFilter,onSelect:e=>{_(e);const t=e.map(a=>a.value);o({...s,pickupBoyFilter:t})},onRemove:e=>{_(e);const t=e.map(a=>a.value);o({...s,pickupBoyFilter:t})},setSearch:l,className:"w-full",isSearchInput:!0}),i.jsx(k,{options:G,displayValue:"label",placeholder:"Select Payment Status",selectedValues:s.paymentStatusFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,paymentStatusFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,paymentStatusFilter:t})},sliceCount:2,isSearchInput:!1,className:"w-full"}),i.jsxs("select",{className:"select select-lg w-full text-sm",value:s.paymentTypeFilter??"",onChange:e=>{o({...s,paymentTypeFilter:Number(e.target.value)})},children:[i.jsx("option",{value:"",children:"Payment type"}),i.jsx("option",{value:1,children:"Cash on Delivery"}),i.jsx("option",{value:2,children:"Online Payment"})]}),i.jsx("div",{children:i.jsx(W,{className:"w-full min-w-[80px] px-3 py-2 rounded-md border-gray-300",popupClassName:"custom-rangepicker-dropdown",onChange:z,format:"DD-MM-YYYY"})})]})})})};export{se as O,ae as a,te as u};
