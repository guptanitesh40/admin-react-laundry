import{a as P,d as x,J as k,K as $,r as m,e as F,j as e,b as R,V as O,i as U,m as I,N as A,l as C,F as T}from"./index-BrUGgg9K.js";import{L as q}from"./Loading-BEHoMz74.js";import{au as z,av as G}from"./AdapterDayjs-CCNQyx74.js";import{D as H}from"./DatePicker-By-R6uL-.js";const V=P().shape({estimate_pickup_normal_hour:x().notRequired().test("is-numeric","Estimate pickup normal hour must be a positive number",a=>a?/^\d+$/.test(a):!0),estimate_pickup_express_hour:x().notRequired().test("is-numeric","Estimate pickup express hour must be a positive number",a=>a?/^\d+$/.test(a):!0),gst_percentage:x().notRequired().test("is-numeric","GST percentage must be a positive number",a=>a?/^\d+$/.test(a):!0),estimate_delivery_normal_day:x().notRequired().test("is-numeric","Estimate delivery normal day must be a positive number",a=>a?/^\d+$/.test(a):!0),estimate_delivery_express_day:x().notRequired().test("is-numeric","Estimate delivery express day must be a positive number",a=>a?/^\d+$/.test(a):!0),normal_delivery_charges:x().notRequired().test("is-numeric","Normal delivery charge must be a positive number",a=>a?/^\d+$/.test(a):!0),express_delivery_charge:x().notRequired().test("is-numeric","Express delivery charge must be a positive number",a=>a?/^\d+$/.test(a):!0)}),Y=({})=>{const{settingsData:a,fetchSetting:_}=k(),{addSetting:p,loading:b}=$(),[u,N]=m.useState({}),[E,w]=m.useState(!1),{hasPermission:r}=F(),c=a==null?void 0:a.data,[i,y]=m.useState({estimate_delivery_express_day:"",estimate_delivery_normal_day:"",estimate_pickup_express_hour:"",estimate_pickup_normal_hour:"",gst_percentage:"",normal_delivery_charges:"",express_delivery_charge:""});m.useEffect(()=>{_(),w(!1)},[E]),m.useEffect(()=>{c&&y({estimate_delivery_express_day:c.estimate_delivery_express_day||"",estimate_delivery_normal_day:c.estimate_delivery_normal_day||"",estimate_pickup_express_hour:c.estimate_pickup_express_hour||"",estimate_pickup_normal_hour:c.estimate_pickup_normal_hour||"",gst_percentage:c.gst_percentage||"",normal_delivery_charges:c.normal_delivery_charges||"",express_delivery_charge:c.express_delivery_charge||""})},[c]);const d=async t=>{t.preventDefault();try{if(await V.validate(i,{abortEarly:!1}),!Object.keys(i).some(f=>i[f]!==c[f]))return;const v=Object.keys(i).map(f=>({setting_key:f,setting_value:i[f]}));await p(v)&&(N({}),w(!0))}catch(g){if(g instanceof R){const v={};g.inner.forEach(S=>{v[S.path||""]=S.message}),N(v)}else O.error("Failed to submit the form. Please try again.")}},s=(t,g)=>{y({...i,[t]:g})};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"card pb-2.5 min-w-full",children:[e.jsx("div",{className:"card-header",id:"basic_settings",children:e.jsx("h3",{className:"card-title",children:"General Settings"})}),e.jsx("form",{onSubmit:d,children:e.jsxs("div",{className:"card-body grid gap-1",children:[e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",children:"Estimate Pickup Normal Hour (In Hour)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${r(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",value:i.estimate_pickup_normal_hour||"",onChange:t=>s("estimate_pickup_normal_hour",t.target.value),readOnly:!r(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:u.estimate_pickup_normal_hour||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",children:"Estimate Pickup Express Hour (In Hour)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${r(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",value:i.estimate_pickup_express_hour||"",onChange:t=>s("estimate_pickup_express_hour",t.target.value),readOnly:!r(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:u.estimate_pickup_express_hour||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",children:"GST Percentage (%)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${r(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",value:i.gst_percentage,onChange:t=>s("gst_percentage",t.target.value),readOnly:!r(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:u.gst_percentage||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",children:"Estimate Delivery Normal Day (Day)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${r(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",value:i.estimate_delivery_normal_day,onChange:t=>s("estimate_delivery_normal_day",t.target.value),readOnly:!r(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:u.estimate_delivery_normal_day||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",children:"Estimate Delivery Express Day (Day)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${r(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",value:i.estimate_delivery_express_day,onChange:t=>s("estimate_delivery_express_day",t.target.value),readOnly:!r(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:u.estimate_delivery_express_day||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",children:"Normal Delivery Charge (Rs)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${r(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",value:i.normal_delivery_charges,onChange:t=>s("normal_delivery_charges",t.target.value),readOnly:!r(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:u.normal_delivery_charges||" "})]})]})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",children:"Express Delivery Charge (Rs)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${r(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",value:i.express_delivery_charge,onChange:t=>s("express_delivery_charge",t.target.value),readOnly:!r(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:u.express_delivery_charge||" "})]})]})}),r(2,"update")&&e.jsx("div",{className:"flex relative justify-end pt-2.5",children:e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:b,children:b?e.jsxs(e.Fragment,{children:["Saving... ",e.jsx(q,{})]}):e.jsx(e.Fragment,{children:"Save Changes "})})})]})})]})})})},J=P().shape({title:x().required("Title is required"),price:I().required("Please enter price").typeError("Price must be a number").min(0,"Price must be a positive number"),promotion_code:x().notRequired().matches(/^[a-zA-Z0-9]*$/,"Coupon code can only contain letters and numbers").test("length","Coupon code must be between 3 and 30 characters long",a=>!a||a.length>=3&&a.length<=30).nullable(),image:U().test("fileType","Allowed Format : jpg, jpeg, png, ",a=>a&&a instanceof File?["image/jpeg","image/png","image/jpg"].includes(a.type):!0).test("dimensions","image dimention 632×445 pixels allowed",a=>!a||!(a instanceof File)?!0:new Promise(_=>{const p=new Image;p.src=URL.createObjectURL(a),p.onload=()=>{URL.revokeObjectURL(p.src),_(p.width===632&&p.height===445)},p.onerror=()=>{_(!1)}})).nullable()}),M=()=>{const{settingsData:a,fetchSetting:_}=k(),{addSetting:p,loading:b}=$(),{updatePromotionBanner:u,loading:N}=A(),[E,w]=m.useState(null),[r,c]=m.useState({}),[i,y]=m.useState(!1),{hasPermission:d}=F(),[s,t]=m.useState({image:null,title:"",price:"",promotion_code:"",offer_validity:C()}),[g,v]=m.useState({image:null,title:"",price:"",promotion_code:"",offer_validity:C()});m.useEffect(()=>{_(),y(!1)},[i]),m.useEffect(()=>{var n,l;if(a){const o=JSON.parse((n=a==null?void 0:a.data)==null?void 0:n.home_promotion_banner_website),h=(l=a==null?void 0:a.data)==null?void 0:l.home_banner_image,j={...s,title:o.title||"",price:o.price||"",promotion_code:o.promotion_code||"",offer_validity:C(o.offer_validity),image:h};t(j),v(j)}},[a]);const S=n=>{t(l=>({...l,offer_validity:n}))},f=n=>{var o;const l=(o=n.target.files)==null?void 0:o[0];if(l){const h=URL.createObjectURL(l);w(h),t(j=>({...j,image:l}))}},B=async n=>{n.preventDefault();try{await J.validate(s,{abortEarly:!1});let l;const o=new FormData;if(E!==null&&(o.append("home_banner_image",s.image),o.append("setting_key","home_banner_image"),l=await u(o),l&&y(!0),w(null)),!Object.keys(s).some(D=>D==="image"?!1:s[D]!==g[D]))return;const j={title:s.title,price:s.price,promotion_code:s.promotion_code,offer_validity:s.offer_validity},L=[{setting_key:"home_promotion_banner_website",setting_value:JSON.stringify(j)}];l=await p(L),l&&(c({}),y(!0))}catch(l){if(l instanceof R){const o={};l.inner.forEach(h=>{o[h.path||""]=h.message}),c(o)}else O.error("Failed to submit the form. Please try again.")}};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"card min-w-full pb-2.5",children:[e.jsx("div",{className:"card-header",id:"basic_settings",children:e.jsx("h3",{className:"card-title",children:"Promotion Banner"})}),e.jsx("form",{onSubmit:B,children:e.jsxs("div",{className:"card-body grid gap-4",children:[e.jsx("div",{className:"flex items-center flex-wrap gap-2.5",children:e.jsx("div",{className:"flex justify-end flex-wrap grow gap-2.5",children:e.jsxs("div",{className:"image-input relative","data-image-input":"true",children:[e.jsx("label",{htmlFor:"image-upload",className:`btn btn-icon btn-icon-2xl btn-light absolute z-1 size-8 -top-0.5 -right-0.5 rounded-full ${d(2,"update")?"":"hidden"}`,children:d(2,"update")&&e.jsx(T,{className:"text-blue-600"})}),e.jsx("input",{id:"image-upload",type:"file",accept:"image/*",style:{display:"none"},onChange:f}),e.jsxs("div",{className:"flex flex-col items-center w-[300px]",children:[e.jsx("div",{className:"image-input-placeholder rounded-md border-2",children:e.jsx("img",{className:"h-[200px] w-[300px] rounded-sm",src:E||typeof s.image=="string"&&s.image||"",alt:"Promotion Banner"})}),e.jsx("p",{className:"text-red-500 text-sm min-h-[20px] block w-full text-center",children:r.image||" "})]})]})})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",children:"Title"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${d(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",value:s.title,onChange:n=>t({...s,title:n.target.value}),readOnly:!d(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:r.title||" "})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",children:"Price (Rs)"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${d(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",value:s.price,onChange:n=>t({...s,price:n.target.value}),readOnly:!d(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:r.price||" "})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",children:"Promotion code"}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("input",{className:`input ${d(2,"update")?"":"border-gray-300 bg-gray-100 cursor-not-allowed focus:outline-none"}`,type:"text",value:s.promotion_code,onChange:n=>t({...s,promotion_code:n.target.value}),readOnly:!d(2,"update")}),e.jsx("p",{className:"text-red-500 text-sm",children:r.promotion_code||" "})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-baseline flex-wrap lg:flex-nowrap gap-2.5 mt-3",children:[e.jsx("label",{className:"form-label flex items-center gap-1 max-w-56",children:"Offer Validity"}),e.jsx(z,{dateAdapter:G,children:e.jsx(H,{value:s.offer_validity,onChange:S,disabled:!d(2,"update"),format:"DD-MM-YYYY",slotProps:{textField:{fullWidth:!0,InputProps:{style:{height:"35px",width:"155px",fontSize:"14px"}}}}})})]})}),d(2,"update")&&e.jsx("div",{className:"flex relative justify-end pt-2.5",children:e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:b||N,children:b||N?e.jsxs(e.Fragment,{children:["Saving...",e.jsx(q,{})]}):e.jsx(e.Fragment,{children:"Save Changes"})})})]})})]})})})},X=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container-fixed",children:e.jsx("div",{className:"flex flex-wrap items-center lg:items-end justify-between gap-5 pb-7.5",children:e.jsx("div",{className:"flex flex-col justify-center gap-2",children:e.jsx("h1",{className:"text-xl font-semibold leading-none text-gray-900",children:"Settings"})})})}),e.jsx("div",{className:"container-fixed",children:e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-5 lg:gap-7.5",children:[e.jsx(Y,{}),e.jsx(M,{})]})})]});export{X as default};
