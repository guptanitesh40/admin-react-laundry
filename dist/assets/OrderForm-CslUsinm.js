import{r as m,_ as y,B as le,c as H,h as S,a as ne,q as Oe,j as e,V as Q,i as Ee,s as $e,g as Ie,k as qe,b as Ue,t as Re}from"./index-DNcAA4Il.js";import{u as Le}from"./useGetCategories-Jqe-M2yb.js";import{u as Ge}from"./useGetPrice-DK45B4vk.js";import{u as Be}from"./useGetBranches-j3tOVhO2.js";import{u as ze}from"./useGetOrder-DPlcSweh.js";import{u as Me}from"./useGetUsersByRole-BQVL_85W.js";import{u as Ve,c as Je}from"./userSchema-DTePQe5F.js";import{u as He}from"./useGetuser-DiGDq3W6.js";const Qe=()=>{const[d,u]=m.useState([]),[g,x]=m.useState(!1);return{products:d,loading:g,fetchProductsOnId:async h=>{const o=localStorage.getItem("authToken"),c=`http://3.110.208.70:3000/category/${h}/product`;x(!0);try{const r=await fetch(c,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}});if(!r.ok){const n=await r.json();y.error(n.message,{position:"top-center"});return}const i=await r.json(),v=(i==null?void 0:i.data)||[];u(v)}catch(r){y.error((r==null?void 0:r.message)||"Network error: Failed to fetch.",{position:"top-center"})}finally{x(!1)}}}},Ye=()=>{const[d,u]=m.useState([]),[g,x]=m.useState(!1);return{services:d,loading:g,fetchServicesOnId:async(h,o)=>{const c=localStorage.getItem("authToken"),r=`http://3.110.208.70:3000/category/${h}/product/${o}/service`;try{const i=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`}});if(!i.ok){const N=await i.json();y.error(N.message,{position:"top-center"});return}const v=await i.json(),n=(v==null?void 0:v.data)||[];u(n)}catch(i){y.error((i==null?void 0:i.message)||"Network error: Failed to fetch.",{position:"top-center"})}finally{x(!1)}}}},Ke="http://3.110.208.70:3000/admin/coupon/apply",We=()=>{const[d,u]=m.useState(!1);return{applyCoupon:async(x,p,h)=>{const o=localStorage.getItem("authToken");u(!0);try{const c=await fetch(Ke,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({user_id:x,order_Total:p,coupon_code:h})}),r=await c.json();return c.ok?r.data:(y.error(r.message,{position:"top-center"}),!1)}catch{y.error("Unable to apply coupon code!")}finally{u(!1)}},loading:d}},Xe=()=>{const[d,u]=m.useState([]),[g,x]=m.useState(!1),p=async h=>{const o=localStorage.getItem("authToken");x(!0);try{const c=await fetch(`${le}/admin/valid-coupons?${h}`,{method:"GET",headers:{Authorization:o?`Bearer ${o}`:""}}),r=await c.json();if(!c.ok){y.error(r.message,{position:"top-center"}),x(!1);return}u(r==null?void 0:r.data)}catch{y.error("Network error: Failed to fetch coupons.")}finally{x(!1)}};return m.useEffect(()=>{p()},[]),{validCoupons:d,fetchValidCoupons:p,loading:g}},Ze="http://3.110.208.70:3000",et=`${Ze}/admin/orders`,tt=()=>{const[d,u]=m.useState(!1);return{addOrder:async x=>{const p=localStorage.getItem("authToken");u(!0);try{const h=await fetch(et,{method:"POST",headers:{Authorization:`Bearer ${p}`,"Content-Type":"application/json"},body:JSON.stringify(x)});if(!h.ok){const c=await h.json();return y.error(c.message,{position:"top-center"}),!1}const o=await h.json();return y.success(o.message,{position:"top-center"}),!0}catch(h){return y.error((h==null?void 0:h.message)||"Network error: Failed to fetch.",{position:"top-center"}),!1}finally{u(!1)}},loading:d}},st=()=>{const[d,u]=m.useState(!1);return{updateOrder:async(x,p)=>{const h=localStorage.getItem("authToken"),o=`http://3.110.208.70:3000/admin/orders/${x}`;u(!0);try{const c=await fetch(o,{method:"PUT",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"},body:JSON.stringify(p)});if(c.ok){const i=await c.json();return y.success(i.message,{position:"top-center"}),!0}const r=await c.json();return y.error(r.message,{position:"top-center"}),!1}catch(c){return y.error((c==null?void 0:c.message)||"Network error: Failed to fetch.",{position:"top-center"}),!1}finally{u(!1)}},loading:d}},at=()=>{const[d,u]=m.useState([]),[g,x]=m.useState(!1);return{address:d,loading:g,fetchAddress:async h=>{var r;const o=localStorage.getItem("authToken"),c=`http://3.110.208.70:3000/address/${h}/user`;try{const i=await fetch(c,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}});if(!i.ok){const N=await i.json();y.error(N.message,{position:"top-center"});return}const v=await i.json(),n=((r=v==null?void 0:v.data)==null?void 0:r.result)||[];u(n)}catch(i){y.error((i==null?void 0:i.message)||"Network error: Failed to fetch.",{position:"top-center"})}finally{x(!1)}}}},rt=H().shape({category_id:S().nullable().required("Please select a category").test("required","Please select a category",d=>!!d),product_id:S().nullable().required("Please select a product").test("required","Please select a product",d=>!!d),service_id:S().nullable().required("Please select a service").test("required","Please select a service",d=>!!d),price:S().nullable().when(["category_id","product_id","service_id"],([d,u,g],x)=>d&&u&&g?x.required("Price is not available for the combination, please add a price"):x.nullable())}),lt=H().shape({username:ne().required("Please enter username"),address_id:S().required("Please select address").test("required","Please select address",d=>!!d),express_delivery_charges:S().typeError("Express delivery charges must be a number").min(0,"Express delivery charges must be a positive number"),shipping_charges:S().typeError("Shipping charge must be a number").min(0,"Shipping charge must be a positive number"),payment_type:S().required("Please choose payment type").test("required","Please choose order status",d=>!!d),payment_status:S().required("Please choose payment status").test("required","Please choose payment status",d=>!!d),paid_amount:S().typeError("Paid amount must be a number").min(0,"Paid amount must be a positive number"),branch_id:S().required("Please select branch").test("required","Please select branch",d=>!!d),items:Oe().of(rt)}),nt=localStorage.getItem("authToken"),ot=()=>{const[d,u]=m.useState(!1);return{addAddress:async x=>{u(!0);try{const p=await fetch(`${le}/address/admin`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${nt}`},body:JSON.stringify(x)});if(!p.ok){const o=await p.json();return y.error(o.message,{position:"top-center"}),!1}const h=await p.json();return y.success(h.message,{position:"top-center"}),!0}catch(p){return y.error((p==null?void 0:p.message)||"Error adding banner",{position:"top-center"}),!1}finally{u(!1)}},loading:d}},dt=H().shape({pincode:ne().required("Pin Code is required").matches(/^[0-9]{6}$/,"Pincode must be 6 digit"),address_type:S().required("Address type is required")}),it=({isOpen:d,onClose:u,userId:g,setIsSubmit:x})=>{const{addAddress:p,loading:h}=ot(),[o,c]=m.useState({}),[r,i]=m.useState({building_number:"",area:"",landmark:"",pincode:"",city:"",state:"",country:"",user_id:null,address_type:null});m.useEffect(()=>{d?g&&i(n=>({...n,user_id:g})):(i({building_number:"",area:"",landmark:"",pincode:"",city:"",state:"",country:"",user_id:null,address_type:null}),c({}))},[d,g]);const v=async n=>{n.preventDefault();try{await dt.validate(r,{abortEarly:!1}),g&&await p(r),x(!0),u()}catch(N){if(N instanceof Q){const A={};N.inner.forEach(D=>{A[D.path||""]=D.message}),c(A)}else y.error("Failed to submit the form. Please try again.")}};if(d)return e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:u}),e.jsxs("div",{className:"bg-white p-5 rounded-lg shadow-lg max-w-lg z-10 relative",children:[e.jsx("button",{className:"btn btn-sm btn-icon btn-light btn-outline absolute top-0 right-0 mr-5 mt-5 lg:mr-5 shadow-default",onClick:u,children:e.jsx("i",{className:"ki-filled ki-cross"})}),e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Add New Address"}),e.jsxs("form",{onSubmit:v,children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"building_number",className:"block text-gray-700 font-semibold",children:"Building Number"}),e.jsx("input",{type:"text",id:"building_number",name:"building_number",value:r.building_number,onChange:n=>i({...r,building_number:n.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"area",className:"block text-gray-700 font-semibold",children:"Area"}),e.jsx("input",{type:"text",id:"area",name:"area",value:r.area,onChange:n=>i({...r,area:n.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"landmark",className:"block text-gray-700 font-semibold",children:"Landmark"}),e.jsx("input",{type:"text",id:"landmark",name:"landmark",value:r.landmark,onChange:n=>i({...r,landmark:n.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pincode",className:"block text-gray-700 font-semibold",children:"Pin code"}),e.jsx("input",{type:"text",id:"pincode",name:"pincode",value:r.pincode,onChange:n=>i({...r,pincode:n.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:o.pincode||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city",className:"block text-gray-700 font-semibold",children:"City"}),e.jsx("input",{type:"text",id:"city",name:"city",value:r.city,onChange:n=>i({...r,city:n.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"state",className:"block text-gray-700 font-semibold",children:"State"}),e.jsx("input",{type:"text",id:"state",name:"state",value:r.state,onChange:n=>i({...r,state:n.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"country",className:"block text-gray-700 font-semibold",children:"Country"}),e.jsx("input",{type:"text",id:"country",name:"country",value:r.country,onChange:n=>i({...r,country:n.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"country",className:"block text-gray-700 font-semibold",children:"Address Type"}),e.jsxs("select",{className:"select select-lg text-sm",onChange:n=>i({...r,address_type:Number(n.target.value)}),children:[e.jsx("option",{value:"",selected:!0,disabled:!0,className:"badge-danger badge-outline",children:"Select Address Type"}),e.jsx("option",{value:"1",children:"Home"}),e.jsx("option",{value:"2",children:"Office"}),e.jsx("option",{value:"3",children:"Other"})]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:o.address_type||" "})]})]}),e.jsxs("div",{className:"flex justify-end mt-6",children:[e.jsx("button",{type:"button",onClick:u,className:"btn btn-light mr-2",disabled:h,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:h,className:`btn btn-primary ${h?"opacity-50 cursor-not-allowed":""}`,children:h?"Submitting...":"Submit"})]})]})]})]})},ct=({isOpen:d,onClose:u,setIsSubmit:g})=>{const{addUser:x,loading:p}=Ve(),h={first_name:"",last_name:"",email:"",password:"",mobile_number:"",gender:null,role_id:5},[o,c]=m.useState(h),[r,i]=m.useState({});m.useEffect(()=>{d||(c({first_name:"",last_name:"",email:"",password:"",mobile_number:"",gender:null,role_id:5}),i({}))},[d]);const v=async n=>{n.preventDefault();try{await Je().validate(o,{abortEarly:!1}),await x(o),g(!0),u()}catch(N){if(N instanceof Q){const A={};N.inner.forEach(D=>{A[D.path||""]=D.message}),i(A)}else y.error("Failed to submit the form. Please try again.")}};if(d)return e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:u}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-lg z-10 relative",children:[e.jsx("button",{className:"btn btn-sm btn-icon btn-light btn-outline absolute top-0 right-0 mr-5 mt-5 lg:mr-5 shadow-default",onClick:u,children:e.jsx("i",{className:"ki-filled ki-cross"})}),e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Add New Customer"}),e.jsxs("form",{onSubmit:v,children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"first_name",className:"block text-gray-700 font-semibold",children:"First name"}),e.jsx("input",{type:"text",id:"first_name",name:"first_name",value:o.first_name||"",onChange:n=>c({...o,first_name:n.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"text-red-500 text-sm",children:r.first_name||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"last_name",className:"block text-gray-700 font-semibold",children:"Last name"}),e.jsx("input",{type:"text",id:"last_name",name:"last_name",value:o.last_name,onChange:n=>c({...o,last_name:n.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"text-red-500 text-sm",children:r.last_name||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-gray-700 font-semibold",children:"Email"}),e.jsx("input",{type:"text",id:"email",name:"email",value:o.email,onChange:n=>c({...o,email:n.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"text-red-500 text-sm",children:r.email||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mobile_number",className:"block text-gray-700 font-semibold",children:"Mobile Number"}),e.jsx("input",{type:"text",id:"mobile_number",name:"mobile_number",value:o.mobile_number,onChange:n=>c({...o,mobile_number:n.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"text-red-500 text-sm",children:r.mobile_number||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-gray-700 font-semibold",children:"Password"}),e.jsx("input",{type:"password",id:"password",name:"password",value:o.password,onChange:n=>c({...o,password:n.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"text-red-500 text-sm",children:r.password||" "})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"mb-2 block text-gray-700 font-semibold",children:"Gender"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"gender",value:1,checked:o.gender===1,onChange:n=>c({...o,gender:parseInt(n.target.value)}),className:"radio radio-primary"}),e.jsx("span",{className:"text-sm",children:"Male"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"gender",value:2,checked:o.gender===2,onChange:n=>c({...o,gender:parseInt(n.target.value)}),className:"radio radio-primary"}),e.jsx("span",{className:"text-sm",children:"Female"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"gender",value:3,checked:o.gender===3,onChange:n=>c({...o,gender:parseInt(n.target.value)}),className:"radio radio-primary"}),e.jsx("span",{className:"text-sm",children:"Other"})]})]}),e.jsx("p",{className:"text-red-500 text-sm",children:r.gender||" "})]})]}),e.jsxs("div",{className:"flex justify-end mt-4",children:[e.jsx("button",{type:"button",onClick:u,className:"btn btn-light mr-2",disabled:p,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:p,className:`btn btn-primary ${p?"opacity-50 cursor-not-allowed":""}`,children:p?"Submitting...":"Submit"})]})]})]})]})},yt=()=>{const{prices:d}=Ge(),{categories:u}=Le(),{products:g,fetchProductsOnId:x}=Qe(),{services:p,fetchServicesOnId:h}=Ye(),[o,c]=m.useState(""),[r,i]=m.useState(!0),{id:v}=Ee(),{updateOrder:n,loading:N}=st(),{addOrder:A,loading:D}=tt(),T=Number(v),oe=1e3,de=1,[ie,Y]=m.useState(!1),[ce,K]=m.useState(!1),[W,B]=m.useState(!1),{users:z,fetchUsersByRole:ue}=Me(),{validCoupons:I,fetchValidCoupons:me}=Xe(),{branches:X}=Be(de,oe),{order:f,fetchOrder:pe}=ze(),{address:Z,fetchAddress:ee}=at(),{applyCoupon:he}=We(),{userData:M,fetchUser:xe}=He(),{transactionId:q,generatePaymentLink:be}=$e(),F=M==null?void 0:M.user,U=Ie(),[a,w]=m.useState({coupon_code:"",coupon_discount:null,express_delivery_charges:null,shipping_charges:null,payment_type:null,payment_status:null,sub_total:0,paid_amount:null,transaction_id:"",address_id:null,username:"",user_id:null,items:[{category_id:null,product_id:null,service_id:null,product_name:"",service_name:"",description:null,price:null,quantity:1,item_Total:null,showDescription:!1}],total:0,branch_id:null,order_status:null}),[ge,fe]=m.useState({coupon_code:"",coupon_discount:null,express_delivery_charges:null,shipping_charges:null,payment_type:null,payment_status:null,sub_total:0,paid_amount:null,transaction_id:"",address_id:null,username:"",user_id:null,items:[{category_id:null,product_id:null,service_id:null,product_name:"",service_name:"",description:null,price:null,quantity:1,item_Total:null,showDescription:!1}],total:0,branch_id:null,order_status:null}),[k,ye]=m.useState({});m.useEffect(()=>{(async()=>{await pe(T)})()},[T]),m.useEffect(()=>{(async()=>{a.user_id&&(await ee(a.user_id),await me(a.user_id),await xe(a.user_id)),W&&(await ee(a.user_id),B(!1))})()},[a.user_id,W]),m.useEffect(()=>{q&&w({...a,transaction_id:q})},[q]),m.useEffect(()=>{(async()=>{o&&r&&await ue(5,o)})()},[o,r]),m.useEffect(()=>{if(f){const t=`${f.user.first_name} ${f.user.last_name}`;c(t),i(!1);const l={coupon_code:f.coupon_code||"",coupon_discount:f.coupon_discount||null,express_delivery_charges:f.express_delivery_charges||null,shipping_charges:f.shipping_charges||null,payment_type:f.payment_type||null,payment_status:f.payment_status||null,sub_total:f.sub_total||0,paid_amount:f.paid_amount||null,transaction_id:f.transaction_id||"",address_id:f.address_id,username:t,user_id:f.user_id||null,items:f.items.map(s=>{var R,$,L,j;const b=s.category.category_id,C=((R=s.product)==null?void 0:R.product_id)||null,_=(($=s.service)==null?void 0:$.service_id)||null,J=((L=s.product)==null?void 0:L.name)||"",O=((j=s.service)==null?void 0:j.name)||"";return{category_id:b,product_id:C,service_id:_,product_name:J,service_name:O,description:s.description||null,price:s.price,quantity:s.quantity,item_Total:s.price*s.quantity,showDescription:!!s.description}}),total:(f.sub_total||0)+(f.express_delivery_charges||0)+(f.shipping_charges||0),branch_id:f.branch_id,order_status:f.order_status};w(l),fe(l)}},[f]);const _e=async t=>{t.preventDefault();try{const l=a.items.map(_=>({category_id:Number(_.category_id),product_id:Number(_.product_id),service_id:Number(_.service_id),description:_.description,price:Number(_.price),quantity:Number(_.quantity)})),s={...a,address_id:Number(a.address_id),coupon_discount:Number(a.coupon_discount),shipping_charges:Number(a.shipping_charges),paid_amount:Number(a.paid_amount),express_delivery_charges:Number(a.express_delivery_charges),payment_type:Number(a.payment_type),payment_status:Number(a.payment_status),items:l};if(await lt.validate(s,{abortEarly:!1}),!Object.keys(a).some(_=>a[_]!==ge[_])){U("/orders");return}let C;f?C=await n(T,s):C=await A(s),C&&U("/orders")}catch(l){if(l instanceof Q){const s={};l.inner.forEach(b=>{s[b.path||""]=b.message}),ye(s)}else y.error("Failed to submit the form. Please try again.")}},je=t=>{c(t.target.value),i(!0)},ve=t=>{const l=`${t.first_name} ${t.last_name}`;c(l),i(!1),w({...a,username:l,user_id:t.user_id})},Ne=()=>{U("/orders")},we=()=>{w(t=>({...t,items:[...t.items,{category_id:null,product_id:null,product_name:"",service_id:null,service_name:"",description:null,price:null,quantity:1,item_Total:null,showDescription:!1}]}))},ke=t=>{w(l=>{const s=l.items.filter((J,O)=>O!==t),b={...l,items:s,coupon_code:"",coupon_discount:0},C=V(b),_=C+Number(a.express_delivery_charges||0)+Number(a.shipping_charges||0);return{...b,sub_total:C,total:_}})},P=async(t,l,s)=>{["category_id","product_id","service_id","price","quantity"].includes(l)&&w(b=>({...b,coupon_code:"",coupon_discount:0})),w(b=>{const C=b.items.map(($,L)=>{if(L===t){const j={...$,[l]:s};l==="showDescription"&&(j.showDescription=s);const E=Number(j.category_id),G=Number(j.product_id),se=Number(j.service_id),ae=Number(j.quantity)||1;if(["category_id","product_id"].includes(l)&&(E&&x(E),G&&E&&h(E,G)),["category_id","product_id","service_id"].includes(l))if(E&&G&&se){const re=Ce(E,G,se);j.price=re,j.item_Total=re*ae}else j.price=null,j.item_Total=null;else l==="price"?j.item_Total=s*ae:l==="quantity"&&(j.item_Total=j.price*Number(s));return j}return $}),_={...b,items:C},O=V(_)-b.coupon_discount,R=O+Number(b.express_delivery_charges||0)+Number(b.shipping_charges||0);return{..._,sub_total:O,total:R}})},Ce=(t,l,s)=>{const b=`${t}_${l}_${s}`;return d[b]||0},Se=async t=>{const l=V(a),s=await he(a.user_id,l,t),b=Number(s.finalTotal||0)+Number(a.express_delivery_charges||0)+Number(a.shipping_charges||0);s&&w(C=>({...C,coupon_code:t,coupon_discount:s.discountAmount,sub_total:s.finalTotal,total:b}))},V=t=>t.items.reduce((l,s)=>l+(s.item_Total||0),0),te=(t,l)=>{w(s=>{const b={...s,[t]:l},C=Number(b.sub_total||0)+Number(b.express_delivery_charges||0)+Number(b.shipping_charges||0);return{...b,total:C}})},De=t=>{const l=t.target.value;w(s=>({...s,address_id:Number(l)}))},Te=t=>{t.preventDefault(),a.user_id?Y(!0):y.error("Please select the user to add address")},Pe=t=>{t.preventDefault(),K(!0)},Ae=()=>{U(`/order/${T}`)},Fe=async()=>{const t={amount:a.paid_amount,currency:"INR",user_id:a.user_id,customer:{name:a.username,mobile_number:Number(F==null?void 0:F.mobile_number),email:F==null?void 0:F.email}};await be(t)};return e.jsx("div",{className:"container-fixed",children:e.jsxs("div",{className:"card max-w-5xl mx-auto p-6 bg-white shadow-md",children:[e.jsxs("div",{className:"flex",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:f?"Edit Order":"Add Order"}),!isNaN(T)&&e.jsxs("button",{className:"btn bg-gray-200 ml-4 text-gray-700 text-sm font-bold rounded-md",onClick:Ae,children:[e.jsx(qe,{size:20}),"View Order"]})]}),e.jsxs("form",{onSubmit:_e,children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex flex-col flex-[0_0_40%]",children:[e.jsx("label",{htmlFor:"username",className:"block text-gray-700 text-sm font-bold mb-2",children:"Customer Name"}),e.jsx("input",{type:"text",id:"username",autoComplete:"off",value:o||"",onChange:je,className:"input border border-gray-300 rounded-md p-2 w-full mb-2",placeholder:"Search customer..."}),z&&o&&r&&e.jsx("ul",{className:"absolute mt-20 bg-white z-10 border border-gray-300 rounded-md p-2 w-full text-sm",children:z.length>0?z.map(t=>e.jsxs("li",{className:"p-2 hover:bg-gray-100 cursor-pointer",onClick:()=>ve(t),children:[t.first_name," ",t.last_name," (",t.mobile_number,")"]},t.user_id)):e.jsx("li",{className:"p-2 text-gray-500",children:"No users found"})}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.username||" "})]}),e.jsx("div",{className:"flex flex-col self-center",children:e.jsx("button",{className:"btn btn-primary w-[88px]",onClick:Pe,children:"New Customer"})}),e.jsxs("div",{className:"grow flex",children:[e.jsxs("div",{className:"grow flex flex-col",children:[e.jsx("label",{htmlFor:"address",className:"block text-gray-700 text-sm font-bold mb-2",children:"Customer Address"}),e.jsxs("select",{id:"address",value:a.address_id??"",onChange:De,className:"select border border-gray-300 rounded-md p-2 w-full text-sm",children:[e.jsx("option",{value:"",disabled:!0,children:"Select Address"}),Z.length>0?Z.map(t=>e.jsxs("option",{value:t.address_id,children:[t.building_number,", ",t.area,", ",t.landmark,","," ",t.city,", ",t.state,",",t.country,", ",t.pincode]},t.address_id)):e.jsx("option",{children:"No Address available"})]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.address_id||" "})]}),e.jsx("div",{className:"flex flex-col self-center",children:e.jsx("button",{className:"btn btn-primary w-20 ml-2",onClick:Te,children:"Add address"})})]})]}),e.jsx("div",{children:e.jsx("h1",{className:"text-xl font-semibold leading-none text-gray-900 mt-10 mb-5",children:"Item"})}),a.items.map((t,l)=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-start md:flex-row md:items-end md:space-x-1",children:[e.jsxs("div",{className:"flex flex-col flex-1 md:mb-0",children:[e.jsx("label",{htmlFor:"category",className:"block text-gray-700 text-sm font-bold mb-2",children:"Category"}),e.jsxs("select",{id:"category",value:t.category_id??"",onChange:s=>P(l,"category_id",s.target.value),className:"select border border-gray-300 rounded-md p-2 w-full text-sm",children:[e.jsx("option",{value:"",disabled:!0,children:"Select Category"}),u.map(s=>e.jsx("option",{value:s.category_id,children:s.name},s.category_id))]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k[`items[${l}].category_id`]})]}),e.jsxs("div",{className:"flex flex-col flex-1 md:mb-0",children:[e.jsx("label",{htmlFor:"product",className:"block text-gray-700 text-sm font-bold mb-2",children:"Product"}),e.jsxs("select",{id:"product",value:t.product_id??"",onChange:s=>P(l,"product_id",s.target.value),className:"select border border-gray-300 rounded-md p-2 w-full text-sm",children:[e.jsx("option",{value:"",disabled:!0,children:"Select Product"}),g&&g.length>0?g.map(s=>e.jsx("option",{value:s.product_product_id,children:s.product_name},s.product_product_id)):t.product_id&&e.jsx("option",{value:t.product_id,children:t.product_name},t.product_id)]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k[`items[${l}].product_id`]})]}),e.jsxs("div",{className:"flex flex-col flex-1 md:mb-0",children:[e.jsx("label",{htmlFor:"service",className:"block text-gray-700 text-sm font-bold mb-2",children:"Service"}),e.jsxs("select",{id:"service",value:t.service_id??"",onChange:s=>P(l,"service_id",s.target.value),className:"select border border-gray-300 rounded-md p-2 w-full text-sm",children:[e.jsx("option",{value:"",disabled:!0,children:"Select Service"}),p&&p.length>0?p.map(s=>e.jsx("option",{value:s.service_service_id,children:s.service_name},s.service_service_id)):t.service_id&&e.jsx("option",{value:t.service_id,children:t.service_name},t.service_id)]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k[`items[${l}].service_id`]})]}),e.jsxs("div",{className:"flex flex-col flex-1",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Price"}),e.jsx("input",{type:"text",value:t.price||"",onChange:s=>P(l,"price",s.target.value),className:`input border rounded-md p-2 w-full ${isNaN(T)?"border-gray-300 bg-gray-100 text-sm text-gray-600 cursor-not-allowed focus:outline-none":"border-gray-300"}`,readOnly:isNaN(T)}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k[`items[${l}].price`]})]}),e.jsxs("div",{className:"flex flex-col flex-1 md:mb-0",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Quantity"}),e.jsx("input",{type:"text",value:t.quantity??1,onChange:s=>P(l,"quantity",s.target.value),className:"input border border-gray-300 rounded-md p-2 w-full"})]}),e.jsxs("div",{className:"flex flex-col flex-1 md:mb-0",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Item total"}),e.jsx("input",{type:"text",value:t.item_Total??"",onChange:s=>P(l,"item_Total",s.target.value),min:"0",step:"0.01",readOnly:!0,className:"input border border-gray-300 bg-gray-100 text-sm text-gray-600 rounded-md p-2 cursor-not-allowed focus:outline-none"})]}),e.jsxs("div",{className:"flex flex-col md:mb-0",children:[e.jsx("label",{htmlFor:"description_checkbox",className:"block text-gray-700 text-sm font-bold mb-2",children:"Description"}),e.jsx("input",{className:"checkbox checkbox-lg m-auto mt-2",id:"description_checkbox","data-datatable-check":"true",type:"checkbox",checked:t.showDescription,onChange:s=>P(l,"showDescription",s.target.checked)}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:" "})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{type:"button",className:`p-2 mt-8 rounded-full ${a.items.length>1?"bg-red-100 hover:bg-red-200":"bg-gray-200 cursor-not-allowed"}`,onClick:()=>ke(l),disabled:a.items.length===1,children:e.jsx(Ue,{className:`${a.items.length>1?"text-red-500":"text-gray-400"}`})})})]},l),t.showDescription&&e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col w-[500px] mb-8",children:[e.jsx("label",{htmlFor:"description",className:"block text-gray-700 text-sm font-bold mb-2",children:"Description"}),e.jsx("textarea",{id:"description",value:t.description||"",onChange:s=>P(l,"description",s.target.value),className:"h-20 input border border-gray-300 rounded-md p-2 w-full"})]})})]})),e.jsx("button",{type:"button",onClick:we,className:"btn btn-secondary mb-6",children:"Add Item"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Coupon Code"}),e.jsxs("select",{id:"coupon_code",className:"select border border-gray-300 rounded-md p-2 w-full text-sm",value:a.coupon_code??"",onChange:t=>{const l=I.find(s=>s.code===t.target.value);Se(l==null?void 0:l.code)},children:[e.jsx("option",{value:"",disabled:!0,children:"Select Coupon Code"}),I&&I.length>0?I.map(t=>e.jsx("option",{value:t.code,children:t.code},t.coupon_id)):e.jsx("option",{children:"No Coupons available"})]}),e.jsx("p",{className:"text-red-500 text-sm",children:k.coupon_code||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Coupon Discount"}),e.jsx("input",{type:"text",value:a.coupon_discount||"",readOnly:!0,className:"input border border-gray-300 bg-gray-100 text-sm text-gray-600 rounded-md p-2 cursor-not-allowed focus:outline-none"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.coupon_discount||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"express_delivery_charges",className:"block text-gray-700 text-sm font-bold mb-2",children:"Express Delivery Charges"}),e.jsx("input",{type:"text",id:"express_delivery_charges",min:"0",value:a.express_delivery_charges||"",onChange:t=>te("express_delivery_charges",t.target.value),className:"input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.express_delivery_charges||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"shipping_charges",className:"block text-gray-700 text-sm font-bold mb-2",children:"Shipping Charges"}),e.jsx("input",{type:"text",id:"shipping_charges",min:"0",value:a.shipping_charges||"",onChange:t=>te("shipping_charges",t.target.value),className:"input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.shipping_charges||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Sub Total"}),e.jsx("input",{type:"text",value:a.sub_total||"",readOnly:!0,className:"input border border-gray-300 bg-gray-100 text-sm text-gray-600 rounded-md p-2 cursor-not-allowed focus:outline-none"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.sub_total||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Total"}),e.jsx("input",{type:"text",value:a.total||"",readOnly:!0,className:"input border border-gray-300 bg-gray-100 text-sm text-gray-600 rounded-md p-2 cursor-not-allowed focus:outline-none"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"paid_amount",className:"block text-gray-700 text-sm font-bold mb-2",children:"Paid amount"}),e.jsx("input",{type:"text",id:"paid_amount",value:a.paid_amount||"",onChange:t=>{w({...a,paid_amount:Number(t.target.value)})},className:"input border border-gray-300 rounded-md p-2",min:"0",step:"0.01"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.paid_amount||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"payment_method",className:"block text-gray-700 text-sm font-bold mb-2",children:"Payment Method"}),e.jsxs("select",{className:"select border border-gray-300 rounded-md p-2 w-full text-sm",id:"payment_method",value:a.payment_type??"",onChange:t=>w({...a,payment_type:Number(t.target.value)}),children:[e.jsx("option",{value:"",disabled:!0,children:"Select Payment Type"}),e.jsx("option",{value:1,children:"Cash on Delivery"}),e.jsx("option",{value:2,children:"Online Payment"})]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.payment_type||" "}),!T&&a.payment_type===2&&e.jsx("div",{children:e.jsxs("button",{className:"-mt-2 badge text-sm badge-info badge-outline",onClick:Fe,children:[e.jsx(Re,{color:"blue"}),"  "," Send Payment Link"]})})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"payment_status",className:"block text-gray-700 text-sm font-bold mb-2",children:"Payment Status"}),e.jsxs("select",{className:"select border border-gray-300 rounded-md p-2 w-full text-sm",id:"payment_status",value:a.payment_status??"",onChange:t=>w({...a,payment_status:Number(t.target.value)}),children:[e.jsx("option",{value:"",disabled:!0,children:"Select Payment Status"}),e.jsx("option",{value:1,children:"Pending"}),e.jsx("option",{value:2,children:"Received"}),e.jsx("option",{value:3,children:"Partial Received"})]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.payment_status||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"transaction_id",className:"block text-gray-700 text-sm font-bold mb-2",children:"Transaction ID"}),e.jsx("input",{type:"text",id:"transaction_id",value:q||"",className:"input border border-gray-300 bg-gray-100 text-sm text-gray-600 rounded-md p-2 cursor-not-allowed focus:outline-none",readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"payment_status",className:"block text-gray-700 text-sm font-bold mb-2",children:"Branch"}),e.jsxs("select",{id:"company_id",className:"select border border-gray-300 rounded-md p-2 w-full text-sm",value:a.branch_id||"",onChange:t=>w({...a,branch_id:t.target.value?Number(t.target.value):null}),children:[e.jsx("option",{value:"",disabled:!0,children:"Select Branch"}),X.length>0?X.map(t=>e.jsx("option",{value:t.branch_id,children:t.branch_name},t.branch_id)):e.jsx("option",{children:"No Data Available"})]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.branch_id||" "})]}),!T&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"payment_method",className:"block text-gray-700 text-sm font-bold mb-2",children:"Item status"}),e.jsxs("select",{className:"select border border-gray-300 rounded-md p-2 w-full text-sm",id:"item_status",value:a.order_status??null,onChange:t=>w({...a,order_status:Number(t.target.value)}),children:[e.jsx("option",{value:"",disabled:!0,selected:!0,children:"Select item status"}),e.jsx("option",{value:4,children:"Received at branch"}),e.jsx("option",{value:1,children:"Need to pickup"})]})]})]}),e.jsxs("div",{className:"mt-6 flex gap-4",children:[e.jsx("button",{type:"submit",className:`btn btn-primary ${D||N?"opacity-50 cursor-not-allowed":""}`,disabled:D||N,children:D||N?D?"Adding...":"Updating...":T?"Update Order":"Add Order"}),e.jsx("button",{type:"button",onClick:Ne,className:"btn btn-secondary",disabled:D||N,children:"Cancel"})]})]}),e.jsx(it,{isOpen:ie,setIsSubmit:B,onClose:()=>Y(!1),userId:a.user_id}),e.jsx(ct,{isOpen:ce,setIsSubmit:B,onClose:()=>K(!1)})]})})};export{yt as default};
