import{r as i,B as $,V as x,G as X,j as e,a as U,b as G,d as ee,p as Q,q as ls,g as is,e as rs,H as cs,m as ds,W as os,L as ms,X as us,Y as xs,Z as hs,$ as ps,k as K,a0 as fs,f as gs}from"./index-uvtpSlnJ.js";import{u as bs}from"./useGetOrder-D7ejtb8K.js";import{u as ys}from"./useGenerateInvoice-DoU9SeKO.js";import{S as L}from"./sweetalert2.esm.all-B0Dix5B2.js";import{u as js,a as Ns,P as _s,W as vs,D as ws}from"./DueDetailsModel-CxGZCW-Y.js";import{g as Be}from"./orderStatusClasses-HfHBGnti.js";import{a as ks}from"./index-CCZeNAcG.js";import{g as Cs}from"./paymentStatusClasses-BddHAg9R.js";import"./useGetWorkshops-B3a9KuIG.js";const Ss=()=>{const[r,a]=i.useState(!1),u=localStorage.getItem("authToken");return{cancelOrder:async o=>{a(!0);try{const l=await fetch(`${$}/orders/cancel`,{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-type":"application/json"},body:JSON.stringify(o)}),d=await l.json();return l.ok?(x.success(d.message,{position:"top-center"}),!0):(x.error(d.message,{position:"top-center"}),!1)}catch(l){x.error((l==null?void 0:l.message)||"Error in cancelling order",{position:"top-center"})}finally{a(!1)}},loading:r}},Os=()=>{const[r,a]=i.useState(!1),u=localStorage.getItem("authToken");return{refundOrder:async o=>{a(!0);try{const l=await fetch(`${$}/refund`,{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-type":"application/json"},body:JSON.stringify(o)}),d=await l.json();return l.ok?(x.success(d.message,{position:"top-center"}),!0):(x.error(d.message,{position:"top-center"}),!1)}catch(l){x.error((l==null?void 0:l.message)||"Network Error : Fail to refund order",{position:"top-center"})}finally{a(!1)}},loading:r}},Ds="http://35.154.167.170:3000/notes",Rs=()=>{const[r,a]=i.useState(!1);return{addNote:async s=>{const o=localStorage.getItem("authToken");a(!0);try{const l=await fetch(Ds,{method:"POST",headers:{Authorization:`Bearer ${o}`},body:s}),d=await l.json();return l.ok?(x.success(d.message,{position:"top-center"}),!0):(x.error(d.message,{position:"top-center"}),!1)}catch(l){return x.error((l==null?void 0:l.message)||"Error adding note",{position:"top-center"}),!1}finally{a(!1)}},loading:r}},Ps=()=>{const[r,a]=i.useState(!1);return{deleteNote:async s=>{const o=localStorage.getItem("authToken"),l=`http://35.154.167.170:3000/notes/${s}`;a(!0);try{const d=await fetch(l,{method:"DELETE",headers:{Authorization:`Bearer ${o}`}}),h=await d.json();return d.ok?{success:!0,message:h.message}:(x.error(h.message,{position:"top-center"}),{success:!1,message:h.message})}catch(d){return{success:!1,message:d.message}}finally{a(!1)}},loading:r}},Bs=()=>{const[r,a]=i.useState(!1);return{updateOrderStatus:async(s,o)=>{const l=localStorage.getItem("authToken");a(!0);try{const d=await fetch(`${$}/admin/orders/update-status`,{method:"PATCH",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify({order_ids:[s],order_status:o})}),h=await d.json();return d.ok?(x.success(h.message,{position:"top-center"}),!0):(x.error(h.message,{position:"top-center"}),!1)}catch{return x.error("Failed to update order status"),!1}finally{a(!1)}},loading:r}};function Es(r){return X({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M10 11H7.101l.001-.009a4.956 4.956 0 0 1 .752-1.787 5.054 5.054 0 0 1 2.2-1.811c.302-.128.617-.226.938-.291a5.078 5.078 0 0 1 2.018 0 4.978 4.978 0 0 1 2.525 1.361l1.416-1.412a7.036 7.036 0 0 0-2.224-1.501 6.921 6.921 0 0 0-1.315-.408 7.079 7.079 0 0 0-2.819 0 6.94 6.94 0 0 0-1.316.409 7.04 7.04 0 0 0-3.08 2.534 6.978 6.978 0 0 0-1.054 2.505c-.028.135-.043.273-.063.41H2l4 4 4-4zm4 2h2.899l-.001.008a4.976 4.976 0 0 1-2.103 3.138 4.943 4.943 0 0 1-1.787.752 5.073 5.073 0 0 1-2.017 0 4.956 4.956 0 0 1-1.787-.752 5.072 5.072 0 0 1-.74-.61L7.05 16.95a7.032 7.032 0 0 0 2.225 1.5c.424.18.867.317 1.315.408a7.07 7.07 0 0 0 2.818 0 7.031 7.031 0 0 0 4.395-2.945 6.974 6.974 0 0 0 1.053-2.503c.027-.135.043-.273.063-.41H22l-4-4-4 4z"},child:[]}]})(r)}function As(r){return X({attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor"},child:[]}]})(r)}function Ls(r){return X({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M355.9 161.1c-8.6 0-15.6 7-15.6 15.6v194.4c0 20.3-8 40.4-22 55.1-13.9 14.6-35.2 23.7-55.5 23.7h-13.6c-19.6 0-39.5-8.9-54.8-24.6-15.2-15.5-23.9-35.6-23.9-55.2V119.3c0-14.9 6.2-28.9 17.3-39.5 11.1-10.5 25.7-16.3 41-16.3 15.1 0 29.3 5.8 39.8 16.2 10.5 10.5 16.4 24.6 16.4 39.6v234.2c0 17.1-13.6 32.2-29 32.2-13.6 0-28.2-12.9-28.2-32.2V219.9c0-8.6-7-15.6-15.6-15.6s-15.6 7-15.6 15.6v133.6c0 35.5 25.5 62.3 59.4 62.3 16.5 0 31.7-6.1 42.7-17.3 11.3-11.4 17.5-27.4 17.5-45V119.3c0-23.4-9.1-45.4-25.7-61.8C274 41 252 32 228.5 32s-45.5 9-62.2 25.5c-16.7 16.5-25.9 38.4-25.9 61.9v250.8c0 28.7 12.2 57.9 32.6 78 20.9 20.6 47.9 31.9 76.1 31.9h13.6c27.6 0 55.3-11.7 75.9-32.1 10.2-10.1 18.2-21.7 23.9-34.6 5.9-13.5 8.9-27.7 8.9-42.1V176.7c.1-8.6-6.9-15.6-15.5-15.6z"},child:[]}]})(r)}const Is=U().shape({text_note:ee().required("Please enter text to add note")}),Ts=({onClose:r,orderCancelModalOpen:a,orderId:u,setRefetch:s})=>{const{cancelOrder:o,loading:l}=Ss(),[d,h]=i.useState(""),_=JSON.parse(localStorage.getItem("user")),N=_==null?void 0:_.user_id,[m,g]=i.useState({user_id:N,order_id:u,text_note:""});i.useEffect(()=>{a?g({user_id:N,order_id:u,text_note:""}):(g({user_id:null,order_id:null,text_note:""}),h(""))},[a]);const S=async j=>{j.preventDefault();try{await Is.validate(m,{abortEarly:!1}),await o(m)&&(h(""),r(),s(!0))}catch(f){f instanceof G?h(f.errors[0]):x.error("Failed to Cancel Order")}};if(a)return e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50 p-5",children:[e.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:r}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-[450px] z-10 relative",children:[e.jsx("button",{className:"btn btn-sm btn-icon btn-light btn-outline absolute top-0 right-0 mr-5 mt-5 lg:mr-5 shadow-default","data-modal-dismiss":"true",onClick:r,children:e.jsx("i",{className:"ki-filled ki-cross"})}),e.jsxs("h1",{className:"text-xl font-semibold text-gray-900",children:["Cancel Order #",u]}),e.jsxs("div",{className:"mt-2 py-3",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-700 mb-4",children:"Reason for Cancellation"}),e.jsxs("div",{children:[e.jsx("textarea",{className:"h-20 input border border-gray-300 rounded-md p-2",rows:5,placeholder:"Write a text note...",value:m.text_note||"",onChange:j=>g({...m,text_note:j.target.value})}),e.jsx("p",{className:"text-red-500 text-sm",children:d||" "})]})]}),e.jsx("button",{type:"submit",className:`btn btn-primary ${l?"opacity-50 cursor-not-allowed":""}`,onClick:S,disabled:l,children:l?"Cancelling.":"Submit"}),e.jsx("button",{type:"button",className:"btn btn-light ml-2",onClick:r,children:"Cancel"})]})]})},$s=U().shape({refund_description:ee().required("Please enter text to add description"),refund_amount:Q().required("Refund amount is required").typeError("Refund amount must be a number").min(0,"Refund amount must be a positive number").test("max-refund","Refund amount cannot be greater than the paid amount",function(r){var a;return r!==void 0&&r<=((a=this.options.context)==null?void 0:a.PaidAmount)}),refund_status:Q().required("Please choose refund status").test("required","Please choose refund status",r=>!!r)}),Ms=({orderRefundModalOpen:r,onClose:a,orderId:u,TotalAmount:s,PaidAmount:o,setRefetch:l})=>{const{refundOrder:d,loading:h}=Os(),[_,N]=i.useState({}),[m,g]=i.useState({order_id:u,refund_amount:null,refund_status:null,refund_description:""});i.useEffect(()=>{r?g({order_id:u,refund_amount:null,refund_status:null,refund_description:""}):(g({order_id:u,refund_amount:null,refund_status:null,refund_description:""}),N({}))},[r]);const S=async j=>{j.preventDefault();try{await $s.validate(m,{abortEarly:!1,context:{PaidAmount:o}});const f={...m,refund_amount:Number(m.refund_amount)};await d(f)&&(a(),l(!0))}catch(f){if(f instanceof G){const y={};f.inner.forEach(k=>{y[k.path||""]=k.message}),N(y)}else x.error("Failed to submit the form. Please try again.")}};if(r)return e.jsxs("div",{className:"fixed inset-0 grid overflow-auto items-center justify-center z-50 p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:a}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg min-w-[440px] smobile:min-w-[85%] z-10 relative",children:[e.jsx("button",{className:"btn btn-sm btn-icon btn-light btn-outline absolute top-0 right-0 mr-5 mt-5 lg:mr-5 shadow-default","data-modal-dismiss":"true",onClick:a,children:e.jsx("i",{className:"ki-filled ki-cross"})}),e.jsxs("h1",{className:"text-xl font-semibold text-gray-900 mb-4",children:["Refund Order #",u]}),e.jsxs("div",{className:"flex flex-col p-2",children:[e.jsxs("span",{className:"text-gray-700 text-sm font-medium py-1",children:["Total Amount : ₹",s]}),e.jsxs("span",{className:"text-gray-700 text-sm font-medium py-1",children:["Paid Amount : ₹",o]})]}),e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"flex flex-col mb-2",children:[e.jsx("label",{htmlFor:"refund_amount",className:"block text-gray-700 text-sm font-bold mb-2",children:"Refund Amount"}),e.jsx("input",{type:"text",id:"refund_amount",min:"0",value:m.refund_amount||"",onChange:j=>g({...m,refund_amount:j.target.value}),className:"input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"text-red-500 text-sm",children:_.refund_amount||" "})]}),e.jsxs("div",{className:"flex flex-col mb-2",children:[e.jsx("label",{className:"block text-gray-700 text-base font-bold mb-2",htmlFor:"refund_description",children:"Reason of Refund (Refund Note)"}),e.jsx("textarea",{id:"refund_description",name:"refund_description",value:m.refund_description,onChange:j=>g({...m,refund_description:j.target.value}),className:"h-20 input border border-gray-300 rounded-md p-2",rows:5}),e.jsx("p",{className:"text-red-500 text-sm",children:_.refund_description||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-gray-700 text-base font-bold mb-2",htmlFor:"refund_status",children:"Refund Status"}),e.jsxs("select",{id:"refund_status",className:"select select-lg w-[200px] text-sm",value:m.refund_status||"",onChange:j=>g({...m,refund_status:Number(j.target.value)}),children:[e.jsx("option",{value:"",disabled:!0,selected:!0,children:"Select Refund Status"}),e.jsx("option",{value:1,children:"Full"}),e.jsx("option",{value:2,children:"Partial"})]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:_.refund_status||" "})]})]}),e.jsx("button",{type:"submit",className:`btn btn-primary ${h?"opacity-50 cursor-not-allowed":""}`,onClick:S,disabled:h,children:h?"Submitting...":"Submit"}),e.jsx("button",{type:"button",className:"btn btn-light ml-2",onClick:a,children:"Cancel"})]})]})},Fs=()=>{const[r,a]=i.useState(!1),[u,s]=i.useState(null),o=async(l="")=>{const h=localStorage.getItem("authToken"),_="http://35.154.167.170:3000/user/by-role?role_id=4",N=new URLSearchParams;l&&N.append("search",l);try{a(!0);const m=await fetch(`${_}&${N}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`}});if(!m.ok){const S=await m.json();x.error(S.message,{position:"top-center"});return}const g=await m.json();s(g==null?void 0:g.data)}catch(m){x.error((m==null?void 0:m.message)||"Network error: Failed to fetch.",{position:"top-center"})}finally{a(!1)}};return i.useEffect(()=>{o()},[]),{users:u,loading:r,fetchDeliveryPickupBoys:o}},zs=U().shape({boy_id:Q().required("Please select a name to assign")}),Us=({order:r,setModelOpen:a,setAssigned:u})=>{const{order_id:s,order_status:o,pickup_boy:l,pickup_boy_id:d,delivery_boy_id:h,delivery_boy:_}=r,N=o===2,{users:m,loading:g,fetchDeliveryPickupBoys:S}=Fs(),{assignPickupBoy:j,loading:f}=js(),{assignDeliveryBoy:y,loading:k}=Ns(),[Y,I]=i.useState(N?l.pickup_boy_name:_.delivery_boy_name),[W,R]=i.useState(!1),[O,M]=i.useState({order_id:s,boy_id:N?d:h,comment:""}),[q,F]=i.useState(""),T=i.useRef(null),B=i.useRef(null),[se,E]=i.useState(!1),[te,V]=i.useState(!1),ae=c=>{S(c.target.value),I(c.target.value)},H=c=>{const C=`${c.first_name} ${c.last_name}`;I(C),R(!1),M({...O,boy_id:c.user_id})};i.useEffect(()=>{const c=C=>{T.current&&!T.current.contains(C.target)&&B.current&&!B.current.contains(C.target)&&(R(!1),E(!1))};return document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c)}},[]);const J=async()=>{try{if(await zs.validate(O,{abortEarly:!1}),N){const c={order_ids:[O.order_id],pickup_boy_id:O.boy_id};d===c.pickup_boy_id?v():await j(c)&&(u(!0),v())}else{const c={order_ids:[O.order_id],delivery_boy_id:O.boy_id};h===c.delivery_boy_id?v():await y(c)&&(u(!0),v())}}catch(c){c instanceof G&&F(c.errors[0])}},v=()=>{a(!1)};return e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:v}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-[400px] z-10 relative",children:[!m&&g&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-10 grid place-items-center z-[100]",children:e.jsxs("span",{className:"flex justify-center items-center gap-2 px-3 py-2 bg-white rounded",children:[e.jsx("span",{className:"inline-block h-6 w-6 rounded-full border-4 border-primary !border-t-black/5 animate-spin"}),e.jsx("span",{className:"text-gray-500 text-sm font-semibold",children:"Loading..."})]})}),e.jsx("button",{className:"btn btn-sm btn-icon btn-light btn-outline absolute top-0 right-0 mr-5 mt-5 lg:mr-5 shadow-default",onClick:v,children:e.jsx("i",{className:"ki-filled ki-cross"})}),e.jsx("h2",{className:"text-2xl font-bold mb-6",children:N?"Update Pickup Boy":"Update Delivery Boy"}),e.jsxs("div",{children:[e.jsxs("form",{className:"relative flex flex-col flex-[0_0_40%]",onSubmit:c=>c.preventDefault(),children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-1",children:"Name"}),e.jsx("label",{className:"input input-sm h-10 flex items-center gap-2",children:e.jsx("input",{type:"search",ref:B,autoComplete:"off",value:Y,placeholder:"Search...",className:"min-w-[185px] text-sm",onChange:ae,onFocus:()=>{E(!0),R(!0)}})}),m&&W&&e.jsx("ul",{ref:T,className:"absolute mt-[64px] bg-white z-10 border border-gray-300 rounded-md p-2 w-full text-sm",children:m.length>0?m.map(c=>e.jsxs("li",{className:`p-2 hover:bg-gray-200 cursor-pointer rounded ${O.boy_id===c.user_id?"bg-gray-200":""}`,onClick:()=>H(c),children:[c.first_name," ",c.last_name," (",c.mobile_number,")"]},c.user_id)):e.jsx("li",{className:"p-2 text-gray-500",children:"No users found"})}),e.jsx("p",{className:"text-red-500 text-sm mt-1",children:q||" "})]}),e.jsxs("div",{className:"flex mt-4",children:[e.jsx("button",{type:"button",className:"btn btn-primary mr-2",onClick:J,disabled:f||k,children:"Assign"}),e.jsx("button",{type:"button",onClick:v,className:"btn btn-light",children:"Cancel"})]})]})]})]})},Gs=()=>{const[r,a]=i.useState(),u=localStorage.getItem("authToken");return{reGenerateInvoice:async o=>{a(!0);try{const l=await fetch(`${$}/pdf/invoice/${o}?regenerate=true`,{method:"GET",headers:{Authorization:`Bearer ${u}`}}),d=await l.json();l.ok?x.success("Invoice updated successfully"):x.error((d==null?void 0:d.message)||"Failed to updated invoice")}catch{x.error("An error occurred while updateding the invoice!")}finally{a(!1)}},loading:r}},Ys=U().shape({text_note:ee().required("Please enter text to add note")}),et=()=>{var ie,re,ce,de,oe,me,ue,xe,he,pe,fe,ge,be,ye,je,Ne,_e,ve,we,ke,Ce,Se,Oe,De;const{id:r}=ls(),a=Number(r),u=is(t=>t.user.user_id),{order:s,fetchOrder:o,loading:l}=bs(),{addNote:d,loading:h}=Rs(),{deleteNote:_}=Ps(),{updateOrderStatus:N}=Bs(),{generateInvoice:m,loading:g}=ys(),{reGenerateInvoice:S,loading:j}=Gs(),{hasPermission:f}=rs(),[y,k]=i.useState({user_id:null,order_id:null,text_note:"",images:[],is_visible:!0}),[Y,I]=i.useState(!1),[W,R]=i.useState(!1),[O,M]=i.useState(!1),[q,F]=i.useState(!1),[T,B]=i.useState(!1),[se,E]=i.useState(!1),[te,V]=i.useState(""),[ae,H]=i.useState(!1),[J,v]=i.useState(!1),c=cs(),C=ds(),ne=i.useRef(null),[Ee,le]=i.useState(!1),[Ae,z]=i.useState(!1);i.useEffect(()=>{o(a),E(!1),v(!1)},[se,J]),i.useEffect(()=>{s&&k(t=>({...t,user_id:s.user_id,order_id:s.order_id}))},[s]);const Le=t=>{const n=t.target;if(n instanceof HTMLInputElement){const{name:b,value:p,files:w}=n;b==="images"&&w&&w.length>0?k(P=>({...P,images:[...P.images,...Array.from(w)]})):k(P=>({...P,[b]:p}))}},Ie=async t=>{try{const{isConfirmed:n}=await L.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel"});if(n){const{success:b,message:p}=await _(t);b?(await o(a),L.fire(p)):L.fire(p)}}catch(n){L.fire({title:"Error",text:n.message,icon:"error"})}},Te=()=>{var t;(t=ne.current)==null||t.click()},$e=t=>{k(n=>({...n,images:n.images.filter((b,p)=>p!==t)}))},Me=async t=>{t.preventDefault();try{await Ys.validate(y,{abortEarly:!1});const n=new FormData;n.append("user_id",u.toString()),n.append("order_id",y.order_id),n.append("text_note",y.text_note),n.append("is_visible",y.is_visible.toString()),y.images&&y.images.length>0&&y.images.forEach(p=>{n.append("images",p)}),await d(n)&&(k({user_id:null,order_id:null,text_note:"",images:[],is_visible:!0}),V(""),await o(y.order_id))}catch(n){n instanceof G?V(n.errors[0]):x.error("Failed to add note")}},Fe=async()=>{try{const{isConfirmed:t}=await L.fire({title:"Are you sure?",html:`Want to change order status to <span style="color: #4e00ff; font-weight: 500;">"${s.order_status_details.next_step}"</span> ?`,showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Yes",cancelButtonText:"No"});return t}catch(t){return L.fire({title:"Error",text:t.message,icon:"error"}),!1}},ze=async t=>{await N(a,t)&&await o(a)},D=async t=>{await Fe()&&await ze(t)},Ue=async()=>{var t,n;switch((t=s==null?void 0:s.order_status_details)==null?void 0:t.next_step){case"Assign Pickup Boy":R(!0);break;case"Assign Delivery boy":R(!0);break;case"Received by pickup boy":await D(3);break;case"Order Received at Workshop":await D(6);break;case"Workshop Marks Order In Progress":await D(7);break;case"Work Completed by Workshop":await D(8),((n=c.state)==null?void 0:n.from)==="WorkshopOrderTable"&&C("/workshop-order");break;case"Mark as Received at Branch":await D(9);break;case"Items Received at Branch":case"Pickup Complete":await D(4);break;case"Ready For Delivery":await D(10);break;case"Delivered":z(!0);break;case"Assign Workshop":case"Assign Branch":M(!0);break;case"Branch Received Items":await D(8),H(!1);break}},Ge=async()=>{await Ue()},Ye=()=>{C(`/order/edit/${a}`,{state:{prevUrl:c.pathname}})},We=()=>{F(!0)},qe=()=>{B(!0)},Ve=async()=>{var t;if((s==null?void 0:s.order_invoice)!==""){const n=(t=s==null?void 0:s.order_invoice)==null?void 0:t.fileUrl;window.open(n,"_blank")}else await m(a),v(!0)},He=t=>{C(`/customer/${t}`)},Je=Be((ie=s==null?void 0:s.order_status_details)==null?void 0:ie.admin_label),Ze=Be((re=s==null?void 0:s.order_status_details)==null?void 0:re.next_step),Ke=os[s==null?void 0:s.payment_status],Qe=t=>{const n=s==null?void 0:s.order_label[t];window.open(n,"_blank")},Xe=()=>{const t=s==null?void 0:s.general_order_label;window.open(t,"_blank")},es=()=>{var n;const t=(n=s==null?void 0:s.refund_receipt_url)==null?void 0:n.fileUrl;window.open(t,"_blank")},ss=()=>{I(!0)},ts=async()=>{z(!0)},as=()=>{S(s.order_id)},ns=async(t,n)=>{const b=localStorage.getItem("authToken");le(!0);try{const p=await fetch(`${$}/notes/${t}`,{method:"PUT",headers:{Authorization:b?`Bearer ${b}`:"","Content-type":"application/json"},body:JSON.stringify({is_visible:n})}),w=await p.json();return p.ok?(await o(a),x.success(w.message||"Visibility updated"),!0):(x.error(w.message||"Failed to update note visibility"),!1)}catch{return x.error("Network Error: Failed to update note visibility"),!1}finally{le(!1)}},A=(t,n)=>{const b=t.find(p=>(p==null?void 0:p.type)===n);return!t.length||!n||!b?"":`${b.user.first_name} ${b.user.last_name}`};return l?e.jsx(ms,{}):s?e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"card rounded-xl relative",children:[e.jsx("span",{className:"flex justify-center items-center h-6 w-6 absolute top-4 right-1/2 -translate-x-1/2 text-base font-medium border border-primary rounded-full",style:{display:"none"},children:s==null?void 0:s.order_status}),e.jsxs("div",{className:"flex flex-col gap-4 p-5 rounded-md shadow-md",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("h1",{className:"text-xl font-semibold text-gray-900",children:["Order Details - #",a]}),e.jsxs("div",{className:"flex gap-2 mobile:flex-wrap",children:[((s==null?void 0:s.order_status)===2||(s==null?void 0:s.order_status)==10)&&e.jsxs("button",{className:"flex items-center btn-info sm:btn smmobile:btn-sm bg-gray-700 text-white hover:!bg-gray-800 focus:!bg-gray-800",onClick:ss,"aria-label":(s==null?void 0:s.order_status)===2?"Change Pickup Boy":"Change Delivery Boy",title:(s==null?void 0:s.order_status)===2?"Change Pickup Boy":"Change Delivery Boy",children:[e.jsx("i",{className:"ki-filled ki-arrows-loop"})," ",(s==null?void 0:s.order_status)===2?"Change Pickup Boy":"Change Delivery Boy"]}),e.jsxs("button",{className:"flex items-center btn-light sm:btn smmobile:btn-sm smmobile:btn text-gray-700",onClick:Ve,disabled:g,children:[g?e.jsx("span",{className:"inline-block h-5 w-5 border-3 border-black/10 border-t-primary animate-spin rounded-full"}):e.jsx(us,{className:"h-5 w-5"}),"View Invoice"]}),e.jsxs("button",{className:"flex items-center btn-light sm:btn smmobile:btn-sm smmobile:btn text-gray-700",onClick:as,disabled:j,children:[j?e.jsx("span",{className:"inline-block h-6 w-6 p-0.5",children:e.jsx("span",{className:"inline-block h-full w-full border-3 border-black/10 border-t-primary animate-spin rounded-full"})}):e.jsx(Es,{className:"h-6 w-6"}),"Refresh Invoice"]}),((s==null?void 0:s.order_status)>0&&(s==null?void 0:s.order_status)<7||(s==null?void 0:s.order_status)===9||(s==null?void 0:s.order_status)===10||(s==null?void 0:s.order_status)===11)&&f(3,"update")&&e.jsxs("button",{className:"flex items-center font-medium sm:btn btn-primary smmobile:btn-sm smmobile:btn",onClick:Ye,children:[e.jsx("i",{className:"ki-filled ki-pencil mr-2"}),"Edit Order"]}),(s==null?void 0:s.order_status)>0&&(s==null?void 0:s.order_status)<7&&(s==null?void 0:s.refund_status)!==1&&f(3,"update")&&e.jsxs("button",{className:"flex items-center font-semibold btn-danger sm:btn smmobile:btn-sm smmobile:btn",onClick:We,children:[e.jsx(xs,{size:20}),"Cancel Order"]}),((ce=c==null?void 0:c.state)==null?void 0:ce.from)!=="WorkshopOrderTable"&&f(3,"update")&&(s==null?void 0:s.payment_status)!==1&&(s==null?void 0:s.refund_status)===3&&(s==null?void 0:s.order_status)!==11&&e.jsxs("button",{className:"flex items-center sm:btn smmobile:btn-sm smmobile:btn font-semibold btn-success",onClick:qe,children:[e.jsx(ks,{size:20}),"Refund Order"]})]})]}),s.refund_status===3?e.jsxs("div",{className:"flex border border-gray-200 rounded-xl bg-gray-50 items-center justify-between bg-gray-00 p-4 shadow-sm mobile:flex mobile:flex-col gap-5",children:[e.jsxs("div",{className:"flex items-center mobile:flex-col desktop:flex-col gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Current Status:"}),e.jsx("span",{className:`${Je} badge-outline badge-xl rounded-[30px]`,children:(de=s==null?void 0:s.order_status_details)==null?void 0:de.admin_label})]}),e.jsx("div",{className:"flex-1 px-6",children:e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(oe=s==null?void 0:s.order_status_details)==null?void 0:oe.description})}),((me=s==null?void 0:s.order_status_details)==null?void 0:me.next_step)!==null&&e.jsxs("div",{className:"flex items-center mobile:flex-col desktop:flex-col gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Next Step:"}),e.jsx("button",{className:`${Ze} badge-outline badge-xl rounded-[30px]`,onClick:Ge,disabled:!f(3,"update")&&!f(16,"update"),children:(ue=s==null?void 0:s.order_status_details)==null?void 0:ue.next_step}),(s==null?void 0:s.order_status)===9&&e.jsx("button",{className:"badge badge-delivered badge-outline badge-xl rounded-[30px]",onClick:ts,disabled:!f(3,"update")&&!f(16,"update"),children:"Delivered"})]})]}):e.jsxs("div",{className:"flex border flex-wrap border-gray-200 rounded-xl bg-gray-50 items-center bg-gray-00 p-4 shadow-sm mobile:flex mobile:flex-col gap-5",children:[e.jsx("div",{children:e.jsx("span",{className:"badge badge-secondary badge-text rounded-xl badge-outline text-sm font-medium text-gray-700",children:"Order Refunded"})}),e.jsxs("div",{className:"flex-shrink: 1 items-center px-10",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Reason of Refund :"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s==null?void 0:s.refund_descriptions})]}),e.jsxs("div",{className:"flex items-center flex-col mr-4 gap-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Refund Amount :"," "]}),e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["₹",s==null?void 0:s.refund_amount]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Refund Status :"}),e.jsxs("span",{className:`${s.refund_status===1?"badge badge-primary":"badge badge-warning"} badge-outline badge-sm`,children:[hs[s==null?void 0:s.refund_status]," "]})]}),e.jsxs("button",{className:"btn btn-secondary flex items-center gap-2 ml-auto",onClick:es,children:[e.jsx(ps,{size:20,color:"gray"})," Refund Receipt"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card p-2",children:[e.jsxs("div",{className:"card-header border-none p-2 mb-2 ml-2",children:[e.jsx("div",{className:"card-title align-items-start flex-column",children:e.jsxs("div",{className:"flex items-baseline justify-start flex-wrap sm:!gap-2 gap-1",children:[e.jsx("h3",{className:"card-title text-lg",children:"Order Items"}),e.jsxs("span",{className:"text-gray-700 text-sm font-bold rounded-lg flex",children:["Total Items : ",s==null?void 0:s.items.length]}),e.jsxs("span",{className:"text-gray-700 text-sm font-bold rounded-lg flex",children:["Total Quantity :",(xe=s==null?void 0:s.items)==null?void 0:xe.reduce((t,n)=>t+n.quantity,0)]})]})}),e.jsx("div",{className:"flex flex-end",children:e.jsx("button",{className:"flex items-center btn-light btn-sm sm:btn smmobile:btn-sm smmobile:btn",onClick:Xe,children:e.jsx("p",{className:"text-gray-700",children:"Print General Label"})})})]}),e.jsx("div",{className:"flex flex-wrap",children:e.jsx("div",{className:"card-body p-0 ml-4",children:e.jsx("div",{className:"scrollable-y-hover pe-4 pb-4 max-h-[400px] mb-4",children:e.jsx("div",{className:"space-y-4",children:((he=s==null?void 0:s.items)==null?void 0:he.length)>0?(pe=s==null?void 0:s.items)==null?void 0:pe.map((t,n)=>{var b,p,w;return e.jsxs("div",{className:"border border-gray-200 rounded-xl gap-2 px-4 py-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center flex-wrap gap-x-4 gap-y-2 justify-between xmobile:flex-col",children:[e.jsxs("div",{className:"flex items-center gap-3.5 xmobile:flex-col",children:[e.jsx("img",{alt:t==null?void 0:t.product.name,className:"w-16 h-16 shrink-0 object-cover rounded",src:t==null?void 0:t.product.image}),e.jsxs("div",{className:"flex flex-col ",children:[e.jsxs("span",{className:"text-sm font-semibold text-gray-900 mb-px xmobile:ml-8",children:[(b=t==null?void 0:t.product)==null?void 0:b.name," (",t==null?void 0:t.quantity,")"]}),e.jsxs("span",{className:"text-2sm font-medium text-gray-600",children:["Category: ",(p=t==null?void 0:t.category)==null?void 0:p.name]})]})]}),e.jsxs("div",{className:"flex items-center flex-row gap-2",children:[e.jsxs("div",{className:"badge badge-sm flex gap-1 badge-success badge-outline text-xs",children:[e.jsxs("span",{className:"mobile:hidden",children:["Service :"," "]}),e.jsx("span",{children:(w=t==null?void 0:t.service)==null?void 0:w.name})]}),e.jsx("div",{children:e.jsx("button",{className:"flex items-center btn-light btn-sm sm:btn smmobile:btn-sm smmobile:btn",onClick:()=>Qe(n),children:e.jsx("p",{className:"text-gray-700",children:"Print Label"})})})]})]}),(t==null?void 0:t.description)&&e.jsx("div",{className:"mt-2 p-3 bg-gray-100 rounded-md",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Description :"})," ",t==null?void 0:t.description]})})]},t==null?void 0:t.item_id)}):e.jsx("p",{className:"text-sm font-semibold text-gray-900 mb-px xmobile:ml-8",children:"No item found for this order"})})})})})]}),(s==null?void 0:s.description)&&e.jsx("div",{className:"card rounded-xl",children:e.jsx("div",{className:"flex items-center justify-between grow gap-5 p-5 bg-[center_right_-8rem] bg-no-repeat bg-[length:700px] upgrade-bg",children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"flex items-center gap-2.5",children:e.jsx("h3",{className:"card-title",children:"Customer Instruction"})}),e.jsx("div",{className:"text-2sm font-medium text-gray-700",children:s.description})]})})})}),e.jsx("div",{className:"col-span-2 lg:col-span-1 flex",children:e.jsxs("div",{className:"card grow",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Order Summary"})}),e.jsx("div",{className:"card-body pt-4 pb-3",children:e.jsx("table",{className:"table-auto",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Sub Total:"}),e.jsxs("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:["₹",s==null?void 0:s.sub_total]})]}),(s==null?void 0:s.normal_delivery_charges)!==0&&e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Normal Delivery Charge:"}),e.jsxs("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:["₹",s==null?void 0:s.normal_delivery_charges]})]}),(s==null?void 0:s.express_delivery_charges)!==0&&e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Express Delivery Charge:"}),e.jsxs("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:["₹",s==null?void 0:s.express_delivery_charges]})]}),s!=null&&s.express_delivery_hour?e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Express Delivery Hours:"}),e.jsxs("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:[s==null?void 0:s.express_delivery_hour," Hours"]})]}):"",(s==null?void 0:s.kasar_amount)!==0&&e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Kasar Amount:"}),e.jsxs("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:["₹",s==null?void 0:s.kasar_amount]})]}),(s==null?void 0:s.coupon_code)!==""&&e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Coupon Code:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:s==null?void 0:s.coupon_code})]}),(s==null?void 0:s.coupon_discount)!==0&&e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Coupon Discount"}),e.jsxs("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:["₹",s==null?void 0:s.coupon_discount]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Total:"}),e.jsxs("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:["₹",s==null?void 0:s.total]})]})]})})})]})}),(s==null?void 0:s.gst_company_name)&&(s==null?void 0:s.gstin)&&e.jsx("div",{className:"col-span-2 lg:col-span-1 flex",children:e.jsxs("div",{className:"card min-w-full",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"GST Information"})}),e.jsx("div",{className:"card-body pt-4 pb-3",children:e.jsx("div",{className:"scrollable-x-auto",children:e.jsx("table",{className:"table-auto",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"GSTIN :"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:(s==null?void 0:s.gstin)||"N/A"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Customer Company Name :"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:(s==null?void 0:s.gst_company_name)||"N/A"})]})]})})})})]})}),e.jsxs("div",{className:"card grow",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Estimated Delivery & Pickup"})}),e.jsx("div",{className:"card-body pt-4 pb-3",children:e.jsx("table",{className:"table-auto",children:e.jsxs("tbody",{className:"flex flex-col gap-2",children:[e.jsxs("tr",{className:"",children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pe-9",children:"Estimated Pickup Time:"}),e.jsx("td",{className:"text-sm font-medium text-gray-700",children:K(s==null?void 0:s.estimated_pickup_time).format("DD/MM/YYYY")})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pe-6",children:"Estimated Delivery Time:"}),e.jsx("td",{className:"text-sm font-medium text-gray-700",children:K(s==null?void 0:s.estimated_delivery_time).format("DD/MM/YYYY")})]})]})})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"col-span-2 lg:col-span-1 flex",children:e.jsxs("div",{className:"card min-w-full",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Customer Information"})}),e.jsx("div",{className:"card-body pt-4 pb-2",children:e.jsx("div",{className:"scrollable-x-auto",children:e.jsx("table",{className:"table-auto",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Name:"}),e.jsxs("td",{className:"flex items-center gap-2.5 text-sm font-medium text-primary cursor-pointer underline",onClick:()=>He(s==null?void 0:s.user_id),children:[(fe=s==null?void 0:s.user)==null?void 0:fe.first_name," ",(ge=s==null?void 0:s.user)==null?void 0:ge.last_name]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Email:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:(be=s==null?void 0:s.user)==null?void 0:be.email})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Mobile Number:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:(ye=s==null?void 0:s.user)==null?void 0:ye.mobile_number})]})]})})})})]})}),(s==null?void 0:s.company)&&Object.keys(s.company).length>0&&e.jsx("div",{className:"col-span-2 lg:col-span-1 flex",children:e.jsxs("div",{className:"card min-w-full",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Company Information"})}),e.jsx("div",{className:"card-body pt-4 pb-2",children:e.jsx("div",{className:"scrollable-x-auto",children:e.jsx("table",{className:"table-auto",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Company Name:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:(je=s==null?void 0:s.company)==null?void 0:je.company_name})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Email:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:s==null?void 0:s.company.email})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Phone Number:"}),e.jsxs("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:[e.jsx("span",{children:(Ne=s==null?void 0:s.company)==null?void 0:Ne.mobile_number}),((_e=s==null?void 0:s.company)==null?void 0:_e.phone_number)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"|"}),e.jsx("span",{children:(ve=s==null?void 0:s.company)==null?void 0:ve.phone_number})]})]})]})]})})})})]})}),(s==null?void 0:s.branch)&&e.jsx("div",{className:"col-span-2 lg:col-span-1 flex",children:e.jsxs("div",{className:"card min-w-full",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Branch Information"})}),e.jsx("div",{className:"card-body pt-4 pb-2",children:e.jsx("div",{className:"scrollable-x-auto",children:e.jsx("table",{className:"table-auto",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Branch Name:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:(we=s==null?void 0:s.branch)==null?void 0:we.branch_name})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Email:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:(ke=s==null?void 0:s.branch)==null?void 0:ke.branch_email})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Phone Number:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:(Ce=s==null?void 0:s.branch)==null?void 0:Ce.branch_phone_number})]})]})})})})]})}),(s==null?void 0:s.pickup_boy)&&e.jsx("div",{className:"card rounded-xl",children:e.jsx("div",{className:"flex items-center justify-between grow gap-5 p-5 bg-[center_right_-8rem] bg-no-repeat bg-[length:700px] upgrade-bg",children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"flex items-center gap-2.5",children:e.jsx("h3",{className:"card-title",children:"Pickup Boy Information"})}),e.jsx("div",{className:"text-2sm font-medium text-gray-700",children:(Se=s==null?void 0:s.pickup_boy)==null?void 0:Se.pickup_boy_name}),(s==null?void 0:s.pickup_comment)&&e.jsx("div",{className:"mt-2 p-3 bg-gray-100 rounded-md",children:e.jsx("p",{className:"text-sm text-gray-600",children:s==null?void 0:s.pickup_comment})})]})})})}),(s==null?void 0:s.delivery_boy)&&e.jsx("div",{className:"card rounded-xl",children:e.jsx("div",{className:"flex items-center justify-between grow gap-5 p-5 bg-[center_right_-8rem] bg-no-repeat bg-[length:700px] upgrade-bg",children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"flex items-center gap-2.5",children:e.jsx("h3",{className:"card-title",children:"Delivery Boy Information"})}),e.jsx("div",{className:"text-2sm font-medium text-gray-700",children:(Oe=s==null?void 0:s.delivery_boy)==null?void 0:Oe.delivery_boy_name})]})})})}),e.jsx("div",{className:"card rounded-xl",children:e.jsx("div",{className:"flex items-center justify-between grow gap-5 p-5 bg-[center_right_-8rem] bg-no-repeat bg-[length:700px] upgrade-bg",children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"flex items-center gap-2.5",children:e.jsx("h3",{className:"card-title",children:"Shipping Address"})}),e.jsx("div",{className:"text-2sm font-medium text-gray-700",children:(s==null?void 0:s.address_details)!=="null"&&(s==null?void 0:s.address_details.trim())!==""?s==null?void 0:s.address_details:"Address not provided."})]})})})}),e.jsx("div",{className:"col-span-2 lg:col-span-1 flex",children:e.jsxs("div",{className:"card min-w-full",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Payment Information"})}),e.jsx("div",{className:"card-body pt-4 pb-3",children:e.jsx("div",{className:"scrollable-x-auto",children:e.jsx("table",{className:"table-auto",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Payment Type:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:fs[s==null?void 0:s.payment_type]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Payment Status:"}),e.jsx("td",{className:`badge-outline ${Cs(s==null?void 0:s.payment_status)}`,children:Ke})]}),(s==null?void 0:s.paid_amount)>0&&e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Paid amount:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:s==null?void 0:s.paid_amount})]}),(s==null?void 0:s.kasar_amount)>0&&e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"kasar amount:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:s==null?void 0:s.kasar_amount})]}),(s==null?void 0:s.pending_due_amount)>0&&e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Pending amount:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:s==null?void 0:s.pending_due_amount})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Transaction ID:"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:(s==null?void 0:s.transaction_id)||"N/A"})]}),e.jsxs("tr",{style:{display:"none"},children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"GSTIN :"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:(s==null?void 0:s.gstin)||"N/A"})]})]})})})})]})}),(s==null?void 0:s.orderLogs.length)>0&&e.jsx("div",{className:"col-span-2 lg:col-span-1 flex",children:e.jsxs("div",{className:"card min-w-full",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Action Log"})}),e.jsx("div",{className:"card-body pt-4 pb-3",children:e.jsx("div",{className:"scrollable-x-auto",children:e.jsx("table",{className:"table-auto",children:e.jsxs("tbody",{children:[A(s==null?void 0:s.orderLogs,"confirmed_by")&&e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Confirmed By :"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:A(s==null?void 0:s.orderLogs,"confirmed_by")})]}),A(s==null?void 0:s.orderLogs,"workshop_by")&&e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Workshop By :"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:A(s==null?void 0:s.orderLogs,"workshop_by")})]}),A(s==null?void 0:s.orderLogs,"delivered_by")&&e.jsxs("tr",{children:[e.jsx("td",{className:"text-sm font-medium text-gray-500 min-w-36 pb-5 pe-6",children:"Delivered By :"}),e.jsx("td",{className:"flex items-center gap-2.5 text-sm font-medium text-gray-700",children:A(s==null?void 0:s.orderLogs,"delivered_by")})]})]})})})})]})})]})]}),(f(3,"update")||f(16,"update"))&&e.jsxs("div",{className:"mt-6 card rounded-xl p-6 shadow",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-700 mb-4",children:"Order Notes"}),e.jsxs("div",{children:[e.jsxs("div",{className:"relative border border-gray-300 rounded-md p-2",children:[e.jsx("textarea",{className:"w-full h-16 p-3 border-none focus:outline-none focus:ring-0",placeholder:"Add a new note...",value:y.text_note||"",onChange:t=>k({...y,text_note:t.target.value}),rows:5}),e.jsx("div",{className:"flex items-center mt-2 gap-4",children:e.jsxs("div",{children:[e.jsxs("button",{className:"btn btn-light",title:"Attach image",onClick:Te,children:["Attach image ",e.jsx(Ls,{size:20})]}),e.jsx("input",{type:"file",ref:ne,style:{display:"none"},multiple:!0,onChange:Le,name:"images"})]})})]}),e.jsx("p",{className:"text-red-500 text-sm",children:te||" "})]}),e.jsx("div",{children:y.images.map((t,n)=>e.jsxs("div",{className:"relative inline-block mr-2 mb-2 group",children:[e.jsx("img",{src:URL.createObjectURL(t),alt:`Preview ${n}`,className:"w-32 h-32 object-cover rounded-md border"}),e.jsx("button",{className:"absolute top-0 right-0 rounded-full p-1 shadow-md text-gray-700 opacity-0 group-hover:opacity-100 transition-opacity duration-200",onClick:()=>$e(n),children:e.jsx(As,{size:20})})]},n))}),e.jsx("div",{className:"flex relative justify-start pt-2.5",children:e.jsx("button",{className:`px-4 py-2 btn btn-primary 
          ${h?"opacity-50 cursor-not-allowed":""}`,onClick:Me,disabled:h,children:h?"Adding...":"Add Note"})}),e.jsx("ul",{className:"mt-4 space-y-4",children:(De=s==null?void 0:s.notes)==null?void 0:De.map((t,n)=>{var p,w,P,Re;const b=K(t.created_at).format("HH:mm, DD/MM/YYYY");return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"block text-sm text-gray-600",children:["• ",(p=t==null?void 0:t.user)==null?void 0:p.first_name," ",(w=t==null?void 0:t.user)==null?void 0:w.last_name]}),e.jsx("span",{className:"text-xs text-gray-500",children:b})]}),e.jsxs("li",{className:"p-4 border rounded-md shadow-sm bg-gray-50 hover:bg-gray-100 transition duration-200 relative",children:[e.jsx("p",{className:"text-gray-800 mb-2",children:t==null?void 0:t.text_note}),(t==null?void 0:t.images)&&((P=t==null?void 0:t.images)==null?void 0:P.length)>0&&e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 mt-3",children:(Re=t==null?void 0:t.images)==null?void 0:Re.map((Z,Pe)=>e.jsx("img",{src:Z,className:"w-full h-auto rounded-md border shadow-sm",alt:`Note Attachment ${Pe+1}`},Pe))}),(t==null?void 0:t.user_id)===u&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("label",{className:"flex items-center space-x-2 text-sm text-gray-700",children:[e.jsx("input",{type:"checkbox",className:"checkbox",checked:t==null?void 0:t.is_visible,disabled:Ee,onChange:Z=>ns(t==null?void 0:t.note_id,Z.target.checked)}),e.jsx("span",{children:"Visible on website"})]}),e.jsx("button",{className:"bg-red-100 hover:bg-red-200 p-2 rounded-full",onClick:()=>Ie(t==null?void 0:t.note_id),children:e.jsx(gs,{className:"text-red-500"})})]})]})]},n)})})]}),Y&&e.jsx(Us,{order:s,setModelOpen:I,setAssigned:E}),e.jsx(_s,{orderStatus:(s==null?void 0:s.order_status_details.next_step)==="Assign Pickup Boy"||(s==null?void 0:s.order_status_details.next_step)==="Assign Delivery boy"?s==null?void 0:s.order_status_details.next_step:void 0,modelOpen:W,onClose:()=>R(!1),orderId:[a],setAssigned:E}),e.jsx(vs,{orderStatus:(s==null?void 0:s.order_status_details.next_step)==="Assign Branch"||(s==null?void 0:s.order_status_details.next_step)==="Assign Workshop"?s==null?void 0:s.order_status_details.next_step:void 0,orderIds:[a],workshopModalOpen:O,onClose:()=>M(!1),setAssigned:t=>{t&&o(a)}}),e.jsx(Ts,{orderId:s==null?void 0:s.order_id,orderCancelModalOpen:q,onClose:()=>F(!1),setRefetch:v}),e.jsx(Ms,{orderId:s==null?void 0:s.order_id,TotalAmount:s==null?void 0:s.total,PaidAmount:s==null?void 0:s.paid_amount,orderRefundModalOpen:T,onClose:()=>B(!1),setRefetch:v}),Ae&&e.jsx(ws,{orders:[s],onClose:()=>z(!1),onSuccess:t=>{t&&(z(!1),o(a))}})]}):null};export{et as default};
