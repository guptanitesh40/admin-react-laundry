import{a1 as v,a2 as P,a3 as y,r as l,x as f,j as e,V as _}from"./index-DGFVYP3Q.js";import{T as S}from"./TableShimmer-D_mtPtT3.js";import{L as C}from"./Loading-D1SheG_g.js";const w=({isSave:m,setIsSave:x,setIsLoading:d})=>{var g;const{modulesData:i}=v(),{assignRolePermission:c,loading:o}=P(),{permissionsData:r,loading:p}=y(),[h,j]=l.useState([]),u=f(),b=(g=u==null?void 0:u.state)==null?void 0:g.role_id;l.useEffect(()=>{d(!!o)},[o]),l.useEffect(()=>{if(i&&r){const a=i.map(s=>r.find(n=>n.module_id===s.module_id)||{role_id:b,module_id:s.module_id,create:!1,update:!1,read:!1,delete:!1});j(a)}},[i,r]),l.useEffect(()=>{m&&(async()=>{try{c(h)&&x(!1)}catch{_.error("Failed to assign role permissions. Please try again.")}})()},[m]);const N=(a,s)=>{j(t=>t.map(n=>n.module_id===a?{...n,[s]:!n[s],read:s!=="read"?!0:!n.read}:n))};return e.jsx("div",{className:"card-body",children:e.jsx("div",{"data-datatable":"true","data-datatable-page-size":"10",children:e.jsx("div",{className:"scrollable-x-auto",children:e.jsxs("table",{className:"table table-auto table-border","data-datatable-table":"true",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"min-w-[200px]",children:"Modules"}),e.jsx("th",{children:"Create"}),e.jsx("th",{children:"Read"}),e.jsx("th",{children:"Update"}),e.jsx("th",{children:"Delete"})]})}),p?e.jsx(S,{}):i&&h.length>0?e.jsx("tbody",{children:i.map(a=>{const s=h.find(t=>t.module_id===a.module_id);return e.jsxs("tr",{children:[e.jsx("td",{children:a.module_name}),["create","read","update","delete"].map(t=>e.jsx("td",{children:e.jsx("input",{className:"w-4 h-4",type:"checkbox",checked:s?s[t]:!1,onChange:()=>N(a.module_id,t)})},t))]},a.module_id)})}):e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center",children:"No Modules Data Available"})})})]})})})})},k=()=>{var r;const[m,x]=l.useState(!1),[d,i]=l.useState(!1),c=f(),o=(r=c==null?void 0:c.state)==null?void 0:r.role;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container-fixed",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-5 pb-5",children:[e.jsxs("div",{className:"flex flex-col justify-center gap-2",children:[e.jsxs("h1",{className:"text-xl font-semibold leading-none text-gray-900",children:[o," Permissions"]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Manage permissions for the ",o,"."]})]}),e.jsx("div",{className:"flex items-center gap-2.5",children:e.jsx("button",{className:"btn btn-primary",onClick:()=>x(!0),disabled:d,children:d?e.jsxs(e.Fragment,{children:[" ","Saving"," ",e.jsx(C,{})," "]}):e.jsx(e.Fragment,{children:"Save Changes"})})})]})}),e.jsx("div",{className:"container-fixed",children:e.jsx("div",{className:"grid gap-5 lg:gap-7.5",children:e.jsx("div",{className:"card card-grid min-w-full",children:e.jsx(w,{isSave:m,setIsSave:x,setIsLoading:i})})})})]})};export{k as default};
