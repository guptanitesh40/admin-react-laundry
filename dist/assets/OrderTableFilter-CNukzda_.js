import{r as i,B as _,V as O,j as l}from"./index-4Ya-CA-9.js";import{u as C}from"./useGetBranches-BBBRRg4H.js";import{b as F}from"./enums-CdakGUf3.js";import{u as T}from"./useGetUsersByRole-C447O7tq.js";import{M as V}from"./MultiSelect-Dv2sTCZ4.js";const U=(s=1,o=10,v="",d,h,S,p,m,b,x,j,y,E="",g="")=>{const[B,w]=i.useState([]),[e,t]=i.useState(0),[a,u]=i.useState(!1),r=async()=>{var $,R;const k=localStorage.getItem("authToken"),c=new URLSearchParams;s&&c.append("page_number",s.toString()),o&&c.append("per_page",o.toString()),v&&c.append("search",v),d&&c.append("sort_by",d),h&&c.append("order",h),S&&S.forEach(n=>c.append("order_statuses",n.toString())),p&&p.forEach(n=>c.append("customer_ids",n.toString())),m&&m.forEach(n=>c.append("branches_ids",n.toString())),b&&b.forEach(n=>c.append("pickup_boy_ids",n.toString())),x&&x.forEach(n=>c.append("delivery_boy_ids",n.toString())),E&&c.append("list",E),g&&c.append("orderList",g),y&&y.forEach(n=>c.append("payment_statuses",n.toString())),j&&c.append("payment_types",j.toString()),u(!0);try{const n=await fetch(`${_}/admin/orders?${c}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${k}`}}),f=await n.json();if(!n.ok){O.error(f.message,{position:"top-center"});return}w((($=f==null?void 0:f.data)==null?void 0:$.orders)||[]),t(((R=f==null?void 0:f.data)==null?void 0:R.count)||0)}catch(n){O.error(n||"Network error: Failed to fetch.",{position:"top-center"})}finally{u(!1)}};return i.useEffect(()=>{r()},[s,o,v,d,h,S,p,m,b,x,j,y]),{orders:B,count:e,loading:a,fetchOrders:r}},A=()=>{const[s,o]=i.useState(!1);return{deleteOrder:async d=>{const h=localStorage.getItem("authToken"),S=`http://35.154.167.170:3000/admin/order/${d}`;o(!0);try{const p=await fetch(S,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`}}),m=await p.json();return p.ok?{success:!0,message:m.message}:(O.error(m.message,{position:"top-center"}),{success:!1,message:m.message})}catch(p){return O.error("An unexpected error occurred.",{position:"top-center"}),{success:!1,message:p.message}}finally{o(!1)}},loading:s}},G=({filters:s,updateFilters:o,showOrderStatusFilter:v=!0,orderStatusOptions:d,showSearchInput:h=!0})=>{const[S,p]=i.useState([]),[m,b]=i.useState([]),[x,j]=i.useState([]),[y,E]=i.useState(""),{branches:g}=C(),{fetchUsersByRole:B}=T(),w=Object.entries(F).filter(([e,t])=>typeof t=="number").map(([e,t])=>({label:e,value:t}));return i.useEffect(()=>{y&&(async()=>{const t=await B(5,y),a=t==null?void 0:t.map(u=>({label:`${u.first_name} ${u.last_name} (${u.mobile_number})`,value:u.user_id}));p(a)})()},[y]),i.useEffect(()=>{const e=async()=>{const a=await B(4),u=a==null?void 0:a.map(r=>({label:`${r.first_name} ${r.last_name} (${r.mobile_number})`,value:r.user_id}));b(u)},t=async()=>{const a=await B(4),u=a==null?void 0:a.map(r=>({label:`${r.first_name} ${r.last_name} (${r.mobile_number})`,value:r.user_id}));j(u)};e(),t()},[]),l.jsx(l.Fragment,{children:l.jsx("div",{className:"p-4",children:l.jsxs("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(250px,1fr))] gap-4",children:[l.jsx(V,{options:S,displayValue:"label",placeholder:"Search Customer",selectedValues:s.customerFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,customerFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,customerFilter:t})},setSearch:E,className:"w-full",isSearchInput:!0}),v&&l.jsx(V,{options:d,displayValue:"label",placeholder:"Select Order Status",selectedValues:s.orderStatusFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,orderStatusFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,orderStatusFilter:t})},isCustomLabel:!0,className:"w-full",isSearchInput:h}),l.jsx(V,{options:g==null?void 0:g.map(e=>({label:e.branch_name,value:e.branch_id})),displayValue:"branch_name",placeholder:"Select Branch",selectedValues:s==null?void 0:s.branchFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,branchFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,branchFilter:t})},className:"w-full",isSearchInput:!0}),l.jsx(V,{options:x,displayValue:"label",placeholder:"Search DeliveryBoy",selectedValues:s.deliveryBoyFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,deliveryBoyFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,deliveryBoyFilter:t})},className:"w-full",isSearchInput:!0}),l.jsx(V,{options:m,displayValue:"label",placeholder:"Search PickupBoy",selectedValues:s.pickupBoyFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,pickupBoyFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,pickupBoyFilter:t})},className:"w-full",isSearchInput:!0}),l.jsx(V,{options:w,displayValue:"label",placeholder:"Select Payment Status",selectedValues:s.paymentStatusFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,paymentStatusFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,paymentStatusFilter:t})},sliceCount:2,isSearchInput:!1,className:"w-full"}),l.jsxs("select",{className:"select select-lg w-[200px] text-sm",value:s.paymentTypeFilter,onChange:e=>{o({...s,paymentTypeFilter:Number(e.target.value)})},children:[l.jsx("option",{value:"",selected:!0,children:"Payment type"}),l.jsx("option",{value:1,children:"Cash on Delivery"}),l.jsx("option",{value:2,children:"Online Payment"})]})]})})})};export{G as O,A as a,U as u};
