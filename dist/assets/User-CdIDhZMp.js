import{r as o,_ as A,u as B,m as D,j as e,F as N,a as v,T as F,R as G,G as I,b as M,c as z,d as q,e as V,S as U,s as Y,V as W}from"./index-Cg29fZmV.js";const Z="http://35.154.167.170:3000/user",H=(i=1,m=10,r="",l,n)=>{const[x,c]=o.useState([]),[d,a]=o.useState(0),[p,t]=o.useState(!1),w=o.useCallback(async()=>{var f,b;const C=localStorage.getItem("authToken"),u=new URLSearchParams;i&&u.append("page_number",i.toString()),m&&u.append("per_page",m.toString()),r&&u.append("search",r),l&&u.append("sortBy",l),n&&u.append("order",n),t(!0);try{const h=await fetch(`${Z}?${u}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`}});if(!h.ok){const k=await h.json();A.error(k.message,{position:"top-center"});return}const j=await h.json(),_=((f=j==null?void 0:j.data)==null?void 0:f.result)||[],y=((b=j==null?void 0:j.data)==null?void 0:b.count)||0;c(_),a(y)}catch(h){A.error((h==null?void 0:h.message)||"Network error: Failed to fetch.",{position:"top-center"})}finally{t(!1)}},[i,m,n,l,r]);return{users:x,totalUsers:d,loading:p,fetchUsers:w}},J=()=>{const[i,m]=o.useState(!1);return{deleteUser:async l=>{m(!0);const n=`http://35.154.167.170:3000/user/${l}`,x=localStorage.getItem("authToken");try{const c=await fetch(n,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${x}`}}),d=await c.json();return c.ok?{success:!0,message:d.message}:(A.error(d.message,{position:"top-center"}),{success:!1,message:d.message})}catch(c){return{success:!1,message:c.message}}finally{m(!1)}},loading:i}},K=({search:i})=>{const{deleteUser:m}=J(),[r,l]=o.useState(1),[n,x]=o.useState(10),[c,d]=B(),[a,p]=o.useState(null),[t,w]=o.useState(null),C=c.get("page"),u=c.get("perPage"),{users:f,fetchUsers:b,totalUsers:h,loading:j}=H(r,n,i,a,t),_=D(),y=Math.ceil(h/n),k=s=>{_(`/user/edit/${s}`)};o.useEffect(()=>{C&&l(Number(C)),u&&x(Number(u))},[C,u]),o.useEffect(()=>{i&&(l(1),d({search:i,page:"1",perPage:n.toString()})),b()},[n,r,i,a,t,b]);const T=async s=>{try{const{isConfirmed:g}=await U.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel"});if(g){const{success:$,message:P}=await m(s);$?(f.filter(R=>R.user_id!==s).length===0&&r>1&&(l(r-1),d({page:(r-1).toString(),perPage:n.toString()})),await b(),U.fire(P)):U.fire(P)}}catch(g){U.fire({title:"Error",text:g.message,icon:"error"})}},S=s=>{a===s?w(t==="ASC"?"DESC":"ASC"):(p(s),w("ASC"))},E=s=>{s>=1&&s<=y&&(l(s),d({page:s.toString(),perPage:n.toString()}))},L=s=>{const g=Number(s.target.value);x(g),l(1),d({page:"1",perPage:g.toString()})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"inline-block",children:e.jsxs("div",{className:"flex mb-3 items-center gap-2",children:["Show",e.jsxs("select",{className:"select select-sm w-16",value:n,onChange:L,children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"})]}),"per page"]})}),e.jsx("div",{className:"grid gap-5 lg:gap-7.5",children:e.jsx("div",{className:"card card-grid min-w-full",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"scrollable-x-auto",children:e.jsxs("table",{className:"table table-auto table-border",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"min-w-[100px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>S("user_id"),children:["Id",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(N,{color:a==="user_id"&&t==="ASC"?"gray":"lightgray"}),e.jsx(v,{color:a==="user_id"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[165px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>S("user_id"),children:["User name",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(N,{color:a==="user_id"&&t==="ASC"?"gray":"lightgray"}),e.jsx(v,{color:a==="user_id"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[250px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>S("email"),children:["Email",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(N,{color:a==="email"&&t==="ASC"?"gray":"lightgray"}),e.jsx(v,{color:a==="email"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[165px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>S("mobile_number"),children:["Mobile no",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(N,{color:a==="mobile_number"&&t==="ASC"?"gray":"lightgray"}),e.jsx(v,{color:a==="mobile_number"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[170px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>S("role_id"),children:["Role",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(N,{color:a==="role_id"&&t==="ASC"?"gray":"lightgray"}),e.jsx(v,{color:a==="role_id"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[150px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>S("gender"),children:["Gender",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(N,{color:a==="gender"&&t==="ASC"?"gray":"lightgray"}),e.jsx(v,{color:a==="gender"&&t==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[140px]",children:"Actions"})]})}),j?e.jsx(F,{}):f.length>0?e.jsx("tbody",{children:f.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.user_id}),e.jsxs("td",{children:[s.first_name," ",s.last_name]}),e.jsx("td",{children:s.email}),e.jsx("td",{children:s.mobile_number}),e.jsx("td",{children:G[s.role_id]}),e.jsx("td",{children:I[s.gender]}),e.jsxs("td",{children:[e.jsx("button",{className:"mr-3 bg-yellow-100 hover:bg-yellow-200 p-3 rounded-full",onClick:()=>k(s.user_id),children:e.jsx(M,{className:"text-yellow-600"})}),e.jsx("button",{className:"bg-red-100 hover:bg-red-200 p-3 rounded-full",onClick:()=>T(s.user_id),children:e.jsx(z,{className:"text-red-500"})})]})]},s.user_id))}):e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center",children:"No users available"})})})]})})})})}),h>n&&e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsxs("span",{className:"text-gray-700",children:["Showing ",f.length," of ",h," Users"]}),e.jsxs("div",{className:"pagination","data-datatable-pagination":"true",children:[e.jsx("button",{disabled:r===1,onClick:()=>E(r-1),className:`btn ${r===1?"disabled":""}`,children:e.jsx(q,{})}),Array.from({length:y}).map((s,g)=>e.jsx("button",{className:`btn ${r===g+1?"active":""}`,onClick:()=>E(g+1),children:g+1},g)),e.jsx("button",{disabled:r===y,onClick:()=>E(r+1),className:`btn ${r===y?"disabled":""}`,children:e.jsx(V,{})})]})]})]})},X=()=>{const i=D(),[m,r]=o.useState(""),[l,n]=o.useState(""),[x,c]=o.useState(""),d=()=>{i("/user/add")},a=async p=>{p.preventDefault();try{await Y.validate({search:l},{abortEarly:!1}),r(l),c("")}catch(t){t instanceof W&&c(t.errors[0])}};return e.jsxs("div",{className:"container-fixed relative",children:[e.jsxs("div",{className:"flex flex-wrap items-center lg:items-end justify-between gap-5 pb-7.5",children:[e.jsx("h1",{className:"text-xl font-semibold leading-none text-gray-900",children:"Users"}),e.jsxs("button",{onClick:d,className:"btn btn-primary",children:[e.jsx("i",{className:"ki-filled ki-plus-squared"}),"Add User"]})]}),e.jsxs("div",{className:"absolute top-11 right-[2.5rem] mt-2",children:[e.jsxs("form",{onSubmit:a,className:"w-64 relative flex",children:[e.jsx("input",{type:"search",value:l,onChange:p=>{n(p.target.value),p.target.value===""&&r("")},className:"peer block min-h-[auto] w-full rounded border bg-transparent px-3 py-[0.32rem] leading-[1.6] text-gray-700 outline-none focus:border-gray-500 focus:bg-white border-gray-500",placeholder:"Search"}),e.jsx("button",{type:"submit",className:"relative z-[2] -ml-0.5 flex items-center rounded-e bg-gray-500 px-5 text-xs font-medium uppercase leading-normal text-white",children:e.jsx("svg",{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"h-5 w-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})})})]}),e.jsx("p",{className:"absolute top-8 right-[0.2rem] mt-2 text-red-500 text-sm w-80",children:x||"Â "})]}),e.jsx(K,{search:m})]})};export{X as default};
