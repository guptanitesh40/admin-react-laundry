import{r as h,_ as E,G as $,u as I,E as R,n as D,j as e,F as l,a as i,T as z,b as G,c as U,d as V,e as q,S as f,s as K,V as W}from"./index-CrW1VcAo.js";import{O as Z,P as H,a as J}from"./enums-B4eR1RbL.js";import{d as A}from"./dayjs.min-CgtumrHU.js";const Q=()=>{const[d,c]=h.useState(!1);return{deleteOrder:async n=>{const u=localStorage.getItem("authToken"),g=`http://35.154.167.170:3000/admin/order/${n}`;c(!0);try{const o=await fetch(g,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`}}),s=await o.json();return o.ok?{success:!0,message:s.message}:(E.error(s.message,{position:"top-center"}),{success:!1,message:s.message})}catch(o){return E.error("An unexpected error occurred.",{position:"top-center"}),{success:!1,message:o.message}}finally{c(!1)}},loading:d}};function X(d){return $({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2"},child:[]}]})(d)}const ee=({search:d})=>{const[c,m]=h.useState(1),[n,u]=h.useState(10),[g,o]=I(),[s,N]=h.useState(null),[r,p]=h.useState(null),b=g.get("page"),C=g.get("perPage"),{orders:j,loading:P,totalOrders:v,fetchOrders:S}=R(c,n,d,s,r),w=D(),y=Math.ceil(v/n),{deleteOrder:O}=Q(),T=t=>{w(`/order/${t}`)},F=async t=>{try{const{isConfirmed:x}=await f.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel"});if(x){const{success:B,message:k}=await O(t);B?(j.filter(L=>L.order_id!==t).length===0&&c>1&&(m(c-1),o({page:(c-1).toString(),perPage:n.toString()})),await S(),f.fire(k)):f.fire(k)}}catch(x){f.fire({title:"Error",text:x.message,icon:"error"})}},M=t=>{w(`/order/edit/${t}`)};h.useEffect(()=>{b&&m(Number(b)),C&&u(Number(C))},[b,C]),h.useEffect(()=>{d?(m(1),o({search:d,page:"1",perPage:n.toString()})):o({page:"1",perPage:n.toString()})},[d]),h.useEffect(()=>{S()},[n,c,d,s,r,S]);const a=t=>{s===t?p(r==="ASC"?"DESC":"ASC"):(N(t),p("ASC"))},_=t=>{t>=1&&t<=y&&(m(t),o({page:t.toString(),perPage:n.toString()}))},Y=t=>{const x=Number(t.target.value);u(x),m(1),o({page:"1",perPage:x.toString()})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"inline-block",children:e.jsxs("div",{className:"flex mb-3 items-center gap-2",children:["Show",e.jsxs("select",{className:"select select-sm w-16",value:n,onChange:Y,children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"})]}),"per page"]})}),e.jsx("div",{className:"grid gap-5 lg:gap-5.5",children:e.jsx("div",{className:"card card-grid min-w-full",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"scrollable-x-auto",children:e.jsxs("table",{className:"table table-auto table-border",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"min-w-[90px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("order_id"),children:["Id",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(l,{color:s==="order_id"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="order_id"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[140px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("first_name"),children:["Customer",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(l,{color:s==="first_name"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="first_name"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[140px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("email"),children:["Email",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(l,{color:s==="email"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="email"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[140px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("mobile_number"),children:["Mobile no",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(l,{color:s==="mobile_number"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="mobile_number"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[230px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("address_details"),children:["Shipping Address",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(l,{color:s==="address_details"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="address_details"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[230px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("description"),children:["Description",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(l,{color:s==="description"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="description"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[130px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer ",onClick:()=>a("coupon_code"),children:["Coupon code",e.jsxs("div",{className:"flex cursor-pointer mt-2",children:[e.jsx(l,{color:s==="coupon_code"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="coupon_code"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[130px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("coupon_discount"),children:["Coupon discount",e.jsxs("div",{className:"flex cursor-pointer mt-2",children:[e.jsx(l,{color:s==="coupon_discount"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="coupon_discount"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[130px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("order_statue"),children:["Order Status",e.jsxs("div",{className:"flex cursor-pointer mt-2",children:[e.jsx(l,{color:s==="order_status"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="order_status"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[200px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("estimated_delivery_time"),children:["Estimated delivery time",e.jsxs("div",{className:"flex cursor-pointer mt-2",children:[e.jsx(l,{color:s==="order_status"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="estimated_delivery_time"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[200px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("estimated_pickup_time"),children:["Estimated pickup time",e.jsxs("div",{className:"flex cursor-pointer mt-2",children:[e.jsx(l,{color:s==="order_status"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="estimated_pickup_time"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[140px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("shipping_charges"),children:["Shipping charge",e.jsxs("div",{className:"flex cursor-pointer mt-2",children:[e.jsx(l,{color:s==="shipping_charges"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="shipping_charges"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[180px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("express_delivery_charges"),children:["Express delivery charges",e.jsxs("div",{className:"flex cursor-pointer mt-2",children:[e.jsx(l,{color:s==="express_delivery_charges"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="express_delivery_charges"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[180px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("gst"),children:["GST",e.jsxs("div",{className:"flex cursor-pointer mt-2",children:[e.jsx(l,{color:s==="gst"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="gst"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[130px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("kasar_amount"),children:["Kasar amount",e.jsxs("div",{className:"flex cursor-pointer mt-2",children:[e.jsx(l,{color:s==="kasar_amount"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="kasar_amount"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[130px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("sub_total"),children:["Sub total",e.jsxs("div",{className:"flex cursor-pointer ",children:[e.jsx(l,{color:s==="sub_total"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="sub_total"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[105px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("total"),children:["Total",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(l,{color:s==="total"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="total"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[165px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("payment_type"),children:["Payment type",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(l,{color:s==="payment_type"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="payment_type"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"min-w-[175px]",children:e.jsxs("div",{className:"flex justify-between cursor-pointer",onClick:()=>a("payment_status"),children:["Payment Status",e.jsxs("div",{className:"flex cursor-pointer",children:[e.jsx(l,{color:s==="payment_status"&&r==="ASC"?"gray":"lightgray"}),e.jsx(i,{color:s==="payment_status"&&r==="DESC"?"gray":"lightgray"})]})]})}),e.jsx("th",{className:"w-[170px]",children:"Actions"})]})}),P?e.jsx(z,{}):j.length!==null?e.jsx("tbody",{children:j.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.order_id}),e.jsx("td",{children:t.user.first_name+" "+t.user.last_name}),e.jsx("td",{children:t.user.email}),e.jsx("td",{children:t.user.mobile_number}),e.jsx("td",{children:t.address_details}),e.jsx("td",{children:t.description}),e.jsx("td",{children:t.coupon_code}),e.jsx("td",{children:t.coupon_discount}),e.jsx("td",{children:Z[t.order_status]}),e.jsx("td",{children:e.jsx("div",{className:"flex flex-col",children:A(t.estimated_delivery_time).format("YYYY-MM-DD")})}),e.jsx("td",{children:e.jsx("div",{className:"flex flex-col",children:A(t.estimated_pickup_time).format("YYYY-MM-DD")})}),e.jsx("td",{children:t.shipping_charges}),e.jsx("td",{children:t.express_delivery_charges}),e.jsx("td",{children:t.gst}),e.jsx("td",{children:t.kasar_amount}),e.jsx("td",{children:t.sub_total}),e.jsx("td",{children:t.total}),e.jsx("td",{children:H[t.payment_type]}),e.jsx("td",{children:J[t.payment_status]}),e.jsx("td",{children:e.jsxs("div",{className:"flex",children:[e.jsx("button",{className:"mr-3 bg-yellow-100 hover:bg-yellow-200 p-[11px] rounded-full",onClick:()=>T(t.order_id),children:e.jsx(X,{size:18,className:"text-yellow-600"})}),e.jsx("button",{className:"mr-3 bg-yellow-100 hover:bg-yellow-200 p-3 rounded-full",onClick:()=>M(t.order_id),children:e.jsx(G,{className:"text-yellow-600"})}),e.jsx("button",{className:"bg-red-100 hover:bg-red-200 p-3 rounded-full",onClick:()=>F(t.order_id),children:e.jsx(U,{className:"text-red-500"})})]})})]},t.order_id))}):e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center",children:"No banners available"})})})]})})})})}),v>n&&e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsxs("span",{className:"text-gray-700",children:["Showing ",j.length," of ",v," Orders"]}),e.jsxs("div",{className:"pagination","data-datatable-pagination":"true",children:[e.jsx("button",{disabled:c===1,onClick:()=>_(c-1),className:`btn ${c===1?"disabled":""}`,children:e.jsx(V,{})}),Array.from({length:y}).map((t,x)=>e.jsx("button",{className:`btn ${c===x+1?"active":""}`,onClick:()=>_(x+1),children:x+1},x)),e.jsx("button",{disabled:c===y,onClick:()=>_(c+1),className:`btn ${c===y?"disabled":""}`,children:e.jsx(q,{})})]})]})]})},le=()=>{const[d,c]=h.useState(""),[m,n]=h.useState(""),[u,g]=h.useState(""),o=D(),s=()=>{o("/order/add")},N=async r=>{r.preventDefault();try{await K.validate({search:m},{abortEarly:!1}),c(m),g("")}catch(p){p instanceof W&&g(p.errors[0])}};return e.jsxs("div",{className:"container-fixed relative",children:[e.jsxs("div",{className:"flex flex-wrap items-center lg:items-end justify-between gap-5 pb-7.5",children:[e.jsx("h1",{className:"text-xl font-semibold leading-none text-gray-900",children:"Orders"}),e.jsxs("button",{className:"btn btn-primary",onClick:s,children:[e.jsx("i",{className:"ki-filled ki-plus-squared"}),"Add Order"]})]}),e.jsxs("div",{className:"absolute top-11 right-[2.5rem] mt-2",children:[e.jsxs("form",{onSubmit:N,className:"w-64 relative flex",children:[e.jsx("input",{type:"search",value:m,onChange:r=>n(r.target.value),className:"peer block min-h-[auto] w-full rounded border bg-transparent px-3 py-[0.32rem] leading-[1.6] text-gray-700 outline-none focus:border-primary focus:bg-white border-primary",placeholder:"Search"}),e.jsx("button",{type:"submit",className:"relative z-[2] -ml-0.5 flex items-center rounded-e bg-gray-500 px-5 text-xs font-medium uppercase leading-normal text-white",children:e.jsx("svg",{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"h-5 w-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})})})]}),e.jsx("p",{className:"absolute top-8 right-[0.2rem] mt-2 text-red-500 text-sm w-80",children:u||" "})]}),e.jsx(ee,{search:d})]})};export{le as default};
