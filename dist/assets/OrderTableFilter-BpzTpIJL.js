import{r as i,B as _,V as B,j as c}from"./index-DvGf1eO-.js";import{u as F}from"./useGetBranches-mGjm9PWs.js";import{O as T,b as C}from"./enums-CdakGUf3.js";import{u as N}from"./useGetUsersByRole-BZtLr-sZ.js";import{M as O}from"./MultiSelect-BwfTGUET.js";const A=(s=1,o=10,g="",d,h,S,u,m,b,y,x,f,V="",j="")=>{const[E,e]=i.useState([]),[t,a]=i.useState(0),[p,l]=i.useState(!1),w=async()=>{var $,k;const R=localStorage.getItem("authToken"),r=new URLSearchParams;s&&r.append("page_number",s.toString()),o&&r.append("per_page",o.toString()),g&&r.append("search",g),d&&r.append("sort_by",d),h&&r.append("order",h),S&&S.forEach(n=>r.append("order_statuses",n.toString())),u&&u.forEach(n=>r.append("customer_ids",n.toString())),m&&m.forEach(n=>r.append("branches_ids",n.toString())),b&&b.forEach(n=>r.append("pickup_boy_ids",n.toString())),y&&y.forEach(n=>r.append("delivery_boy_ids",n.toString())),V&&r.append("list",V),j&&r.append("orderList",j),f&&f.forEach(n=>r.append("payment_statuses",n.toString())),x&&r.append("payment_types",x.toString()),l(!0);try{const n=await fetch(`${_}/admin/orders?${r}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${R}`}}),v=await n.json();if(!n.ok){B.error(v.message,{position:"top-center"});return}e((($=v==null?void 0:v.data)==null?void 0:$.orders)||[]),a(((k=v==null?void 0:v.data)==null?void 0:k.count)||0)}catch(n){B.error(n||"Network error: Failed to fetch.",{position:"top-center"})}finally{l(!1)}};return i.useEffect(()=>{w()},[s,o,g,d,h,S,u,m,b,y,x,f]),{orders:E,totalOrders:t,loading:p,fetchOrders:w}},G=()=>{const[s,o]=i.useState(!1);return{deleteOrder:async d=>{const h=localStorage.getItem("authToken"),S=`http://3.110.208.70:3000/admin/order/${d}`;o(!0);try{const u=await fetch(S,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`}}),m=await u.json();return u.ok?{success:!0,message:m.message}:(B.error(m.message,{position:"top-center"}),{success:!1,message:m.message})}catch(u){return B.error("An unexpected error occurred.",{position:"top-center"}),{success:!1,message:u.message}}finally{o(!1)}},loading:s}},z=({filters:s,updateFilters:o,showOrderStatusFilter:g=!0})=>{const[d,h]=i.useState([]),[S,u]=i.useState([]),[m,b]=i.useState([]),[y,x]=i.useState(""),{branches:f}=F(),{fetchUsersByRole:V}=N(),j=Object.entries(T).filter(([e,t])=>typeof t=="number").map(([e,t])=>({label:e,value:t})),E=Object.entries(C).filter(([e,t])=>typeof t=="number").map(([e,t])=>({label:e,value:t}));return i.useEffect(()=>{y&&(async()=>{const t=await V(5,y),a=t==null?void 0:t.map(p=>({label:`${p.first_name} ${p.last_name} (${p.mobile_number})`,value:p.user_id}));h(a)})()},[y]),i.useEffect(()=>{const e=async()=>{const a=await V(4),p=a==null?void 0:a.map(l=>({label:`${l.first_name} ${l.last_name} (${l.mobile_number})`,value:l.user_id}));u(p)},t=async()=>{const a=await V(4),p=a==null?void 0:a.map(l=>({label:`${l.first_name} ${l.last_name} (${l.mobile_number})`,value:l.user_id}));b(p)};e(),t()},[]),c.jsx(c.Fragment,{children:c.jsx("div",{className:"p-4",children:c.jsxs("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(250px,1fr))] gap-4",children:[c.jsx(O,{options:d,displayValue:"label",placeholder:"Search Customer",selectedValues:s.customerFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,customerFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,customerFilter:t})},setSearch:x,className:"w-full",isSearchInput:!0}),g&&c.jsx(O,{options:j,displayValue:"label",placeholder:"Select Order Status",selectedValues:s.orderStatusFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,orderStatusFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,orderStatusFilter:t})},isCustomLabel:!0,className:"w-full",isSearchInput:!0}),c.jsx(O,{options:f==null?void 0:f.map(e=>({label:e.branch_name,value:e.branch_id})),displayValue:"branch_name",placeholder:"Select Branch",selectedValues:s==null?void 0:s.branchFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,branchFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,branchFilter:t})},className:"w-full",isSearchInput:!0}),c.jsx(O,{options:m,displayValue:"label",placeholder:"Search DeliveryBoy",selectedValues:s.deliveryBoyFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,deliveryBoyFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,deliveryBoyFilter:t})},className:"w-full",isSearchInput:!0}),c.jsx(O,{options:S,displayValue:"label",placeholder:"Search PickupBoy",selectedValues:s.pickupBoyFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,pickupBoyFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,pickupBoyFilter:t})},className:"w-full",isSearchInput:!0}),c.jsx(O,{options:E,displayValue:"label",placeholder:"Select Payment Status",selectedValues:s.paymentStatusFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,paymentStatusFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,paymentStatusFilter:t})},sliceCount:2,isSearchInput:!1,className:"w-full"}),c.jsxs("select",{className:"select select-lg w-[200px] text-sm",value:s.paymentTypeFilter,onChange:e=>{o({...s,paymentTypeFilter:Number(e.target.value)})},children:[c.jsx("option",{value:"",selected:!0,children:"Payment type"}),c.jsx("option",{value:1,children:"Cash on Delivery"}),c.jsx("option",{value:2,children:"Online Payment"})]})]})})})};export{z as O,G as a,A as u};
