import{r as u,_ as f,B as de,c as H,h as D,a as ie,q as Re,j as e,V as K,s as Le,t as Be,i as Ge,v as ze,g as Me,k as Ve,b as Je,w as He}from"./index-BsXSBe6J.js";import{u as Ke}from"./useGetCategories-D7Z_ryi1.js";import{u as Qe}from"./useGetPrice-CXyHLdnR.js";import{u as Ye}from"./useGetBranches-DMjl_2Jw.js";import{u as We}from"./useGetOrder-BADK7dp_.js";import{u as Xe}from"./useGetUsersByRole-hGehtCF8.js";import{u as Ze,c as et}from"./userSchema-Chko4FDw.js";import{u as tt}from"./useGetuser-DEs1xFru.js";const st="http://3.110.208.70:3000/admin/coupon/apply",at=()=>{const[i,p]=u.useState(!1);return{applyCoupon:async(y,m,h)=>{const d=localStorage.getItem("authToken");p(!0);try{const c=await fetch(st,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify({user_id:y,order_Total:m,coupon_code:h})}),o=await c.json();return c.ok?o.data:(f.error(o.message,{position:"top-center"}),!1)}catch{f.error("Unable to apply coupon code!")}finally{p(!1)}},loading:i}},rt=()=>{const[i,p]=u.useState([]),[j,y]=u.useState(!1),m=async h=>{const d=localStorage.getItem("authToken");y(!0);try{const c=await fetch(`${de}/admin/valid-coupons?${h}`,{method:"GET",headers:{Authorization:d?`Bearer ${d}`:""}}),o=await c.json();if(!c.ok){f.error(o.message,{position:"top-center"}),y(!1);return}p(o==null?void 0:o.data)}catch{f.error("Network error: Failed to fetch coupons.")}finally{y(!1)}};return u.useEffect(()=>{m()},[]),{validCoupons:i,fetchValidCoupons:m,loading:j}},nt="http://3.110.208.70:3000",lt=`${nt}/admin/orders`,ot=()=>{const[i,p]=u.useState(!1);return{addOrder:async y=>{const m=localStorage.getItem("authToken");p(!0);try{const h=await fetch(lt,{method:"POST",headers:{Authorization:`Bearer ${m}`,"Content-Type":"application/json"},body:JSON.stringify(y)});if(!h.ok){const c=await h.json();return f.error(c.message,{position:"top-center"}),!1}const d=await h.json();return f.success(d.message,{position:"top-center"}),!0}catch(h){return f.error((h==null?void 0:h.message)||"Network error: Failed to fetch.",{position:"top-center"}),!1}finally{p(!1)}},loading:i}},dt=()=>{const[i,p]=u.useState(!1);return{updateOrder:async(y,m)=>{const h=localStorage.getItem("authToken"),d=`http://3.110.208.70:3000/admin/orders/${y}`;p(!0);try{const c=await fetch(d,{method:"PUT",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"},body:JSON.stringify(m)});if(c.ok){const x=await c.json();return f.success(x.message,{position:"top-center"}),!0}const o=await c.json();return f.error(o.message,{position:"top-center"}),!1}catch(c){return f.error((c==null?void 0:c.message)||"Network error: Failed to fetch.",{position:"top-center"}),!1}finally{p(!1)}},loading:i}},it=()=>{const[i,p]=u.useState([]),[j,y]=u.useState(!1);return{address:i,loading:j,fetchAddress:async h=>{var o;const d=localStorage.getItem("authToken"),c=`http://3.110.208.70:3000/address/${h}/user`;try{const x=await fetch(c,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`}});if(!x.ok){const C=await x.json();f.error(C.message,{position:"top-center"});return}const S=await x.json(),l=((o=S==null?void 0:S.data)==null?void 0:o.result)||[];p(l)}catch(x){f.error((x==null?void 0:x.message)||"Network error: Failed to fetch.",{position:"top-center"})}finally{y(!1)}}}},ct=H().shape({category_id:D().nullable().required("Please select a category").test("required","Please select a category",i=>!!i),product_id:D().nullable().required("Please select a product").test("required","Please select a product",i=>!!i),service_id:D().nullable().required("Please select a service").test("required","Please select a service",i=>!!i),price:D().nullable().when(["category_id","product_id","service_id"],([i,p,j],y)=>i&&p&&j?y.required("Price is not available for the combination, please add a price"):y.nullable())}),ut=H().shape({username:ie().required("Please enter username"),address_id:D().required("Please select address").test("required","Please select address",i=>!!i),express_delivery_charges:D().typeError("Express delivery charges must be a number").min(0,"Express delivery charges must be a positive number"),shipping_charges:D().typeError("Shipping charge must be a number").min(0,"Shipping charge must be a positive number"),payment_type:D().required("Please choose payment type").test("required","Please choose order status",i=>!!i),payment_status:D().required("Please choose payment status").test("required","Please choose payment status",i=>!!i),paid_amount:D().typeError("Paid amount must be a number").min(0,"Paid amount must be a positive number"),branch_id:D().required("Please select branch").test("required","Please select branch",i=>!!i),items:Re().of(ct)}),mt=localStorage.getItem("authToken"),pt=()=>{const[i,p]=u.useState(!1);return{addAddress:async y=>{p(!0);try{const m=await fetch(`${de}/address/admin`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${mt}`},body:JSON.stringify(y)});if(!m.ok){const d=await m.json();return f.error(d.message,{position:"top-center"}),!1}const h=await m.json();return f.success(h.message,{position:"top-center"}),!0}catch(m){return f.error((m==null?void 0:m.message)||"Error adding banner",{position:"top-center"}),!1}finally{p(!1)}},loading:i}},ht=H().shape({pincode:ie().required("Pin Code is required").matches(/^[0-9]{6}$/,"Pincode must be 6 digit"),address_type:D().required("Address type is required")}),bt=({isOpen:i,onClose:p,userId:j,setIsSubmit:y})=>{const{addAddress:m,loading:h}=pt(),[d,c]=u.useState({}),[o,x]=u.useState({building_number:"",area:"",landmark:"",pincode:"",city:"",state:"",country:"",user_id:null,address_type:null});u.useEffect(()=>{i?j&&x(l=>({...l,user_id:j})):(x({building_number:"",area:"",landmark:"",pincode:"",city:"",state:"",country:"",user_id:null,address_type:null}),c({}))},[i,j]);const S=async l=>{l.preventDefault();try{await ht.validate(o,{abortEarly:!1}),j&&await m(o),y(!0),p()}catch(C){if(C instanceof K){const v={};C.inner.forEach(F=>{v[F.path||""]=F.message}),c(v)}else f.error("Failed to submit the form. Please try again.")}};if(i)return e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:p}),e.jsxs("div",{className:"bg-white p-5 rounded-lg shadow-lg max-w-lg z-10 relative",children:[e.jsx("button",{className:"btn btn-sm btn-icon btn-light btn-outline absolute top-0 right-0 mr-5 mt-5 lg:mr-5 shadow-default",onClick:p,children:e.jsx("i",{className:"ki-filled ki-cross"})}),e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Add New Address"}),e.jsxs("form",{onSubmit:S,children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"building_number",className:"block text-gray-700 font-semibold",children:"Building Number"}),e.jsx("input",{type:"text",id:"building_number",name:"building_number",value:o.building_number,onChange:l=>x({...o,building_number:l.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"area",className:"block text-gray-700 font-semibold",children:"Area"}),e.jsx("input",{type:"text",id:"area",name:"area",value:o.area,onChange:l=>x({...o,area:l.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"landmark",className:"block text-gray-700 font-semibold",children:"Landmark"}),e.jsx("input",{type:"text",id:"landmark",name:"landmark",value:o.landmark,onChange:l=>x({...o,landmark:l.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pincode",className:"block text-gray-700 font-semibold",children:"Pin code"}),e.jsx("input",{type:"text",id:"pincode",name:"pincode",value:o.pincode,onChange:l=>x({...o,pincode:l.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:d.pincode||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city",className:"block text-gray-700 font-semibold",children:"City"}),e.jsx("input",{type:"text",id:"city",name:"city",value:o.city,onChange:l=>x({...o,city:l.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"state",className:"block text-gray-700 font-semibold",children:"State"}),e.jsx("input",{type:"text",id:"state",name:"state",value:o.state,onChange:l=>x({...o,state:l.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"country",className:"block text-gray-700 font-semibold",children:"Country"}),e.jsx("input",{type:"text",id:"country",name:"country",value:o.country,onChange:l=>x({...o,country:l.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"country",className:"block text-gray-700 font-semibold",children:"Address Type"}),e.jsxs("select",{className:"select select-lg text-sm",onChange:l=>x({...o,address_type:Number(l.target.value)}),children:[e.jsx("option",{value:"",selected:!0,disabled:!0,className:"badge-danger badge-outline",children:"Select Address Type"}),e.jsx("option",{value:"1",children:"Home"}),e.jsx("option",{value:"2",children:"Office"}),e.jsx("option",{value:"3",children:"Other"})]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:d.address_type||" "})]})]}),e.jsxs("div",{className:"flex justify-end mt-6",children:[e.jsx("button",{type:"button",onClick:p,className:"btn btn-light mr-2",disabled:h,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:h,className:`btn btn-primary ${h?"opacity-50 cursor-not-allowed":""}`,children:h?"Submitting...":"Submit"})]})]})]})]})},xt=({isOpen:i,onClose:p,setIsSubmit:j})=>{const{addUser:y,loading:m}=Ze(),h={first_name:"",last_name:"",email:"",password:"",mobile_number:"",gender:null,role_id:5},[d,c]=u.useState(h),[o,x]=u.useState({});u.useEffect(()=>{i||(c({first_name:"",last_name:"",email:"",password:"",mobile_number:"",gender:null,role_id:5}),x({}))},[i]);const S=async l=>{l.preventDefault();try{await et().validate(d,{abortEarly:!1}),await y(d),j(!0),p()}catch(C){if(C instanceof K){const v={};C.inner.forEach(F=>{v[F.path||""]=F.message}),x(v)}else f.error("Failed to submit the form. Please try again.")}};if(i)return e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:p}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-lg z-10 relative",children:[e.jsx("button",{className:"btn btn-sm btn-icon btn-light btn-outline absolute top-0 right-0 mr-5 mt-5 lg:mr-5 shadow-default",onClick:p,children:e.jsx("i",{className:"ki-filled ki-cross"})}),e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Add New Customer"}),e.jsxs("form",{onSubmit:S,children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"first_name",className:"block text-gray-700 font-semibold",children:"First name"}),e.jsx("input",{type:"text",id:"first_name",name:"first_name",value:d.first_name||"",onChange:l=>c({...d,first_name:l.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"text-red-500 text-sm",children:o.first_name||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"last_name",className:"block text-gray-700 font-semibold",children:"Last name"}),e.jsx("input",{type:"text",id:"last_name",name:"last_name",value:d.last_name,onChange:l=>c({...d,last_name:l.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"text-red-500 text-sm",children:o.last_name||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-gray-700 font-semibold",children:"Email"}),e.jsx("input",{type:"text",id:"email",name:"email",value:d.email,onChange:l=>c({...d,email:l.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"text-red-500 text-sm",children:o.email||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mobile_number",className:"block text-gray-700 font-semibold",children:"Mobile Number"}),e.jsx("input",{type:"text",id:"mobile_number",name:"mobile_number",value:d.mobile_number,onChange:l=>c({...d,mobile_number:l.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"text-red-500 text-sm",children:o.mobile_number||" "})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-gray-700 font-semibold",children:"Password"}),e.jsx("input",{type:"password",id:"password",name:"password",value:d.password,onChange:l=>c({...d,password:l.target.value}),className:"w-full input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"text-red-500 text-sm",children:o.password||" "})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"mb-2 block text-gray-700 font-semibold",children:"Gender"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"gender",value:1,checked:d.gender===1,onChange:l=>c({...d,gender:parseInt(l.target.value)}),className:"radio radio-primary"}),e.jsx("span",{className:"text-sm",children:"Male"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"gender",value:2,checked:d.gender===2,onChange:l=>c({...d,gender:parseInt(l.target.value)}),className:"radio radio-primary"}),e.jsx("span",{className:"text-sm",children:"Female"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"gender",value:3,checked:d.gender===3,onChange:l=>c({...d,gender:parseInt(l.target.value)}),className:"radio radio-primary"}),e.jsx("span",{className:"text-sm",children:"Other"})]})]}),e.jsx("p",{className:"text-red-500 text-sm",children:o.gender||" "})]})]}),e.jsxs("div",{className:"flex justify-end mt-4",children:[e.jsx("button",{type:"button",onClick:p,className:"btn btn-light mr-2",disabled:m,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m,className:`btn btn-primary ${m?"opacity-50 cursor-not-allowed":""}`,children:m?"Submitting...":"Submit"})]})]})]})]})},kt=()=>{const{prices:i}=Qe(),{categories:p}=Ke(),{fetchProductsOnId:j}=Le(),{fetchServicesOnId:y}=Be(),[m,h]=u.useState(""),[d,c]=u.useState(!0),{id:o}=Ge(),{updateOrder:x,loading:S}=dt(),{addOrder:l,loading:C}=ot(),v=Number(o),F=1e3,ce=1,[ue,Q]=u.useState(!1),[me,Y]=u.useState(!1),[W,G]=u.useState(!1),{users:z,fetchUsersByRole:pe}=Xe(),{validCoupons:$,fetchValidCoupons:he}=rt(),{branches:X}=Ye(ce,F),{order:g,fetchOrder:be}=We(),{address:Z,fetchAddress:ee}=it(),{applyCoupon:xe}=at(),{userData:M,fetchUser:ge}=tt(),{transactionId:I,generatePaymentLink:ye}=ze(),T=M==null?void 0:M.user,[te,_e]=u.useState({}),[se,fe]=u.useState({}),q=Me(),[s,N]=u.useState({coupon_code:"",coupon_discount:null,express_delivery_charges:null,shipping_charges:null,payment_type:null,payment_status:null,sub_total:0,paid_amount:null,transaction_id:"",address_id:null,username:"",user_id:null,items:[{category_id:null,product_id:null,service_id:null,product_name:"",service_name:"",description:null,price:null,quantity:1,item_Total:null,showDescription:!1}],total:0,branch_id:null,order_status:null}),[je,ve]=u.useState({coupon_code:"",coupon_discount:null,express_delivery_charges:null,shipping_charges:null,payment_type:null,payment_status:null,sub_total:0,paid_amount:null,transaction_id:"",address_id:null,username:"",user_id:null,items:[{category_id:null,product_id:null,service_id:null,product_name:"",service_name:"",description:null,price:null,quantity:1,item_Total:null,showDescription:!1}],total:0,branch_id:null,order_status:null}),[k,Ne]=u.useState({});u.useEffect(()=>{(async()=>{await be(v)})()},[v]),u.useEffect(()=>{(async()=>{s.user_id&&(await ee(s.user_id),await he(s.user_id),await ge(s.user_id)),W&&(await ee(s.user_id),G(!1))})()},[s.user_id,W]),u.useEffect(()=>{I&&N({...s,transaction_id:I})},[I]),u.useEffect(()=>{N(t=>({...t,payment_status:s.payment_type===1?1:null}))},[s.payment_type]),u.useEffect(()=>{(async()=>{m&&d&&await pe(5,m)})()},[m,d]),u.useEffect(()=>{if(g){const t=`${g.user.first_name} ${g.user.last_name}`;h(t),c(!1);const a={coupon_code:g.coupon_code||"",coupon_discount:g.coupon_discount||null,express_delivery_charges:g.express_delivery_charges||null,shipping_charges:g.shipping_charges||null,payment_type:g.payment_type||null,payment_status:g.payment_status||null,sub_total:g.sub_total||0,paid_amount:g.paid_amount||null,transaction_id:g.transaction_id||"",address_id:g.address_id,username:t,user_id:g.user_id||null,items:g.items.map(r=>{var U,E,R,_;const b=r.category.category_id,n=((U=r.product)==null?void 0:U.product_id)||null,w=((E=r.service)==null?void 0:E.service_id)||null,J=((R=r.product)==null?void 0:R.name)||"",O=((_=r.service)==null?void 0:_.name)||"";return{category_id:b,product_id:n,service_id:w,product_name:J,service_name:O,description:r.description||null,price:r.price,quantity:r.quantity,item_Total:r.price*r.quantity,showDescription:!!r.description}}),total:(g.sub_total||0)+(g.express_delivery_charges||0)+(g.shipping_charges||0),branch_id:g.branch_id,order_status:g.order_status};N(a),ve(a)}},[g]);const we=async t=>{t.preventDefault();try{const a=s.items.map(w=>({category_id:Number(w.category_id),product_id:Number(w.product_id),service_id:Number(w.service_id),description:w.description,price:Number(w.price),quantity:Number(w.quantity)})),r={...s,address_id:Number(s.address_id),coupon_discount:Number(s.coupon_discount),shipping_charges:Number(s.shipping_charges),paid_amount:Number(s.paid_amount),express_delivery_charges:Number(s.express_delivery_charges),payment_type:Number(s.payment_type),payment_status:Number(s.payment_status),items:a};if(await ut.validate(r,{abortEarly:!1}),!Object.keys(s).some(w=>s[w]!==je[w])){q("/orders");return}let n;g?n=await x(v,r):n=await l(r),n&&q("/orders")}catch(a){if(a instanceof K){const r={};a.inner.forEach(b=>{r[b.path||""]=b.message}),Ne(r)}else f.error("Failed to submit the form. Please try again.")}},ke=t=>{h(t.target.value),c(!0)},Ce=t=>{const a=`${t.first_name} ${t.last_name}`;h(a),c(!1),N({...s,username:a,user_id:t.user_id})},Se=()=>{q("/orders")},De=()=>{N(t=>({...t,items:[...t.items,{category_id:null,product_id:null,product_name:"",service_id:null,service_name:"",description:null,price:null,quantity:1,item_Total:null,showDescription:!1}]}))},Pe=t=>{N(a=>{const r=a.items.filter((J,O)=>O!==t),b={...a,items:r,coupon_code:"",coupon_discount:0},n=V(b),w=n+Number(s.express_delivery_charges||0)+Number(s.shipping_charges||0);return{...b,sub_total:n,total:w}})},A=async(t,a,r)=>{["category_id","product_id","service_id","price","quantity"].includes(a)&&N(b=>({...b,coupon_code:"",coupon_discount:0})),N(b=>{const n=b.items.map((E,R)=>{if(R===t){const _={...E,[a]:r};a==="showDescription"&&(_.showDescription=r);const re=Number(_.category_id),ne=Number(_.product_id),le=Number(_.service_id),oe=Number(_.quantity)||1;if(a==="category_id"){const P=Number(r);te[P]||j(P).then(L=>{_e(B=>({...B,[P]:L}))}),_.product_id=null,_.service_id=null}if(a==="product_id"){const P=Number(E.category_id),L=Number(r),B=`${P}_${L}`;se[B]||y(P,L).then(qe=>{fe(Ue=>({...Ue,[B]:qe}))}),_.service_id=null}if(["category_id","product_id","service_id"].includes(a))if(re&&ne&&le){const P=Ae(re,ne,le);_.price=P,_.item_Total=P*oe}else _.price=null,_.item_Total=null;else a==="price"?_.item_Total=r*oe:a==="quantity"&&(_.item_Total=_.price*Number(r));return _}return E}),w={...b,items:n},O=V(w)-b.coupon_discount,U=O+Number(b.express_delivery_charges||0)+Number(b.shipping_charges||0);return{...w,sub_total:O,total:U}})},Ae=(t,a,r)=>{const b=`${t}_${a}_${r}`;return i[b]||0},Fe=async t=>{const a=V(s),r=await xe(s.user_id,a,t),b=Number(r.finalTotal||0)+Number(s.express_delivery_charges||0)+Number(s.shipping_charges||0);r&&N(n=>({...n,coupon_code:t,coupon_discount:r.discountAmount,sub_total:r.finalTotal,total:b}))},V=t=>t.items.reduce((a,r)=>a+(r.item_Total||0),0),ae=(t,a)=>{N(r=>{const b={...r,[t]:a},n=Number(b.sub_total||0)+Number(b.express_delivery_charges||0)+Number(b.shipping_charges||0);return{...b,total:n}})},Te=t=>{const a=t.target.value;N(r=>({...r,address_id:Number(a)}))},Oe=t=>{t.preventDefault(),s.user_id?Q(!0):f.error("Please select the user to add address")},Ee=t=>{t.preventDefault(),Y(!0)},$e=()=>{q(`/order/${v}`)},Ie=async()=>{const t={amount:s.paid_amount,currency:"INR",user_id:s.user_id,customer:{name:s.username,mobile_number:Number(T==null?void 0:T.mobile_number),email:T==null?void 0:T.email}};await ye(t)};return e.jsx("div",{className:"container-fixed",children:e.jsxs("div",{className:"card max-w-5xl mx-auto p-6 bg-white shadow-md",children:[e.jsxs("div",{className:"flex",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:g?"Edit Order":"Add Order"}),!isNaN(v)&&e.jsxs("button",{className:"btn bg-gray-200 ml-4 text-gray-700 text-sm font-bold rounded-md",onClick:$e,children:[e.jsx(Ve,{size:20}),"View Order"]})]}),e.jsxs("form",{onSubmit:we,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-y-1 gap-x-6 mt-4",children:[e.jsxs("div",{className:"relative col-span-1",children:[e.jsxs("span",{className:"flex justify-between items-center",children:[e.jsx("label",{htmlFor:"username",className:"block text-gray-700 text-sm font-bold mb-2",children:"Customer name"}),e.jsx("button",{className:"btn btn-sm btn-primary -mt-6 sm:btn-lg",onClick:Ee,children:"Add Customer"})]}),e.jsx("input",{type:"text",id:"username",autoComplete:"off",value:m||"",onChange:ke,className:"input border border-gray-300 rounded-md p-2 w-full mb-2",placeholder:"Search customer..."}),z&&m&&d&&e.jsx("ul",{className:"absolute -mt-2 bg-white border z-10 border-gray-300 rounded-md p-2 w-full text-sm",children:z.length>0?z.map(t=>e.jsxs("li",{className:"p-2 hover:bg-gray-100 cursor-pointer",onClick:()=>Ce(t),children:[t.first_name," ",t.last_name," (",t.mobile_number,")"]},t.user_id)):e.jsx("li",{className:"p-2 text-gray-500",children:"No users found"})}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.username||" "})]}),e.jsxs("div",{className:"relative col-span-1",children:[e.jsxs("span",{className:"flex justify-between items-center",children:[e.jsx("label",{htmlFor:"address",className:"block text-gray-700 text-sm font-bold mb-2",children:"Customer address"}),e.jsx("button",{className:"btn btn-sm btn-primary -mt-6",onClick:Oe,children:"Add address"})]}),e.jsxs("select",{id:"address",value:s.address_id,onChange:Te,className:"select border border-gray-300 rounded-md w-full text-sm",children:[e.jsx("option",{value:"",selected:!0,disabled:!0,children:"Select Address"}),Z.length>0?Z.map(t=>e.jsxs("option",{value:t.address_id,children:[t.building_number,", ",t.area,", ",t.landmark,","," ",t.city,", ",t.state,",",t.country,", ",t.pincode]},t.address_id)):e.jsx("option",{disabled:!0,children:"No Address Available"})]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.address_id||" "})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{htmlFor:"branch",className:"block text-gray-700 text-sm font-bold mb-2",children:"Branch"}),e.jsxs("select",{id:"branch",className:"select border border-gray-300 rounded-md p-2 w-full text-sm",value:s.branch_id||"",onChange:t=>N({...s,branch_id:t.target.value?Number(t.target.value):null}),children:[e.jsx("option",{value:"",disabled:!0,children:"Select Branch"}),X.length>0?X.map(t=>e.jsx("option",{value:t.branch_id,children:t.branch_name},t.branch_id)):e.jsx("option",{children:"No Data Available"})]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.branch_id||" "})]})]}),e.jsx("div",{className:"flex flex-wrap",children:e.jsx("h1",{className:"text-xl font-semibold leading-none text-gray-900 mt-6 mb-5 ml-1",children:"Item"})}),s.items.map((t,a)=>{var r,b;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"border border-gray-200 rounded-xl mt-4 p-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(150px,4fr))] gap-x-5 gap-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-gray-700 text-sm font-bold mb-2",children:"Category"}),e.jsxs("select",{id:"category",value:t.category_id??"",onChange:n=>A(a,"category_id",n.target.value),className:"select border border-gray-300 rounded-md p-2 w-full text-sm",children:[e.jsx("option",{value:"",disabled:!0,children:"Select Category"}),p.map(n=>e.jsx("option",{value:n.category_id,children:n.name},n.category_id))]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k[`items[${a}].category_id`]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"product",className:"block text-gray-700 text-sm font-bold mb-2",children:"Product"}),e.jsxs("select",{id:"product",value:t.product_id??"",onChange:n=>A(a,"product_id",n.target.value),className:"select border border-gray-300 rounded-md p-2 w-full text-sm",children:[e.jsx("option",{value:"",disabled:!0,children:"Select Product"}),((r=te[t.category_id])==null?void 0:r.map(n=>e.jsx("option",{value:n.product_product_id,children:n.product_name},n.product_product_id)))||t.product_id&&e.jsx("option",{value:t.product_id,children:t.product_name},t.product_id)]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k[`items[${a}].product_id`]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"service",className:"block text-gray-700 text-sm font-bold mb-2",children:"Service"}),e.jsxs("select",{id:"service",value:t.service_id??"",onChange:n=>A(a,"service_id",n.target.value),className:"select border border-gray-300 rounded-md p-2 w-full text-sm",children:[e.jsx("option",{value:"",disabled:!0,children:"Select Service"}),(b=se[`${t.category_id}_${t.product_id}`])==null?void 0:b.map(n=>e.jsx("option",{value:n.service_service_id,children:n.service_name},n.service_service_id))]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k[`items[${a}].service_id`]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Price"}),e.jsx("input",{type:"text",value:t.price||"",onChange:n=>A(a,"price",n.target.value),className:`input border rounded-md p-2 w-full ${isNaN(v)?"border-gray-300 bg-gray-100 text-sm text-gray-600 cursor-not-allowed focus:outline-none":"border-gray-300"}`,readOnly:isNaN(v)}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k[`items[${a}].price`]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Quantity"}),e.jsx("input",{type:"text",value:t.quantity??1,onChange:n=>A(a,"quantity",n.target.value),className:"input border border-gray-300 rounded-md p-2 w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Item total"}),e.jsx("input",{type:"text",value:t.item_Total??"",onChange:n=>A(a,"item_Total",n.target.value),min:"0",step:"0.01",readOnly:!0,className:"input w-full border border-gray-300 bg-gray-100 text-sm text-gray-600 rounded-md p-2 cursor-not-allowed focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description_checkbox",className:"block text-gray-700 text-sm font-bold mb-2",children:"Description"}),e.jsx("input",{className:"checkbox checkbox-lg mt-2 ml-5",id:"description_checkbox","data-datatable-check":"true",type:"checkbox",checked:t.showDescription,onChange:n=>A(a,"showDescription",n.target.checked)}),e.jsx("p",{className:" text-red-500 text-sm",children:" "})]})]})},a),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:t.showDescription&&e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col w-[500px] md:w-[350px] lg:w-[300px] h-[80px] mb-2",children:[e.jsx("label",{htmlFor:"description",className:"block text-gray-700 text-sm font-bold mb-2",children:"Description"}),e.jsx("textarea",{id:"description",value:t.description||"",onChange:n=>A(a,"description",n.target.value),className:"h-full input border border-gray-300 rounded-md p-2 w-full"})]})})}),e.jsx("div",{className:"flex block-element flex-end justify-end relative",children:e.jsx("div",{children:e.jsx("button",{type:"button",className:`p-2 rounded-full ${s.items.length>1?"bg-red-100 hover:bg-red-200":"bg-gray-200 cursor-not-allowed"}`,onClick:()=>Pe(a),disabled:s.items.length===1,children:e.jsx(Je,{className:`${s.items.length>1?"text-red-500":"text-gray-400"}`})})})})]})]})})}),e.jsx("button",{type:"button",onClick:De,className:"btn btn-secondary mb-6 mt-4",children:"Add Item"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Coupon Code"}),e.jsxs("select",{id:"coupon_code",className:"select border border-gray-300 rounded-md p-2 w-full text-sm",value:s.coupon_code??"",onChange:t=>{const a=$.find(r=>r.code===t.target.value);Fe(a==null?void 0:a.code)},children:[e.jsx("option",{value:"",disabled:!0,children:"Select Coupon Code"}),$&&$.length>0?$.map(t=>e.jsx("option",{value:t.code,children:t.code},t.coupon_id)):e.jsx("option",{children:"No Coupons available"})]}),e.jsx("p",{className:"text-red-500 text-sm",children:k.coupon_code||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Coupon Discount"}),e.jsx("input",{type:"text",value:s.coupon_discount||"",readOnly:!0,className:"input border border-gray-300 bg-gray-100 text-sm text-gray-600 rounded-md p-2 cursor-not-allowed focus:outline-none"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.coupon_discount||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"express_delivery_charges",className:"block text-gray-700 text-sm font-bold mb-2",children:"Express Delivery Charges"}),e.jsx("input",{type:"text",id:"express_delivery_charges",min:"0",value:s.express_delivery_charges||"",onChange:t=>ae("express_delivery_charges",t.target.value),className:"input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.express_delivery_charges||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"shipping_charges",className:"block text-gray-700 text-sm font-bold mb-2",children:"Shipping Charges"}),e.jsx("input",{type:"text",id:"shipping_charges",min:"0",value:s.shipping_charges||"",onChange:t=>ae("shipping_charges",t.target.value),className:"input border border-gray-300 rounded-md p-2"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.shipping_charges||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Sub Total"}),e.jsx("input",{type:"text",value:s.sub_total||"",readOnly:!0,className:"input border border-gray-300 bg-gray-100 text-sm text-gray-600 rounded-md p-2 cursor-not-allowed focus:outline-none"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.sub_total||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Total"}),e.jsx("input",{type:"text",value:s.total||"",readOnly:!0,className:"input border border-gray-300 bg-gray-100 text-sm text-gray-600 rounded-md p-2 cursor-not-allowed focus:outline-none"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"paid_amount",className:"block text-gray-700 text-sm font-bold mb-2",children:"Paid amount"}),e.jsx("input",{type:"text",id:"paid_amount",value:s.paid_amount||"",onChange:t=>{N({...s,paid_amount:Number(t.target.value)})},className:"input border border-gray-300 rounded-md p-2",min:"0",step:"0.01"}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.paid_amount||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"payment_method",className:"block text-gray-700 text-sm font-bold mb-2",children:"Payment Method"}),e.jsxs("select",{className:"select border border-gray-300 rounded-md p-2 w-full text-sm",id:"payment_method",value:s.payment_type??"",onChange:t=>N({...s,payment_type:Number(t.target.value)}),children:[e.jsx("option",{value:"",disabled:!0,children:"Select Payment Type"}),e.jsx("option",{value:1,children:"Cash on Delivery"}),e.jsx("option",{value:2,children:"Online Payment"})]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.payment_type||" "}),!v&&s.payment_type===2&&e.jsx("div",{children:e.jsxs("button",{className:"-mt-2 badge text-sm badge-info badge-outline",onClick:Ie,children:[e.jsx(He,{color:"blue"}),"  "," Send Payment Link"]})})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"payment_status",className:"block text-gray-700 text-sm font-bold mb-2",children:"Payment Status"}),e.jsxs("select",{className:"select border border-gray-300 rounded-md p-2 w-full text-sm",id:"payment_status",value:s.payment_status??"",onChange:t=>N({...s,payment_status:Number(t.target.value)}),children:[e.jsx("option",{value:"",disabled:!0,children:"Select Payment Status"}),e.jsx("option",{value:1,children:"Pending"}),e.jsx("option",{value:2,children:"Received"}),e.jsx("option",{value:3,children:"Partial Received"})]}),e.jsx("p",{className:"w-full text-red-500 text-sm",children:k.payment_status||" "})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"transaction_id",className:"block text-gray-700 text-sm font-bold mb-2",children:"Transaction ID"}),e.jsx("input",{type:"text",id:"transaction_id",value:I||"",className:"input border border-gray-300 bg-gray-100 text-sm text-gray-600 rounded-md p-2 cursor-not-allowed focus:outline-none",readOnly:!0})]}),!v&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"item_status",className:"block text-gray-700 text-sm font-bold mb-2",children:"Item status"}),e.jsxs("select",{className:"select border border-gray-300 rounded-md p-2 w-full text-sm",id:"item_status",value:s.order_status??null,onChange:t=>N({...s,order_status:Number(t.target.value)}),children:[e.jsx("option",{value:"",disabled:!0,selected:!0,children:"Select item status"}),e.jsx("option",{value:4,children:"Received at branch"}),e.jsx("option",{value:1,children:"Need to pickup"})]})]})]}),e.jsxs("div",{className:"mt-6 flex gap-4",children:[e.jsx("button",{type:"submit",className:`btn btn-primary ${C||S?"opacity-50 cursor-not-allowed":""}`,disabled:C||S,children:C||S?C?"Adding...":"Updating...":v?"Update Order":"Add Order"}),e.jsx("button",{type:"button",onClick:Se,className:"btn btn-secondary",disabled:C||S,children:"Cancel"})]})]}),e.jsx(bt,{isOpen:ue,setIsSubmit:G,onClose:()=>Q(!1),userId:s.user_id}),e.jsx(xt,{isOpen:me,setIsSubmit:G,onClose:()=>Y(!1)})]})})};export{kt as default};
