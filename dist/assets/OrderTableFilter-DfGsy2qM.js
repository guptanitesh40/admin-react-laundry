import{r as i,B as _,V as B,j as c}from"./index-B4nIO5A4.js";import{u as F}from"./useGetBranches-DNuxsmbj.js";import{O as T,b as C}from"./enums-CdakGUf3.js";import{u as N}from"./useGetUsersByRole-D2D0ylDy.js";import{M as O}from"./MultiSelect-BhHAJD6c.js";const A=(s=1,o=10,V="",d,h,S,p,m,y,b,f,v,x="",j="")=>{const[e,t]=i.useState([]),[a,u]=i.useState(0),[l,E]=i.useState(!1),w=async()=>{var $,k;const R=localStorage.getItem("authToken"),r=new URLSearchParams;s&&r.append("page_number",s.toString()),o&&r.append("per_page",o.toString()),V&&r.append("search",V),d&&r.append("sort_by",d),h&&r.append("order",h),S&&S.forEach(n=>r.append("order_statuses",n.toString())),p&&p.forEach(n=>r.append("customer_ids",n.toString())),m&&m.forEach(n=>r.append("branches_ids",n.toString())),y&&y.forEach(n=>r.append("pickup_boy_ids",n.toString())),b&&b.forEach(n=>r.append("delivery_boy_ids",n.toString())),x&&r.append("list",x),j&&r.append("orderList",j),v&&v.forEach(n=>r.append("payment_statuses",n.toString())),f&&r.append("payment_types",f.toString()),E(!0);try{const n=await fetch(`${_}/admin/orders?${r}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${R}`}}),g=await n.json();if(!n.ok){B.error(g.message,{position:"top-center"});return}t((($=g==null?void 0:g.data)==null?void 0:$.orders)||[]),u(((k=g==null?void 0:g.data)==null?void 0:k.count)||0)}catch(n){B.error(n||"Network error: Failed to fetch.",{position:"top-center"})}finally{E(!1)}};return i.useEffect(()=>{w()},[s,o,V,d,h,S,p,m,y,b,f,v]),{orders:e,totalOrders:a,loading:l,fetchOrders:w}},G=()=>{const[s,o]=i.useState(!1);return{deleteOrder:async d=>{const h=localStorage.getItem("authToken"),S=`http://3.110.208.70:3000/admin/order/${d}`;o(!0);try{const p=await fetch(S,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`}}),m=await p.json();return p.ok?{success:!0,message:m.message}:(B.error(m.message,{position:"top-center"}),{success:!1,message:m.message})}catch(p){return B.error("An unexpected error occurred.",{position:"top-center"}),{success:!1,message:p.message}}finally{o(!1)}},loading:s}},z=({filters:s,updateFilters:o})=>{const[V,d]=i.useState([]),[h,S]=i.useState([]),[p,m]=i.useState([]),[y,b]=i.useState(""),{branches:f}=F(),{fetchUsersByRole:v}=N(),x=Object.entries(T).filter(([e,t])=>typeof t=="number").map(([e,t])=>({label:e,value:t})),j=Object.entries(C).filter(([e,t])=>typeof t=="number").map(([e,t])=>({label:e,value:t}));return i.useEffect(()=>{y&&(async()=>{const t=await v(5,y),a=t==null?void 0:t.map(u=>({label:`${u.first_name} ${u.last_name} (${u.mobile_number})`,value:u.user_id}));d(a)})()},[y]),i.useEffect(()=>{const e=async()=>{const a=await v(4),u=a==null?void 0:a.map(l=>({label:`${l.first_name} ${l.last_name} (${l.mobile_number})`,value:l.user_id}));S(u)},t=async()=>{const a=await v(4),u=a==null?void 0:a.map(l=>({label:`${l.first_name} ${l.last_name} (${l.mobile_number})`,value:l.user_id}));m(u)};e(),t()},[]),c.jsx(c.Fragment,{children:c.jsx("div",{className:"p-4",children:c.jsxs("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(250px,1fr))] gap-4",children:[c.jsx(O,{options:V,displayValue:"label",placeholder:"Search Customer",selectedValues:s.customerFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,customerFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,customerFilter:t})},setSearch:b,className:"w-full",isSearchInput:!0}),c.jsx(O,{options:x,displayValue:"label",placeholder:"Select Order Status",selectedValues:s.orderStatusFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,orderStatusFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,orderStatusFilter:t})},isCustomLabel:!0,className:"w-full",isSearchInput:!0}),c.jsx(O,{options:f==null?void 0:f.map(e=>({label:e.branch_name,value:e.branch_id})),displayValue:"branch_name",placeholder:"Select Branch",selectedValues:s==null?void 0:s.branchFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,branchFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,branchFilter:t})},className:"w-full",isSearchInput:!0}),c.jsx(O,{options:p,displayValue:"label",placeholder:"Search DeliveryBoy",selectedValues:s.deliveryBoyFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,deliveryBoyFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,deliveryBoyFilter:t})},className:"w-full",isSearchInput:!0}),c.jsx(O,{options:h,displayValue:"label",placeholder:"Search PickupBoy",selectedValues:s.pickupBoyFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,pickupBoyFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,pickupBoyFilter:t})},className:"w-full",isSearchInput:!0}),c.jsx(O,{options:j,displayValue:"label",placeholder:"Select Payment Status",selectedValues:s.paymentStatusFilter,onSelect:e=>{const t=e.map(a=>a.value);o({...s,paymentStatusFilter:t})},onRemove:e=>{const t=e.map(a=>a.value);o({...s,paymentStatusFilter:t})},sliceCount:2,isSearchInput:!1,className:"w-full"}),c.jsxs("select",{className:"select select-lg w-[200px] text-sm",value:s.paymentTypeFilter,onChange:e=>{o({...s,paymentTypeFilter:Number(e.target.value)})},children:[c.jsx("option",{value:"",selected:!0,children:"Payment type"}),c.jsx("option",{value:1,children:"Cash on Delivery"}),c.jsx("option",{value:2,children:"Online Payment"})]})]})})})};export{z as O,G as a,A as u};
